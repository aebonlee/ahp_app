# GitHub 브랜치 보호 옵션 선택 가이드

**작성일**: 2025년 10월 18일  
**상황**: Classic branch protection vs Branch ruleset 선택  
**프로젝트**: aebonlee/ahp_app  

---

## 🔍 두 가지 옵션 비교

### **Option 1: Add classic branch protection rule** (권장)
```
🎯 특징:
├── 전통적이고 안정적인 방식
├── 단일 브랜치(main) 타겟팅
├── 즉시 적용 가능
├── 설정이 직관적이고 간단
└── 대부분의 개발팀이 사용하는 표준
```

### **Option 2: Add branch ruleset** (고급)
```
🎯 특징:
├── 새로운 GitHub 기능 (2023년 도입)
├── 여러 브랜치에 동시 적용 가능
├── 더 세밀한 규칙 설정 가능
├── 조직 레벨 정책 지원
└── 복잡한 팀 구조에 적합
```

---

## 🎯 AHP 프로젝트 권장 선택

### **"Add classic branch protection rule" 선택 권장**

#### 선택 이유
```
✅ 현재 프로젝트에 최적:
├── 개인/소규모 팀 프로젝트
├── main 브랜치만 보호하면 충분
├── 단순하고 신뢰할 수 있는 방식
├── 즉시 적용 가능
└── 문제 발생 시 쉬운 문제 해결
```

#### 설정할 내용
```
🛡️ 권장 보호 설정:
├── Require a pull request before merging ✅
├── Require status checks to pass before merging ✅
├── Restrict pushes that create files ✅
├── Restrict force pushes ✅
└── Do not allow bypassing the above settings ✅
```

---

## 📋 단계별 설정 방법

### **Step 1: Classic Branch Protection Rule 선택**
1. **"Add classic branch protection rule"** 버튼 클릭
2. Branch name pattern에 **`main`** 입력

### **Step 2: 기본 보호 규칙 설정**

#### **🔒 Protect matching branches**
```yaml
Branch name pattern: main
```

#### **🔐 Require a pull request before merging**
```
☑️ Require a pull request before merging
  ├── Required number of reviewers: 0 (개인 프로젝트이므로)
  ├── ☐ Dismiss stale PR approvals (추후 팀 확장 시 활성화)
  ├── ☐ Require review from code owners (개인 프로젝트이므로 비활성화)
  └── ☐ Restrict reviews to users with write access (기본값)
```

#### **✅ Require status checks to pass before merging**
```
☑️ Require status checks to pass before merging
  ├── ☑️ Require branches to be up to date before merging
  └── Status checks 목록:
      ├── build (GitHub Actions 빌드)
      ├── test (테스트 실행)
      └── deploy (배포 검증)
```

#### **🚫 Restrict pushes that create files**
```
☑️ Restrict pushes that create files
  ├── ☑️ Restrict force pushes
  ├── ☑️ Restrict deletions
  └── ☐ Allow force pushes (비활성화 유지)
```

#### **⚙️ Rules applied to everyone including administrators**
```
☑️ Do not allow bypassing the above settings
└── 관리자도 동일한 규칙 적용
```

### **Step 3: 고급 설정 (선택사항)**

#### **📝 Require conversation resolution before merging**
```
☐ Require conversation resolution before merging
└── 현재 개인 프로젝트이므로 비활성화
```

#### **🔐 Require signed commits**
```
☐ Require signed commits
└── 추후 보안 강화 시 고려
```

#### **📈 Require linear history**
```
☑️ Require linear history
└── 깔끔한 커밋 히스토리 유지
```

---

## 🎯 완성된 설정 예시

### **최종 권장 설정값**
```yaml
# Branch Protection Rule for 'main'
branch_name_pattern: "main"

# Pull Request Requirements
require_pull_request: true
required_reviewers: 0
dismiss_stale_reviews: false
require_code_owner_reviews: false

# Status Check Requirements  
require_status_checks: true
strict_status_checks: true
required_status_checks:
  - "build"
  - "test"

# Push Restrictions
restrict_pushes: true
allow_force_pushes: false
allow_deletions: false

# Additional Settings
enforce_admins: true
require_linear_history: true
require_conversation_resolution: false
require_signed_commits: false
```

---

## 🚀 설정 완료 후 확인 방법

### **1. 즉시 테스트**
```bash
# 현재 main 브랜치에서
git checkout main
echo "direct push test" > test.txt
git add test.txt
git commit -m "test: 직접 push 테스트"
git push origin main
# 이 명령이 실패해야 정상 (보호 규칙 적용됨)
```

### **2. 정상 워크플로우 테스트**
```bash
# feature 브랜치 생성
git checkout -b feature/test-protection
echo "feature test" > feature.txt
git add feature.txt
git commit -m "feat: 브랜치 보호 테스트"
git push origin feature/test-protection

# GitHub에서 Pull Request 생성
# GitHub Actions 실행 확인
# 병합 프로세스 테스트
```

---

## ⚡ 설정 후 Pull Request #2 병합

### **새로운 병합 프로세스**
1. **Pull Request #2 페이지** 접속
2. **GitHub Actions 통과** 확인 (자동 실행)
3. **"Merge pull request"** 버튼 클릭
4. **Merge commit 생성** (권장)
5. **브랜치 삭제** 체크 후 완료

### **예상 소요 시간**
- 브랜치 보호 설정: **5분**
- Pull Request 병합: **2분**
- 배포 완료 확인: **3분**

---

## 📈 설정 완료 후 이점

### **즉시 효과**
```
🛡️ 보안 강화:
├── 실수로 인한 main 브랜치 손상 방지
├── 검증되지 않은 코드 배포 차단
├── 강제 푸시로 인한 히스토리 손실 방지
└── 브랜치 삭제 실수 방지
```

### **개발 프로세스 개선**
```
⚡ 품질 향상:
├── Pull Request 기반 코드 리뷰 체계
├── GitHub Actions 자동 검증
├── 배포 전 필수 테스트 실행
└── 변경 사항 추적 가능성 향상
```

---

## 🎯 실행 액션 플랜

### **지금 즉시 (5분)**
1. **"Add classic branch protection rule"** 클릭
2. **main 브랜치 보호 설정** 적용
3. **기본 보안 규칙 활성화**

### **설정 완료 후 (2분)**
1. **Pull Request #2 병합** 진행
2. **GitHub Actions 동작** 확인
3. **배포 상태 점검**

### **완료 후 확인 (3분)**
1. **브랜치 보호 동작** 테스트
2. **새로운 워크플로우** 검증
3. **문서화 업데이트**

---

## 💡 추가 팁

### **설정 시 주의사항**
- ⚠️ **Required reviewers를 0으로 설정** (개인 프로젝트)
- ⚠️ **Status checks는 실제 존재하는 것만 추가**
- ⚠️ **너무 엄격한 설정으로 개발 속도 저하 방지**

### **문제 발생 시 대응**
- 🔧 **Settings → Branches**에서 규칙 수정 가능
- 🔧 **일시 비활성화** 후 긴급 작업 가능
- 🔧 **관리자 권한으로 우회** 가능 (긴급 시)

---

**가이드 완료**: 2025-10-18  
**권장 선택**: Add classic branch protection rule  
**소요 시간**: 총 10분 예상  

> 🎯 **결론**: "Add classic branch protection rule"을 선택하여 간단하고 안정적인 브랜치 보호를 설정하세요!

> 🚀 **다음 단계**: 설정 완료 후 Pull Request #2를 안전하게 병합할 수 있습니다.