# AHP 플랫폼 개발 규칙 및 가이드라인

**작성일**: 2025년 10월 24일  
**버전**: v1.0  
**대상**: Opus & Sonnet AI 개발자  

---

## 📋 개발 프로세스

### 1. 세션 시작 규칙
```
1. CLAUDE.md 파일 확인
2. 이전 개발일지 검토  
3. TODO 리스트 확인
4. 브랜치 상태 확인 (git status)
5. 개발 환경 준비
```

### 2. 커밋 규칙
```bash
# 커밋 메시지 형식
<type>: <subject>

# Types
feat: 새로운 기능 추가
fix: 버그 수정
refactor: 코드 리팩토링
style: 코드 포맷팅, 세미콜론 누락 등
docs: 문서 수정
test: 테스트 코드 추가
chore: 빌드 업무, 패키지 매니저 수정 등

# 예시
feat: 평가자 이메일 초대 시스템 구현
fix: 일관성 비율 계산 오류 수정
docs: API 엔드포인트 문서 업데이트
```

### 3. 브랜치 전략
```
main              # 프로덕션 브랜치
├── develop       # 개발 통합 브랜치
├── feature/*     # 기능 개발 브랜치
├── fix/*         # 버그 수정 브랜치
└── hotfix/*      # 긴급 수정 브랜치
```

---

## 🎨 코딩 스타일 가이드

### TypeScript/React
```typescript
// ✅ 좋은 예시
interface UserProps {
  id: string;
  name: string;
  email: string;
}

const UserCard: React.FC<UserProps> = ({ id, name, email }) => {
  return (
    <div className="user-card">
      <h3>{name}</h3>
      <p>{email}</p>
    </div>
  );
};

// ❌ 나쁜 예시
const UserCard = (props: any) => {
  return <div>{props.name}</div>;
};
```

### Python/Django
```python
# ✅ 좋은 예시
class ProjectViewSet(viewsets.ModelViewSet):
    """프로젝트 관리 ViewSet"""
    queryset = Project.objects.all()
    serializer_class = ProjectSerializer
    permission_classes = [IsAuthenticated]
    
    def get_queryset(self):
        """사용자별 프로젝트 필터링"""
        return self.queryset.filter(owner=self.request.user)

# ❌ 나쁜 예시
def get_projects(request):
    projects = Project.objects.all()
    return JsonResponse({'projects': projects})
```

---

## 🔧 개발 환경 설정

### Frontend 환경
```bash
# 개발 서버 시작
cd ahp_app
npm install
npm start

# 빌드
npm run build

# 테스트
npm test

# 린트 체크
npm run lint
```

### Backend 환경
```bash
# 가상환경 설정
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 의존성 설치
pip install -r requirements.txt

# 개발 서버 시작
python manage.py runserver

# 마이그레이션
python manage.py makemigrations
python manage.py migrate
```

---

## 📝 문서화 규칙

### 1. 개발일지 작성
```markdown
# 개발일지 - YYYY년 MM월 DD일
## 작업 개요
- 작업자: [Opus/Sonnet]
- 주요 목표: 
- 작업 시간:

## 완료된 작업
1. 
2. 

## 발생한 이슈 및 해결
1. 

## 다음 작업 계획
1. 
```

### 2. API 문서화
```yaml
endpoint: /api/v1/projects/
method: POST
description: 새 프로젝트 생성
request_body:
  name: string (required)
  description: string (optional)
response:
  200:
    id: number
    name: string
    created_at: datetime
  400:
    error: string
```

---

## 🔒 보안 가이드라인

### 1. 절대 하지 말아야 할 것
```
❌ 비밀키를 코드에 직접 포함
❌ console.log에 민감한 정보 출력
❌ API 키를 프론트엔드 코드에 노출
❌ SQL 인젝션 취약점 있는 쿼리 작성
❌ XSS 취약점 있는 HTML 렌더링
```

### 2. 반드시 해야 할 것
```
✅ 환경 변수 사용 (.env)
✅ 입력값 검증 및 sanitization
✅ HTTPS 사용
✅ JWT 토큰 만료 시간 설정
✅ CORS 적절히 설정
```

---

## 🧪 테스트 가이드

### 단위 테스트
```typescript
// React 컴포넌트 테스트
describe('UserCard', () => {
  it('should render user name', () => {
    const { getByText } = render(
      <UserCard name="John" email="john@example.com" />
    );
    expect(getByText('John')).toBeInTheDocument();
  });
});
```

### API 테스트
```python
# Django REST Framework 테스트
class ProjectAPITest(APITestCase):
    def test_create_project(self):
        url = reverse('project-list')
        data = {'name': 'Test Project'}
        response = self.client.post(url, data)
        self.assertEqual(response.status_code, 201)
```

---

## 📊 성능 최적화 체크리스트

### Frontend
- [ ] 컴포넌트 lazy loading 적용
- [ ] 이미지 최적화 (WebP, 압축)
- [ ] 번들 사이즈 500KB 이하 유지
- [ ] 메모이제이션 적절히 사용
- [ ] 불필요한 re-render 방지

### Backend
- [ ] 데이터베이스 인덱싱
- [ ] N+1 쿼리 문제 해결
- [ ] 캐싱 전략 적용
- [ ] API 응답 시간 < 200ms
- [ ] 페이지네이션 구현

---

## 🚀 배포 체크리스트

### 배포 전 확인사항
```
□ 모든 테스트 통과
□ ESLint 경고 0개
□ TypeScript 에러 0개  
□ 환경 변수 설정 확인
□ 데이터베이스 마이그레이션 완료
□ API 문서 업데이트
□ 개발일지 작성
□ 커밋 메시지 규칙 준수
```

### 배포 후 확인사항
```
□ 프로덕션 사이트 접속 확인
□ API 헬스체크 정상
□ 주요 기능 동작 테스트
□ 에러 로그 모니터링
□ 성능 지표 확인
```

---

## 📅 일일 체크리스트

### Opus (목요일)
- [ ] 복잡한 시스템 설계
- [ ] 알고리즘 구현 계획
- [ ] 아키텍처 문서 작성
- [ ] Sonnet 구현 가이드 작성
- [ ] 주간 보고서 작성

### Sonnet (매일)
- [ ] 코드 구현 및 디버깅
- [ ] UI/UX 개선
- [ ] 테스트 작성
- [ ] 문서 업데이트
- [ ] 코드 리뷰 및 리팩토링

---

## 🔄 협업 규칙

### Opus → Sonnet 인계
```
1. 설계 문서 작성
2. 구현 가이드라인 제공
3. 예상 난이도 및 소요 시간 명시
4. 테스트 시나리오 제공
```

### Sonnet → Opus 피드백
```
1. 구현 중 발견한 설계 이슈 보고
2. 성능 병목 지점 식별
3. 개선 제안사항 정리
4. 실제 구현 시간 기록
```

---

## 📌 중요 참고사항

1. **코드 품질 > 개발 속도**
2. **문서화는 선택이 아닌 필수**
3. **테스트 없는 코드는 버그**
4. **리팩토링은 지속적으로**
5. **보안은 처음부터 고려**

---

**마지막 업데이트**: 2025년 10월 24일  
**다음 리뷰**: 2025년 11월 1일