{"version":3,"file":"static/js/319.b38301b0.chunk.js","mappings":"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","sources":["components/admin/AlternativeManagement.tsx","utils/textParser.ts","components/criteria/BulkCriteriaInput.tsx","components/criteria/CriteriaTemplates.tsx","components/criteria/VisualCriteriaBuilder.tsx","components/admin/CriteriaManagement.tsx","components/admin/EvaluatorAssignment.tsx","components/common/HierarchyTreeVisualization.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport Input from '../common/Input';\r\nimport dataService from '../../services/dataService_clean';\r\nimport { AlternativeData, criteriaApi } from '../../services/api';\r\n\r\ninterface Alternative extends Omit<AlternativeData, 'project_id' | 'position' | 'id'> {\r\n  id: string; // required\r\n  order: number;\r\n  weight?: number;\r\n  rank?: number;\r\n}\r\n\r\ninterface AlternativeManagementProps {\r\n  projectId: string;\r\n  onComplete: () => void;\r\n  onAlternativesChange?: (alternativesCount: number) => void;\r\n}\r\n\r\nconst AlternativeManagement: React.FC<AlternativeManagementProps> = ({ projectId, onComplete, onAlternativesChange }) => {\r\n  const [alternatives, setAlternatives] = useState<Alternative[]>([]);\r\n\r\n  // AlternativeData Alternative \r\n  const convertToAlternative = (data: AlternativeData): Alternative => ({\r\n    id: data.id || `alt_${Date.now()}_${Math.random()}`,\r\n    name: data.name,\r\n    description: data.description,\r\n    order: data.position || 0,\r\n    cost: data.cost,\r\n    weight: 0,\r\n    rank: 0\r\n  });\r\n\r\n  // Alternative AlternativeData \r\n  const convertToAlternativeData = (alt: Partial<Alternative>): Omit<AlternativeData, 'id'> => ({\r\n    project_id: projectId,\r\n    name: alt.name || '',\r\n    description: alt.description || '',\r\n    position: alt.order || 0,\r\n    cost: alt.cost\r\n  });\r\n\r\n  useEffect(() => {\r\n    //     (PostgreSQL)\r\n    const loadProjectAlternatives = async () => {\r\n      try {\r\n        const alternativesData = await dataService.getAlternatives(projectId);\r\n        const convertedAlternatives = (alternativesData || []).map(convertToAlternative);\r\n        setAlternatives(convertedAlternatives);\r\n\r\n        //    \r\n        if (onAlternativesChange) {\r\n          onAlternativesChange(convertedAlternatives.length);\r\n        }\r\n      } catch (error) {\r\n        setAlternatives([]);\r\n        if (onAlternativesChange) {\r\n          onAlternativesChange(0);\r\n        }\r\n      }\r\n    };\r\n\r\n    if (projectId) {\r\n      loadProjectAlternatives();\r\n    }\r\n  }, [projectId, onAlternativesChange]);\r\n\r\n  //       \r\n  useEffect(() => {\r\n    if (onAlternativesChange) {\r\n      onAlternativesChange(alternatives.length);\r\n    }\r\n  }, [alternatives, onAlternativesChange]);\r\n\r\n  const [newAlternative, setNewAlternative] = useState({ name: '', description: '' });\r\n  const [editingId, setEditingId] = useState<string | null>(null);\r\n  const [editingAlternative, setEditingAlternative] = useState({ name: '', description: '' });\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n  const [actionMessage, setActionMessage] = useState<{type:'success'|'error'|'info', text:string}|null>(null);\r\n\r\n  const showActionMessage = (type: 'success'|'error'|'info', text: string) => {\r\n    setActionMessage({type, text});\r\n    setTimeout(() => setActionMessage(null), 3000);\r\n  };\r\n\r\n  const validateAlternative = (name: string, excludeId?: string): boolean => {\r\n    const newErrors: Record<string, string> = {};\r\n\r\n    if (!name.trim()) {\r\n      newErrors.name = ' .';\r\n    } else if (name.length < 2) {\r\n      newErrors.name = ' 2  .';\r\n    } else {\r\n      // Check for duplicate names\r\n      const isDuplicate = alternatives.some(alt => \r\n        alt.name.toLowerCase() === name.toLowerCase() && alt.id !== excludeId\r\n      );\r\n      if (isDuplicate) {\r\n        newErrors.name = '   .';\r\n      }\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleAddAlternative = async () => {\r\n    if (!validateAlternative(newAlternative.name)) {\r\n      return;\r\n    }\r\n\r\n    const maxOrder = Math.max(...alternatives.map(alt => alt.order), 0);\r\n\r\n    try {\r\n      const alternativeData = convertToAlternativeData({\r\n        name: newAlternative.name,\r\n        description: newAlternative.description || '',\r\n        order: maxOrder + 1\r\n      });\r\n\r\n      const createdAlternative = await dataService.createAlternative(alternativeData);\r\n\r\n      if (!createdAlternative) {\r\n        setErrors({ name: '  .' });\r\n        return;\r\n      }\r\n      \r\n      //   \r\n      const updatedAlternativesData = await dataService.getAlternatives(projectId);\r\n      const convertedUpdatedAlternatives = (updatedAlternativesData || []).map(convertToAlternative);\r\n      setAlternatives(convertedUpdatedAlternatives);\r\n      \r\n      setNewAlternative({ name: '', description: '' });\r\n      setErrors({});\r\n      \r\n      //     \r\n      if (onAlternativesChange) {\r\n        onAlternativesChange(convertedUpdatedAlternatives.length);\r\n      }\r\n    } catch (error) {\r\n      setErrors({ name: '    .  .' });\r\n    }\r\n  };\r\n\r\n  const handleEditAlternative = (id: string) => {\r\n    const alternative = alternatives.find(alt => alt.id === id);\r\n    if (alternative) {\r\n      setEditingId(id);\r\n      setEditingAlternative({ name: alternative.name, description: alternative.description || '' });\r\n    }\r\n  };\r\n\r\n  const handleSaveEdit = async () => {\r\n    if (!editingId || !validateAlternative(editingAlternative.name, editingId)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await criteriaApi.updateCriteria(editingId, {\r\n        name: editingAlternative.name,\r\n        description: editingAlternative.description,\r\n        project_id: projectId\r\n      });\r\n      if (!response.success) {\r\n        setErrors({ general: response.error || '  .' });\r\n        return;\r\n      }\r\n      setAlternatives(prev => prev.map(alt =>\r\n        alt.id === editingId\r\n          ? { ...alt, name: editingAlternative.name, description: editingAlternative.description }\r\n          : alt\r\n      ));\r\n      setEditingId(null);\r\n      setEditingAlternative({ name: '', description: '' });\r\n      setErrors({});\r\n    } catch (error: unknown) {\r\n      setErrors({ general: (error instanceof Error ? error.message : '') || '    .' });\r\n    }\r\n  };\r\n\r\n  const handleCancelEdit = () => {\r\n    setEditingId(null);\r\n    setEditingAlternative({ name: '', description: '' });\r\n    setErrors({});\r\n  };\r\n\r\n  const handleDeleteAlternative = async (id: string) => {\r\n    try {\r\n      const success = await dataService.deleteAlternative(id, projectId);\r\n\r\n      if (!success) {\r\n        return;\r\n      }\r\n      \r\n      //   \r\n      const updatedAlternativesData = await dataService.getAlternatives(projectId);\r\n      const convertedUpdatedAlternatives = (updatedAlternativesData || []).map(convertToAlternative);\r\n      setAlternatives(convertedUpdatedAlternatives);\r\n      \r\n      //     \r\n      if (onAlternativesChange) {\r\n        onAlternativesChange(convertedUpdatedAlternatives.length);\r\n      }\r\n    } catch (error) {\r\n      showActionMessage('error', '    .');\r\n    }\r\n  };\r\n\r\n  const handleMoveUp = (id: string) => {\r\n    const index = alternatives.findIndex(alt => alt.id === id);\r\n    if (index > 0) {\r\n      const newAlternatives = [...alternatives];\r\n      [newAlternatives[index], newAlternatives[index - 1]] = [newAlternatives[index - 1], newAlternatives[index]];\r\n      \r\n      // Update order values\r\n      newAlternatives.forEach((alt, idx) => {\r\n        alt.order = idx + 1;\r\n      });\r\n      \r\n      setAlternatives(newAlternatives);\r\n    }\r\n  };\r\n\r\n  const handleMoveDown = (id: string) => {\r\n    const index = alternatives.findIndex(alt => alt.id === id);\r\n    if (index < alternatives.length - 1) {\r\n      const newAlternatives = [...alternatives];\r\n      [newAlternatives[index], newAlternatives[index + 1]] = [newAlternatives[index + 1], newAlternatives[index]];\r\n      \r\n      // Update order values\r\n      newAlternatives.forEach((alt, idx) => {\r\n        alt.order = idx + 1;\r\n      });\r\n      \r\n      setAlternatives(newAlternatives);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {actionMessage && (\r\n        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg ${actionMessage.type === 'success' ? 'bg-green-100 text-green-800' : actionMessage.type === 'info' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`}>\r\n          {actionMessage.text}\r\n        </div>\r\n      )}\r\n      <Card title=\" \">\r\n        <div className=\"space-y-6\">\r\n          {/*      */}\r\n          <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 border-l-4 border-green-400 p-4 rounded-r-lg mb-4\">\r\n            <div className=\"flex items-start\">\r\n              <div className=\"flex-shrink-0\">\r\n                <svg className=\"h-5 w-5 text-green-600 mt-0.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                  <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </div>\r\n              <div className=\"ml-3\">\r\n                <h3 className=\"text-sm font-semibold text-green-800\">   :  3 </h3>\r\n                <div className=\"mt-2 text-sm text-green-700\">\r\n                  <p className=\"mb-2\">   <strong>3 </strong>   . (  5  )</p>\r\n                  <ul className=\"list-disc list-inside space-y-1 text-xs\">\r\n                    <li> : 3  = 3, 4  = 6, 5  = 10</li>\r\n                    <li>3   3  =  12   </li>\r\n                    <li>     </li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n            <h4 className=\"font-medium text-green-900 mb-2\">    </h4>\r\n            <ul className=\"text-sm text-green-700 space-y-1\">\r\n              <li>      </li>\r\n              <li>    </li>\r\n              <li>       </li>\r\n              <li>    ,     </li>\r\n              <li>         </li>\r\n            </ul>\r\n          </div>\r\n\r\n          {/* Current Alternatives List */}\r\n          <div>\r\n            <h4 className=\"font-medium text-gray-900 mb-3\">   </h4>\r\n            {alternatives.length === 0 ? (\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                   .\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                {alternatives\r\n                  .sort((a, b) => a.order - b.order)\r\n                  .map((alternative, index) => (\r\n                    <div\r\n                      key={alternative.id}\r\n                      className=\"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white hover:bg-gray-50\"\r\n                    >\r\n                      <div className=\"flex items-center flex-1\">\r\n                        <div className=\"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-800 rounded-full text-sm font-medium mr-4\">\r\n                          {alternative.order}\r\n                        </div>\r\n                        \r\n                        {editingId === alternative.id ? (\r\n                          <div className=\"flex-1 grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                            <Input\r\n                              id={`edit-name-${alternative.id}`}\r\n                              label=\"\"\r\n                              placeholder=\" \"\r\n                              value={editingAlternative.name}\r\n                              onChange={(value) => setEditingAlternative(prev => ({ ...prev, name: value }))}\r\n                              error={errors.name}\r\n                            />\r\n                            <Input\r\n                              id={`edit-desc-${alternative.id}`}\r\n                              label=\"\"\r\n                              placeholder=\"  ()\"\r\n                              value={editingAlternative.description}\r\n                              onChange={(value) => setEditingAlternative(prev => ({ ...prev, description: value }))}\r\n                            />\r\n                          </div>\r\n                        ) : (\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <div>\r\n                                <h5 className=\"font-medium text-gray-900\">{alternative.name}</h5>\r\n                                {alternative.description && (\r\n                                  <p className=\"text-sm text-gray-600\">{alternative.description}</p>\r\n                                )}\r\n                              </div>\r\n                              <div className=\"flex items-center space-x-3\">\r\n                                {alternative.rank && (\r\n                                  <div className=\"text-xs font-semibold\">\r\n                                    <span className=\"bg-yellow-100 text-yellow-800 px-2 py-1 rounded\">\r\n                                      #{alternative.rank}\r\n                                    </span>\r\n                                  </div>\r\n                                )}\r\n                                {alternative.weight && (\r\n                                  <div className=\"text-xs font-mono bg-blue-100 text-blue-800 px-2 py-1 rounded\">\r\n                                    {(alternative.weight * 100).toFixed(3)}%\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center space-x-2 ml-4\">\r\n                        {editingId === alternative.id ? (\r\n                          <>\r\n                            <button\r\n                              onClick={handleSaveEdit}\r\n                              className=\"text-green-600 hover:text-green-800 text-sm font-medium\"\r\n                            >\r\n                              \r\n                            </button>\r\n                            <button\r\n                              onClick={handleCancelEdit}\r\n                              className=\"text-gray-600 hover:text-gray-800 text-sm\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            <button\r\n                              onClick={() => handleMoveUp(alternative.id)}\r\n                              disabled={index === 0}\r\n                              className={`text-sm ${index === 0 ? 'text-gray-300' : 'text-blue-600 hover:text-blue-800'}`}\r\n                              title=\" \"\r\n                            >\r\n                              \r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleMoveDown(alternative.id)}\r\n                              disabled={index === alternatives.length - 1}\r\n                              className={`text-sm ${index === alternatives.length - 1 ? 'text-gray-300' : 'text-blue-600 hover:text-blue-800'}`}\r\n                              title=\" \"\r\n                            >\r\n                              \r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleEditAlternative(alternative.id)}\r\n                              className=\"text-blue-600 hover:text-blue-800 text-sm\"\r\n                              title=\"\"\r\n                            >\r\n                              \r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleDeleteAlternative(alternative.id)}\r\n                              className=\"text-red-500 hover:text-red-700 text-sm\"\r\n                              title=\"\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Add New Alternative */}\r\n          <div className=\"border-t pt-6\">\r\n            <h4 className=\"font-medium text-gray-900 mb-4\">   </h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n              <Input\r\n                id=\"alternativeName\"\r\n                label=\"\"\r\n                placeholder=\" \"\r\n                value={newAlternative.name}\r\n                onChange={(value) => setNewAlternative(prev => ({ ...prev, name: value }))}\r\n                error={errors.name}\r\n                required\r\n              />\r\n\r\n              <Input\r\n                id=\"alternativeDescription\"\r\n                label=\"  ()\"\r\n                placeholder=\"  \"\r\n                value={newAlternative.description}\r\n                onChange={(value) => setNewAlternative(prev => ({ ...prev, description: value }))}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex justify-end\">\r\n              <Button onClick={handleAddAlternative} variant=\"primary\">\r\n                 \r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Summary with Paper Recommendation */}\r\n          <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <div>\r\n                <h5 className=\"font-medium text-gray-900\"> </h5>\r\n                <p className=\"text-sm text-gray-600\">\r\n                   {alternatives.length}  \r\n                  {alternatives.length === 3 && <span className=\"ml-2 text-green-600 font-semibold\">   </span>}\r\n                  {alternatives.length > 0 && alternatives.length < 3 && <span className=\"ml-2 text-yellow-600\"> 3 </span>}\r\n                  {alternatives.length > 5 && <span className=\"ml-2 text-orange-600\">   </span>}\r\n                </p>\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">\r\n                {alternatives.length > 0 && (\r\n                  <span> : {alternatives.map(alt => alt.name).join('  ')}</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex justify-between items-center pt-6 border-t\">\r\n            <div className=\"text-sm text-gray-600\">\r\n              {alternatives.length === 0 && (\r\n                <div className=\"bg-blue-50 p-3 rounded-lg border border-blue-200\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <span className=\"text-blue-600\"></span>\r\n                    <div>\r\n                      <div className=\"font-medium text-blue-900\">  </div>\r\n                      <div className=\"text-sm text-blue-700\">    AHP  .</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"flex space-x-3\">\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={async () => {\r\n                  showActionMessage('success', '  .');\r\n                }}\r\n              >\r\n                \r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={onComplete}\r\n              >\r\n                 \r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AlternativeManagement;","interface ParsedCriterion {\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  parent_id?: string | null;\r\n}\r\n\r\ninterface ParseResult {\r\n  success: boolean;\r\n  criteria: ParsedCriterion[];\r\n  errors: string[];\r\n}\r\n\r\nexport class TextParser {\r\n  /**\r\n   *       .\r\n   *  :\r\n   * 1. / \r\n   * 2.   (-, *, +)\r\n   * 3.   (1., 1-1., 1.1., etc.)\r\n   * 4. Excel - ( )\r\n   */\r\n  static parseText(text: string): ParseResult {\r\n    const lines = text.split('\\n').filter(line => line.trim().length > 0);\r\n    const criteria: ParsedCriterion[] = [];\r\n    const errors: string[] = [];\r\n    const nameMap = new Map<string, boolean>(); //  \r\n\r\n    if (lines.length === 0) {\r\n      return { success: false, criteria: [], errors: ['  .'] };\r\n    }\r\n\r\n    try {\r\n      for (let i = 0; i < lines.length; i++) {\r\n        const line = lines[i];\r\n        const parsed = this.parseLine(line, i + 1);\r\n        \r\n        if (parsed) {\r\n          //   \r\n          const lowerName = parsed.name.toLowerCase();\r\n          if (nameMap.has(lowerName)) {\r\n            errors.push(` ${i + 1}:   \"${parsed.name}\"`);\r\n            continue;\r\n          }\r\n          nameMap.set(lowerName, true);\r\n\r\n          //   \r\n          if (parsed.name.length < 2) {\r\n            errors.push(` ${i + 1}:  2  .`);\r\n            continue;\r\n          }\r\n\r\n          //   (1-5 )\r\n          if (parsed.level > 5) {\r\n            errors.push(` ${i + 1}:  5 .`);\r\n            continue;\r\n          }\r\n\r\n          criteria.push(parsed);\r\n        } else {\r\n          errors.push(` ${i + 1}:    . \"${line}\"`);\r\n        }\r\n      }\r\n\r\n      //   \r\n      const structureErrors = this.validateHierarchy(criteria);\r\n      errors.push(...structureErrors);\r\n\r\n      return {\r\n        success: errors.length === 0,\r\n        criteria,\r\n        errors\r\n      };\r\n\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        criteria: [],\r\n        errors: [`   : ${error}`]\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   *   .\r\n   * : 1)  , 2)  , 3)  \r\n   */\r\n  private static parseLine(line: string, lineNumber: number): ParsedCriterion | null {\r\n    // 1.       (1., 1.1., 1-1., 2., 2.1. etc.)\r\n    //      \r\n    const numberedMatch = line.match(/^\\s*(\\d+(?:[.-]\\d+)*)\\.?\\s+(.+)$/);\r\n    if (numberedMatch) {\r\n      const [, number, content] = numberedMatch;\r\n      \r\n      //    \r\n      // \"1\", \"2\", \"3\" =  1\r\n      // \"1.1\", \"2.1\" =  2\r\n      // \"1.1.1\", \"2.1.1\" =  3\r\n      let level = 1;\r\n      \r\n      //      \r\n      if (number.includes('.') || number.includes('-')) {\r\n        const parts = number.split(/[.-]/).filter(p => p.trim() !== '');\r\n        level = parts.length;\r\n      }\r\n      \r\n      const [name, description] = this.extractNameAndDescription(content);\r\n      return { name: name.trim(), description, level };\r\n    }\r\n\r\n    // 2.    (-, *, +    )\r\n    const markdownMatch = line.match(/^(\\s*)([-*+])\\s+(.+)$/);\r\n    if (markdownMatch) {\r\n      const [, indent, , content] = markdownMatch;\r\n      //   \r\n      let level = 1;\r\n      if (indent.length > 0) {\r\n        //  4 \r\n        const spaces = indent.replace(/\\t/g, '    ').length;\r\n        // 2  4 1 \r\n        if (spaces >= 2) {\r\n          level = Math.floor(spaces / 2) + 1;\r\n        }\r\n      }\r\n      const [name, description] = this.extractNameAndDescription(content);\r\n      return { name: name.trim(), description, level };\r\n    }\r\n\r\n    //    (  )\r\n    const indentMatch = line.match(/^(\\s+)(.+)$/);\r\n    if (indentMatch) {\r\n      const [, indent, content] = indentMatch;\r\n      \r\n      //      \r\n      const spaces = indent.replace(/\\t/g, '    ').length;\r\n      \r\n      // 4 1  (4 =  2, 8 =  3, ...)\r\n      const level = Math.floor(spaces / 4) + 1;\r\n\r\n      const [name, description] = this.extractNameAndDescription(content);\r\n      return { name: name.trim(), description, level };\r\n    }\r\n\r\n    //      1 \r\n    const plainMatch = line.match(/^(.+)$/);\r\n    if (plainMatch) {\r\n      const [, content] = plainMatch;\r\n      const [name, description] = this.extractNameAndDescription(content);\r\n      return { name: name.trim(), description, level: 1 };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   *    .\r\n   * : \" - \"  \": \"  \" ()\"\r\n   */\r\n  private static extractNameAndDescription(text: string): [string, string?] {\r\n    // \" - \" \r\n    const dashMatch = text.match(/^([^-]+?)\\s*-\\s*(.+)$/);\r\n    if (dashMatch) {\r\n      return [dashMatch[1].trim(), dashMatch[2].trim()];\r\n    }\r\n\r\n    // \": \" \r\n    const colonMatch = text.match(/^([^:]+?)\\s*:\\s*(.+)$/);\r\n    if (colonMatch) {\r\n      return [colonMatch[1].trim(), colonMatch[2].trim()];\r\n    }\r\n\r\n    // \" ()\" \r\n    const parenthesesMatch = text.match(/^([^(]+?)\\s*\\(([^)]+)\\)\\s*$/);\r\n    if (parenthesesMatch) {\r\n      return [parenthesesMatch[1].trim(), parenthesesMatch[2].trim()];\r\n    }\r\n\r\n    //   \r\n    return [text.trim()];\r\n  }\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  private static validateHierarchy(criteria: ParsedCriterion[]): string[] {\r\n    const errors: string[] = [];\r\n    \r\n    if (criteria.length === 0) {\r\n      return [' 1   .'];\r\n    }\r\n\r\n    //  1  \r\n    const level1Count = criteria.filter(c => c.level === 1).length;\r\n    if (level1Count === 0) {\r\n      errors.push(' ( 1)   1 .');\r\n    }\r\n\r\n    //   \r\n    const levelSet = new Set(criteria.map(c => c.level));\r\n    const levels = Array.from(levelSet).sort((a, b) => a - b);\r\n    for (let i = 0; i < levels.length - 1; i++) {\r\n      if (levels[i + 1] - levels[i] > 1) {\r\n        errors.push(` ${levels[i]}  ${levels[i + 1]}   .   .`);\r\n      }\r\n    }\r\n\r\n    return errors;\r\n  }\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  static getExampleTexts(): { [key: string]: string } {\r\n    return {\r\n      markdown: `-  \r\n  -  -   \r\n  -  -    \r\n  -  -   \r\n-  \r\n  -  -    \r\n  -   -   \r\n  -   - R&D   \r\n- \r\n  -   -    \r\n  -   -   \r\n  -  -   `,\r\n\r\n      numbered: `1.  \r\n  1.1.  -   \r\n  1.2.  -  \r\n  1.3.  -   \r\n2.  \r\n  2.1.  -    \r\n  2.2.   -   \r\n  2.3.   - R&D   \r\n3. \r\n  3.1.   -    \r\n  3.2.   -   \r\n  3.3.  -   `,\r\n\r\n      indented: ` \r\n     -   \r\n     -  \r\n     -   \r\n \r\n     -    \r\n      -   \r\n      - R&D   \r\n\r\n      -    \r\n      -   \r\n     -   `\r\n    };\r\n  }\r\n}\r\n\r\nexport default TextParser;","import React, { useState } from 'react';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport TextParser from '../../utils/textParser';\r\n\r\ninterface Criterion {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  parent_id?: string | null;\r\n  level: number;\r\n  children?: Criterion[];\r\n  weight?: number;\r\n  order?: number;\r\n}\r\n\r\ninterface ParsedCriterion {\r\n  name: string;\r\n  level: number;\r\n  description?: string;\r\n}\r\n\r\ninterface ParseResult {\r\n  success: boolean;\r\n  criteria: ParsedCriterion[];\r\n  errors: string[];\r\n}\r\n\r\ninterface BulkCriteriaInputProps {\r\n  onImport: (criteria: Criterion[]) => void;\r\n  onCancel: () => void;\r\n  existingCriteria: Criterion[];\r\n}\r\n\r\nconst BulkCriteriaInput: React.FC<BulkCriteriaInputProps> = ({\r\n  onImport,\r\n  onCancel,\r\n  existingCriteria\r\n}) => {\r\n  const [inputText, setInputText] = useState('');\r\n  const [activeTab, setActiveTab] = useState<'input' | 'examples'>('input');\r\n  const [parseResult, setParseResult] = useState<ParseResult | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [actionMessage, setActionMessage] = useState<{type:'success'|'error'|'info', text:string}|null>(null);\r\n\r\n  const showActionMessage = (type: 'success'|'error'|'info', text: string) => {\r\n    setActionMessage({type, text});\r\n    setTimeout(() => setActionMessage(null), 3000);\r\n  };\r\n\r\n  const handleParse = () => {\r\n    if (!inputText.trim()) {\r\n      setParseResult({\r\n        success: false,\r\n        criteria: [],\r\n        errors: ['  .']\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    \r\n    try {\r\n      const result = TextParser.parseText(inputText);\r\n\r\n      //     (   )\r\n      if (existingCriteria && existingCriteria.length > 0) {\r\n        const existingNames = getAllCriteria(existingCriteria).map(c => c.name.toLowerCase());\r\n        const duplicates = result.criteria.filter(c => \r\n          existingNames.includes(c.name.toLowerCase())\r\n        );\r\n        \r\n        if (duplicates.length > 0) {\r\n          result.errors.push(\r\n            `  : ${duplicates.map(d => d.name).join(', ')}`\r\n          );\r\n          result.success = false;\r\n        }\r\n      }\r\n      \r\n      setParseResult(result);\r\n    } catch (error) {\r\n      setParseResult({\r\n        success: false,\r\n        criteria: [],\r\n        errors: [`   : ${error}`]\r\n      });\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleImport = () => {\r\n    if (!parseResult || !parseResult.success) return;\r\n\r\n    //    Criterion   ( )\r\n    const convertedCriteria = convertParsedCriteriaFlat(parseResult.criteria);\r\n\r\n    //   \r\n    const validationErrors: string[] = [];\r\n    \r\n    // 1.   \r\n    convertedCriteria.forEach((criterion, index) => {\r\n      if (!criterion.id) validationErrors.push(`${index + 1} : ID `);\r\n      if (!criterion.name || criterion.name.trim() === '') validationErrors.push(`${index + 1} :  `);\r\n      if (!criterion.level || criterion.level < 1) validationErrors.push(`${index + 1} :   (${criterion.level})`);\r\n    });\r\n    \r\n    // 2. parent_id   \r\n    const idSet = new Set(convertedCriteria.map(c => c.id));\r\n    convertedCriteria.forEach((criterion, index) => {\r\n      if (criterion.parent_id && !idSet.has(criterion.parent_id)) {\r\n        validationErrors.push(`${index + 1}  '${criterion.name}':    ID (${criterion.parent_id})`);\r\n      }\r\n    });\r\n\r\n    if (validationErrors.length > 0) {\r\n      showActionMessage('error', `  : ${validationErrors.join(', ')}`);\r\n      return;\r\n    }\r\n\r\n    //      import\r\n    onImport(convertedCriteria);\r\n  };\r\n\r\n  //    (CriteriaManagement  )\r\n  const convertParsedCriteriaFlat = (parsedCriteria: ParsedCriterion[]): Criterion[] => {\r\n    const allCriteria: Criterion[] = [];\r\n    const levelParentMap: Map<number, Criterion> = new Map();\r\n    \r\n    //   \r\n    parsedCriteria.forEach((parsed, index) => {\r\n      const id = `temp_${Date.now()}_${index}_${Math.floor(Math.random() * 1000)}`;\r\n      \r\n      //  :   1    \r\n      let parent_id: string | null = null;\r\n      if (parsed.level > 1) {\r\n        const parentLevel = parsed.level - 1;\r\n        const parentNode = levelParentMap.get(parentLevel);\r\n        if (parentNode) {\r\n          parent_id = parentNode.id;\r\n        }\r\n      }\r\n      \r\n      const criterion: Criterion = {\r\n        id,\r\n        name: parsed.name,\r\n        description: parsed.description,\r\n        parent_id,\r\n        level: parsed.level,\r\n        children: undefined, //   children \r\n        weight: 1,\r\n        order: index + 1\r\n      };\r\n      \r\n      allCriteria.push(criterion);\r\n\r\n      //      ( /     )\r\n      levelParentMap.set(parsed.level, criterion);\r\n\r\n      //     (     )\r\n      for (let level = parsed.level + 1; level <= 10; level++) {\r\n        levelParentMap.delete(level);\r\n      }\r\n    });\r\n\r\n    //    \r\n    return allCriteria;\r\n  };\r\n\r\n\r\n  const getAllCriteria = (criteriaList: Criterion[]): Criterion[] => {\r\n    const all: Criterion[] = [];\r\n    const traverse = (items: Criterion[]) => {\r\n      items.forEach(item => {\r\n        all.push(item);\r\n        if (item.children && item.children.length > 0) {\r\n          traverse(item.children);\r\n        }\r\n      });\r\n    };\r\n    traverse(criteriaList);\r\n    return all;\r\n  };\r\n\r\n  const exampleTexts = TextParser.getExampleTexts();\r\n\r\n  const insertExample = (exampleKey: string) => {\r\n    setInputText(exampleTexts[exampleKey]);\r\n    setActiveTab('input');\r\n    setParseResult(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      {actionMessage && (\r\n        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg ${actionMessage.type === 'success' ? 'bg-green-100 text-green-800' : actionMessage.type === 'info' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`}>\r\n          {actionMessage.text}\r\n        </div>\r\n      )}\r\n      <div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col\">\r\n        <Card title=\"   \">\r\n          <div className=\"flex flex-col h-full max-h-[80vh]\">\r\n            {/*   -  */}\r\n            <div className=\"flex border-b flex-shrink-0\">\r\n              <button\r\n                className={`px-4 py-2 font-medium ${\r\n                  activeTab === 'input'\r\n                    ? 'border-b-2 border-blue-500 text-blue-600'\r\n                    : 'text-gray-500 hover:text-gray-700'\r\n                }`}\r\n                onClick={() => setActiveTab('input')}\r\n              >\r\n                 \r\n              </button>\r\n              <button\r\n                className={`px-4 py-2 font-medium ${\r\n                  activeTab === 'examples'\r\n                    ? 'border-b-2 border-blue-500 text-blue-600'\r\n                    : 'text-gray-500 hover:text-gray-700'\r\n                }`}\r\n                onClick={() => setActiveTab('examples')}\r\n              >\r\n                 \r\n              </button>\r\n            </div>\r\n\r\n            {/*     */}\r\n            <div className=\"flex-1 overflow-y-scroll p-6 space-y-6 pb-20\">\r\n\r\n            {activeTab === 'input' && (\r\n              <div className=\"space-y-4\">\r\n                {/*   -   */}\r\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n                  <h4 className=\"font-medium text-blue-900 mb-3\">   </h4>\r\n                  <div className=\"text-sm text-blue-700 space-y-3\">\r\n                    <div>\r\n                      <strong>   </strong>\r\n                      <div className=\"ml-4 mt-1 font-mono text-xs bg-white p-2 rounded\">\r\n                        - <br/>\r\n                        &nbsp;&nbsp;-  (2 )<br/>\r\n                        &nbsp;&nbsp;&nbsp;&nbsp;-  (4 )\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <strong>   </strong>\r\n                      <div className=\"ml-4 mt-1 font-mono text-xs bg-white p-2 rounded\">\r\n                        1. <br/>\r\n                        &nbsp;&nbsp;1.1. <br/>\r\n                        &nbsp;&nbsp;1.2. \r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <strong>  </strong>\r\n                      <div className=\"ml-4 mt-1 font-mono text-xs bg-white p-2 rounded\">\r\n                        <br/>\r\n                        &nbsp;&nbsp;&nbsp;&nbsp; (4 )<br/>\r\n                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (8 )\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-yellow-700 bg-yellow-50 p-2 rounded\">\r\n                       <strong>:</strong>     !<br/>\r\n                       : 2 <br/>\r\n                       : 4 \r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/*    */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      \r\n                  </label>\r\n                  <textarea\r\n                    className=\"w-full h-64 p-3 border border-gray-300 rounded-lg font-mono text-sm resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                    placeholder=\"  ...\r\n\r\n:\r\n-  \r\n  -  -     \r\n  -  -    \r\n  -  -       \r\n- \r\n  -   -      \r\n  -   -     \"\r\n                    value={inputText}\r\n                    onChange={(e) => setInputText(e.target.value)}\r\n                  />\r\n                </div>\r\n\r\n                {/*   */}\r\n                <div className=\"flex justify-center\">\r\n                  <Button\r\n                    variant=\"primary\"\r\n                    onClick={handleParse}\r\n                    disabled={!inputText.trim() || isProcessing}\r\n                  >\r\n                    {isProcessing ? ' ...' : '  '}\r\n                  </Button>\r\n                </div>\r\n\r\n                {/*   */}\r\n                {parseResult && (\r\n                  <div className=\"space-y-4\">\r\n                    {parseResult.success ? (\r\n                      <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n                        <h4 className=\"font-medium text-green-900 mb-3\">\r\n                             ({parseResult.criteria.length} )\r\n                        </h4>\r\n                        <div className=\"space-y-2\">\r\n                          {/*   */}\r\n                          <div className=\"text-sm text-green-700 mb-3\">\r\n                            {(() => {\r\n                              const levelCounts = parseResult.criteria.reduce((acc: Record<number, number>, c: ParsedCriterion) => {\r\n                                acc[c.level] = (acc[c.level] || 0) + 1;\r\n                                return acc;\r\n                              }, {} as Record<number, number>);\r\n                              return Object.entries(levelCounts).map(([level, count]) => (\r\n                                <span key={level} className=\"inline-block mr-4\">\r\n                                  {` ${level}: ${count}`}\r\n                                </span>\r\n                              ));\r\n                            })()}\r\n                          </div>\r\n                          {/*   */}\r\n                          <div className=\"bg-white rounded p-3 text-sm\">\r\n                            {parseResult.criteria.map((criterion: ParsedCriterion, index: number) => (\r\n                              <div key={index} className=\"py-1\">\r\n                                <span style={{ paddingLeft: `${(criterion.level - 1) * 20}px` }}>\r\n                                  {criterion.level === 1 && ' '}\r\n                                  {criterion.level === 2 && ' '}\r\n                                  {criterion.level === 3 && ' '}\r\n                                  {criterion.level === 4 && ' '}\r\n                                  {criterion.level >= 5 && ' '}\r\n                                  <span className=\"font-medium\">{criterion.name}</span>\r\n                                  {criterion.description && (\r\n                                    <span className=\"ml-2 text-gray-600\">- {criterion.description}</span>\r\n                                  )}\r\n                                </span>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n                        <h4 className=\"font-medium text-red-900 mb-2\">  </h4>\r\n                        <ul className=\"text-sm text-red-700 space-y-1\">\r\n                          {parseResult.errors.map((error: string, index: number) => (\r\n                            <li key={index}> {error}</li>\r\n                          ))}\r\n                        </ul>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {activeTab === 'examples' && (\r\n              <div className=\"space-y-6 pb-8\">\r\n                <div className=\"text-center\">\r\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-2\">  </h3>\r\n                  <p className=\"text-gray-600 text-sm\">\r\n                         .\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"grid gap-4 mb-8\">\r\n                  {Object.entries(exampleTexts).map(([key, text]) => (\r\n                    <div key={key} className=\"border border-gray-200 rounded-lg p-4\">\r\n                      <div className=\"flex items-center justify-between mb-2\">\r\n                        <h4 className=\"font-medium text-gray-900\">\r\n                          {key === 'markdown' && '    (2 )'}\r\n                          {key === 'numbered' && '   '}\r\n                          {key === 'indented' && '   (4 )'}\r\n                        </h4>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => insertExample(key)}\r\n                        >\r\n                          \r\n                        </Button>\r\n                      </div>\r\n                      <pre className=\"text-xs bg-gray-50 p-3 rounded border overflow-x-auto whitespace-pre\">\r\n                        {text}\r\n                      </pre>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n                \r\n                {/*       */}\r\n                <div className=\"h-16\"></div>\r\n              </div>\r\n            )}\r\n            </div>\r\n\r\n            {/*   -   */}\r\n            <div className=\"flex justify-end space-x-3 pt-4 px-6 pb-6 border-t flex-shrink-0 bg-white\">\r\n              <Button variant=\"secondary\" onClick={onCancel}>\r\n                \r\n              </Button>\r\n              {parseResult && parseResult.success && (\r\n                <Button variant=\"primary\" onClick={handleImport}>\r\n                   {parseResult.criteria.length}  \r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BulkCriteriaInput;","import React from 'react';\r\nimport Button from '../common/Button';\r\n\r\nexport interface CriteriaTemplateNode {\r\n  name: string;\r\n  description?: string;\r\n  children?: CriteriaTemplateNode[];\r\n}\r\n\r\nexport interface CriteriaTemplate {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  structure: CriteriaTemplateNode[];\r\n}\r\n\r\nexport const CRITERIA_TEMPLATES: CriteriaTemplate[] = [\r\n  {\r\n    id: '3x3',\r\n    name: '3x3  ',\r\n    description: '3 ,  3 ',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: ' 1',\r\n        description: '   ',\r\n        children: [\r\n          { name: ' 1-1', description: '  ' },\r\n          { name: ' 1-2', description: '  ' },\r\n          { name: ' 1-3', description: '  ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' 2',\r\n        description: '   ',\r\n        children: [\r\n          { name: ' 2-1', description: '  ' },\r\n          { name: ' 2-2', description: '  ' },\r\n          { name: ' 2-3', description: '  ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' 3',\r\n        description: '   ',\r\n        children: [\r\n          { name: ' 3-1', description: '  ' },\r\n          { name: ' 3-2', description: '  ' },\r\n          { name: ' 3-3', description: '  ' }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    id: '4x2',\r\n    name: '4x2 ',\r\n    description: '4 ,  2 ',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: '',\r\n        description: '/  ',\r\n        children: [\r\n          { name: '', description: '   ' },\r\n          { name: '', description: ' ' }\r\n        ]\r\n      },\r\n      {\r\n        name: '',\r\n        description: ' ',\r\n        children: [\r\n          { name: '', description: '   ' },\r\n          { name: '', description: '   ' }\r\n        ]\r\n      },\r\n      {\r\n        name: '',\r\n        description: '  ',\r\n        children: [\r\n          { name: '', description: '   ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      },\r\n      {\r\n        name: '',\r\n        description: '  ',\r\n        children: [\r\n          { name: '', description: '   ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    id: '2x4',\r\n    name: '2x4  ',\r\n    description: '2 ,  4 ',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          { name: ' ', description: 'KPI ' },\r\n          { name: '', description: '  ' },\r\n          { name: '', description: '  ' },\r\n          { name: '', description: ' ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          { name: '', description: '  ' },\r\n          { name: '', description: ' ' },\r\n          { name: '', description: ' ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    id: 'simple3',\r\n    name: ' 3',\r\n    description: '3  ( )',\r\n    icon: '',\r\n    structure: [\r\n      { name: '', description: '  ' },\r\n      { name: '', description: '  ' },\r\n      { name: '', description: '  ' }\r\n    ]\r\n  },\r\n  {\r\n    id: 'complex',\r\n    name: ' ',\r\n    description: '  (3)',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          {\r\n            name: ' ',\r\n            description: '  ',\r\n            children: [\r\n              { name: ' ', description: '  ' },\r\n              { name: ' ', description: '  ' }\r\n            ]\r\n          },\r\n          {\r\n            name: ' ',\r\n            description: ' ',\r\n            children: [\r\n              { name: '', description: '  ' },\r\n              { name: ' ', description: ' ' }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          {\r\n            name: '',\r\n            description: '  ',\r\n            children: [\r\n              { name: '', description: '  ' },\r\n              { name: '', description: '  ' }\r\n            ]\r\n          },\r\n          {\r\n            name: ' ',\r\n            description: '  ',\r\n            children: [\r\n              { name: ' ', description: '  ' },\r\n              { name: ' ', description: '  ' }\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    id: 'it_project',\r\n    name: 'IT  ',\r\n    description: 'SW/   (33 )',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          { name: '', description: '  ' },\r\n          { name: '', description: '  ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' ',\r\n        description: ' ',\r\n        children: [\r\n          { name: 'ROI', description: '  ' },\r\n          { name: ' ', description: '  ' },\r\n          { name: ' ', description: 'UX/UI ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' ',\r\n        description: ' ',\r\n        children: [\r\n          { name: '', description: '  ' },\r\n          { name: ' ', description: '  ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n];\r\n\r\ninterface CriteriaTemplatesProps {\r\n  onSelectTemplate: (template: CriteriaTemplate) => void;\r\n  onClose: () => void;\r\n}\r\n\r\nconst CriteriaTemplates: React.FC<CriteriaTemplatesProps> = ({ \r\n  onSelectTemplate, \r\n  onClose \r\n}) => {\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\r\n        <div className=\"p-6 border-b\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-2xl font-bold text-gray-900\">\r\n                \r\n            </h2>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-500 hover:text-gray-700\"\r\n            >\r\n              \r\n            </button>\r\n          </div>\r\n          <p className=\"text-gray-600 mt-2\">\r\n                .    .\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-120px)]\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            {CRITERIA_TEMPLATES.map(template => (\r\n              <div\r\n                key={template.id}\r\n                className=\"border rounded-lg p-4 hover:border-blue-500 hover:shadow-md transition-all cursor-pointer\"\r\n                onClick={() => onSelectTemplate(template)}\r\n              >\r\n                <div className=\"flex items-start space-x-3\">\r\n                  <div className=\"text-3xl\">{template.icon}</div>\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"font-semibold text-gray-900\">\r\n                      {template.name}\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-600 mb-2\">\r\n                      {template.description}\r\n                    </p>\r\n                    \r\n                    {/*   */}\r\n                    <div className=\"bg-gray-50 rounded p-2 text-xs space-y-1\">\r\n                      {template.structure.slice(0, 3).map((item, idx) => (\r\n                        <div key={idx} className=\"text-gray-700\">\r\n                          <span className=\"font-medium\"> {item.name}</span>\r\n                          {item.children && (\r\n                            <span className=\"text-gray-500 ml-2\">\r\n                              ({item.children.length} )\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                      {template.structure.length > 3 && (\r\n                        <div className=\"text-gray-500\">\r\n                          ...  {template.structure.length - 3}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-4 border-t bg-gray-50\">\r\n          <div className=\"flex justify-end\">\r\n            <Button variant=\"secondary\" onClick={onClose}>\r\n              \r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CriteriaTemplates;","import React, { useState } from 'react';\r\nimport Button from '../common/Button';\r\nimport Modal from '../common/Modal';\r\n\r\nexport interface CriteriaNode {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  parent_id: string | null;\r\n  children: CriteriaNode[];\r\n  isEditing?: boolean;\r\n  isExpanded?: boolean;\r\n}\r\n\r\ninterface FlatCriteriaItem {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  parent_id: string | null;\r\n  order: number;\r\n}\r\n\r\ninterface VisualCriteriaBuilderProps {\r\n  initialCriteria?: CriteriaNode[];\r\n  onSave: (criteria: CriteriaNode[]) => void;\r\n  onClose?: () => void;\r\n  isInline?: boolean; //   \r\n}\r\n\r\nconst VisualCriteriaBuilder: React.FC<VisualCriteriaBuilderProps> = ({\r\n  initialCriteria = [],\r\n  onSave,\r\n  onClose,\r\n  isInline = true //   \r\n}) => {\r\n  const [criteria, setCriteria] = useState<CriteriaNode[]>(() => {\r\n    if (initialCriteria.length > 0) {\r\n      return initialCriteria.map(c => ({ ...c, isExpanded: true }));\r\n    }\r\n    //    \r\n    return [{\r\n      id: `temp_${Date.now()}`,\r\n      name: ' ',\r\n      description: '  ',\r\n      level: 1,\r\n      parent_id: null,\r\n      children: [],\r\n      isExpanded: true\r\n    }];\r\n  });\r\n\r\n  const [selectedNodeId, setSelectedNodeId] = useState<string | null>(null);\r\n  const [draggedNodeId, setDraggedNodeId] = useState<string | null>(null);\r\n  const [pendingDeleteId, setPendingDeleteId] = useState<string | null>(null);\r\n\r\n  //  \r\n  const findNode = (nodes: CriteriaNode[], id: string): CriteriaNode | null => {\r\n    for (const node of nodes) {\r\n      if (node.id === id) return node;\r\n      const found = findNode(node.children, id);\r\n      if (found) return found;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  //  \r\n  const updateNode = (nodes: CriteriaNode[], id: string, updates: Partial<CriteriaNode>): CriteriaNode[] => {\r\n    return nodes.map(node => {\r\n      if (node.id === id) {\r\n        return { ...node, ...updates };\r\n      }\r\n      return {\r\n        ...node,\r\n        children: updateNode(node.children, id, updates)\r\n      };\r\n    });\r\n  };\r\n\r\n  //  \r\n  const addNode = (parentId: string | null) => {\r\n    const newNode: CriteriaNode = {\r\n      id: `temp_${Date.now()}_${Math.floor(Math.random() * 1000)}`,\r\n      name: ' ',\r\n      description: '',\r\n      level: parentId ? (findNode(criteria, parentId)?.level || 0) + 1 : 1,\r\n      parent_id: parentId,\r\n      children: [],\r\n      isEditing: true,\r\n      isExpanded: true\r\n    };\r\n\r\n    if (parentId) {\r\n      //    \r\n      setCriteria(prev => {\r\n        const addChildToParent = (nodes: CriteriaNode[]): CriteriaNode[] => {\r\n          return nodes.map(node => {\r\n            if (node.id === parentId) {\r\n              return {\r\n                ...node,\r\n                children: [...node.children, newNode],\r\n                isExpanded: true\r\n              };\r\n            }\r\n            return {\r\n              ...node,\r\n              children: addChildToParent(node.children)\r\n            };\r\n          });\r\n        };\r\n        return addChildToParent(prev);\r\n      });\r\n    } else {\r\n      //   \r\n      setCriteria(prev => [...prev, newNode]);\r\n    }\r\n    \r\n    setSelectedNodeId(newNode.id);\r\n  };\r\n\r\n  //  \r\n  const deleteNode = (id: string) => {\r\n    setPendingDeleteId(id);\r\n  };\r\n\r\n  const confirmDeleteNode = () => {\r\n    if (!pendingDeleteId) return;\r\n\r\n    const id = pendingDeleteId;\r\n    const removeNode = (nodes: CriteriaNode[]): CriteriaNode[] => {\r\n      return nodes.filter(node => {\r\n        if (node.id === id) return false;\r\n        node.children = removeNode(node.children);\r\n        return true;\r\n      });\r\n    };\r\n\r\n    setCriteria(prev => removeNode(prev));\r\n    setSelectedNodeId(null);\r\n    setPendingDeleteId(null);\r\n  };\r\n\r\n  //    \r\n  const toggleEditMode = (id: string) => {\r\n    setCriteria(prev => updateNode(prev, id, { isEditing: !findNode(prev, id)?.isEditing }));\r\n  };\r\n\r\n  //  / \r\n  const toggleExpanded = (id: string) => {\r\n    setCriteria(prev => updateNode(prev, id, { isExpanded: !findNode(prev, id)?.isExpanded }));\r\n  };\r\n\r\n  //   \r\n  const updateNodeName = (id: string, name: string) => {\r\n    setCriteria(prev => updateNode(prev, id, { name }));\r\n  };\r\n\r\n  //   \r\n  const updateNodeDescription = (id: string, description: string) => {\r\n    setCriteria(prev => updateNode(prev, id, { description }));\r\n  };\r\n\r\n  //    \r\n  const handleDragStart = (e: React.DragEvent, nodeId: string) => {\r\n    setDraggedNodeId(nodeId);\r\n    e.dataTransfer.effectAllowed = 'move';\r\n  };\r\n\r\n  const handleDragOver = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = 'move';\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent, targetId: string) => {\r\n    e.preventDefault();\r\n    if (!draggedNodeId || draggedNodeId === targetId) return;\r\n\r\n    setCriteria(prev => {\r\n      const draggedNode = findNode(prev, draggedNodeId);\r\n      if (!draggedNode) return prev;\r\n\r\n      // Prevent dropping onto own descendant (would create circular reference)\r\n      const isDescendantOf = (ancestorId: string, searchId: string): boolean => {\r\n        const ancestor = findNode(prev, ancestorId);\r\n        if (!ancestor) return false;\r\n        const check = (children: CriteriaNode[]): boolean =>\r\n          children.some(c => c.id === searchId || check(c.children));\r\n        return check(ancestor.children);\r\n      };\r\n      if (isDescendantOf(draggedNodeId, targetId)) return prev;\r\n\r\n      // Remove dragged node from its current position\r\n      const removeNode = (nodes: CriteriaNode[]): CriteriaNode[] =>\r\n        nodes\r\n          .filter(n => n.id !== draggedNodeId)\r\n          .map(n => ({ ...n, children: removeNode(n.children) }));\r\n\r\n      // Recursively fix levels and parent references after move\r\n      const fixLevels = (node: CriteriaNode, parentLevel: number, newParentId: string | null): CriteriaNode => ({\r\n        ...node,\r\n        level: parentLevel + 1,\r\n        parent_id: newParentId,\r\n        children: node.children.map(c => fixLevels(c, parentLevel + 1, node.id))\r\n      });\r\n\r\n      // Insert dragged node as a child of the target\r\n      const insertAtTarget = (nodes: CriteriaNode[]): CriteriaNode[] =>\r\n        nodes.map(n => {\r\n          if (n.id === targetId) {\r\n            const movedNode = fixLevels(draggedNode, n.level, targetId);\r\n            return { ...n, children: [...n.children, movedNode], isExpanded: true };\r\n          }\r\n          return { ...n, children: insertAtTarget(n.children) };\r\n        });\r\n\r\n      return insertAtTarget(removeNode(prev));\r\n    });\r\n\r\n    setDraggedNodeId(null);\r\n  };\r\n\r\n  //  \r\n  const renderNode = (node: CriteriaNode, depth: number = 0) => {\r\n    const hasChildren = node.children && node.children.length > 0;\r\n    const isSelected = selectedNodeId === node.id;\r\n\r\n    return (\r\n      <div key={node.id} className=\"mb-2\">\r\n        <div\r\n          className={`\r\n            flex items-center p-2 rounded-lg border transition-all\r\n            ${isSelected ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'}\r\n            ${depth > 0 ? 'ml-8' : ''}\r\n          `}\r\n          onClick={() => setSelectedNodeId(node.id)}\r\n          draggable\r\n          onDragStart={(e) => handleDragStart(e, node.id)}\r\n          onDragOver={handleDragOver}\r\n          onDrop={(e) => handleDrop(e, node.id)}\r\n        >\r\n          {/* /  */}\r\n          {hasChildren && (\r\n            <button\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                toggleExpanded(node.id);\r\n              }}\r\n              className=\"mr-2 text-gray-500 hover:text-gray-700\"\r\n            >\r\n              {node.isExpanded ? '' : ''}\r\n            </button>\r\n          )}\r\n\r\n          {/*   */}\r\n          <div className={`\r\n            w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold mr-2\r\n            ${depth === 0 ? 'bg-purple-500 text-white' : \r\n              depth === 1 ? 'bg-blue-500 text-white' : \r\n              depth === 2 ? 'bg-green-500 text-white' : \r\n              'bg-gray-500 text-white'}\r\n          `}>\r\n            {node.level}\r\n          </div>\r\n\r\n          {/*   */}\r\n          <div className=\"flex-1\">\r\n            {node.isEditing ? (\r\n              <div className=\"space-y-2\" onClick={(e) => e.stopPropagation()}>\r\n                <input\r\n                  value={node.name}\r\n                  onChange={(e) => updateNodeName(node.id, e.target.value)}\r\n                  placeholder=\" \"\r\n                  className=\"w-full px-2 py-1 text-sm border rounded focus:outline-none focus:border-blue-500\"\r\n                  autoFocus\r\n                />\r\n                <input\r\n                  value={node.description || ''}\r\n                  onChange={(e) => updateNodeDescription(node.id, e.target.value)}\r\n                  placeholder=\" ()\"\r\n                  className=\"w-full px-2 py-1 text-xs border rounded focus:outline-none focus:border-blue-500\"\r\n                />\r\n                <div className=\"flex space-x-2\">\r\n                  <button\r\n                    className=\"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n                    onClick={() => toggleEditMode(node.id)}\r\n                  >\r\n                    \r\n                  </button>\r\n                  <button\r\n                    className=\"px-3 py-1 text-xs bg-gray-200 text-gray-700 rounded hover:bg-gray-300\"\r\n                    onClick={() => {\r\n                      toggleEditMode(node.id);\r\n                      //   \r\n                    }}\r\n                  >\r\n                    \r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div \r\n                className=\"cursor-pointer\"\r\n                onDoubleClick={() => toggleEditMode(node.id)}\r\n              >\r\n                <div className=\"font-medium text-gray-900\">{node.name}</div>\r\n                {node.description && (\r\n                  <div className=\"text-xs text-gray-500\">{node.description}</div>\r\n                )}\r\n                <div className=\"text-xs text-blue-500 mt-1\"> </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/*   */}\r\n          {!node.isEditing && (\r\n            <div className=\"flex items-center space-x-1 ml-2\">\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  addNode(node.id);\r\n                }}\r\n                className=\"p-1 text-green-600 hover:bg-green-100 rounded\"\r\n                title=\"  \"\r\n              >\r\n                \r\n              </button>\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  toggleEditMode(node.id);\r\n                }}\r\n                className=\"p-1 text-blue-600 hover:bg-blue-100 rounded\"\r\n                title=\"\"\r\n              >\r\n                \r\n              </button>\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  deleteNode(node.id);\r\n                }}\r\n                className=\"p-1 text-red-600 hover:bg-red-100 rounded\"\r\n                title=\"\"\r\n              >\r\n                \r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/*   */}\r\n        {node.isExpanded && hasChildren && (\r\n          <div className=\"mt-1\">\r\n            {node.children.map(child => renderNode(child, depth + 1))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  //    ()\r\n  const flattenCriteria = (nodes: CriteriaNode[], parentId: string | null = null): FlatCriteriaItem[] => {\r\n    const result: FlatCriteriaItem[] = [];\r\n    nodes.forEach((node, index) => {\r\n      result.push({\r\n        id: node.id,\r\n        name: node.name,\r\n        description: node.description,\r\n        level: node.level,\r\n        parent_id: parentId,\r\n        order: index + 1\r\n      });\r\n      if (node.children && node.children.length > 0) {\r\n        result.push(...flattenCriteria(node.children, node.id));\r\n      }\r\n    });\r\n    return result;\r\n  };\r\n\r\n  //  \r\n  const getStats = () => {\r\n    const flatten = flattenCriteria(criteria);\r\n    const levels = flatten.reduce((acc, c) => {\r\n      acc[c.level] = (acc[c.level] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<number, number>);\r\n    \r\n    return {\r\n      total: flatten.length,\r\n      levels\r\n    };\r\n  };\r\n\r\n  const stats = getStats();\r\n\r\n  //    \r\n  if (isInline) {\r\n    return (\r\n      <div className=\"w-full\">\r\n        {/*  */}\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h3 className=\"text-lg font-bold text-gray-900\">  </h3>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n                  ,  \r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center space-x-4\">\r\n            <div className=\"text-sm text-gray-600\">\r\n               : <span className=\"font-semibold\">{stats.total}</span>\r\n            </div>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => addNode(null)}\r\n            >\r\n                 \r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/*    */}\r\n        <div className=\"border border-gray-200 rounded-lg p-4 bg-white max-h-[500px] overflow-y-auto\">\r\n          <div className=\"space-y-2\">\r\n            {criteria.map(node => renderNode(node))}\r\n          </div>\r\n\r\n          {criteria.length === 0 && (\r\n            <div className=\"text-center py-12 text-gray-500\">\r\n                    \r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/*   */}\r\n        <div className=\"flex justify-end mt-4 space-x-2\">\r\n          {onClose && (\r\n            <Button variant=\"secondary\" onClick={onClose}>\r\n              \r\n            </Button>\r\n          )}\r\n          <Button \r\n            variant=\"primary\" \r\n            onClick={() => onSave(criteria)}\r\n            disabled={stats.total === 0}\r\n          >\r\n            \r\n          </Button>\r\n        </div>\r\n\r\n        {/*  */}\r\n        <div className=\"mt-4 p-3 bg-gray-50 rounded-lg text-xs text-gray-600\">\r\n          <strong>  :</strong>\r\n              |     |   ( ) |\r\n             | / /\r\n        </div>\r\n\r\n        {/*    */}\r\n        <Modal\r\n          isOpen={pendingDeleteId !== null}\r\n          onClose={() => setPendingDeleteId(null)}\r\n          title=\" \"\r\n          size=\"sm\"\r\n          footer={\r\n            <div className=\"flex justify-end space-x-2\">\r\n              <Button size=\"sm\" variant=\"secondary\" onClick={() => setPendingDeleteId(null)}>\r\n                \r\n              </Button>\r\n              <Button size=\"sm\" variant=\"primary\" onClick={confirmDeleteNode}>\r\n                \r\n              </Button>\r\n            </div>\r\n          }\r\n        >\r\n          <p className=\"text-sm text-gray-700\">     . ?</p>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  //     ( )\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[90vh] flex flex-col\">\r\n        {/*  */}\r\n        <div className=\"p-4 border-b\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h2 className=\"text-2xl font-bold text-gray-900\">\r\n                  \r\n              </h2>\r\n              <p className=\"text-sm text-gray-600 mt-1\">\r\n                    ,  \r\n              </p>\r\n            </div>\r\n            {onClose && (\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-500 hover:text-gray-700 text-xl\"\r\n              >\r\n                \r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  */}\r\n        <div className=\"flex-1 flex overflow-hidden\">\r\n          {/* :    */}\r\n          <div className=\"flex-1 p-4 overflow-y-auto\">\r\n            <div className=\"mb-4\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => addNode(null)}\r\n                className=\"w-full\"\r\n              >\r\n                   \r\n              </Button>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              {criteria.map(node => renderNode(node))}\r\n            </div>\r\n\r\n            {criteria.length === 0 && (\r\n              <div className=\"text-center py-12 text-gray-500\">\r\n                      \r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* :    */}\r\n          <div className=\"w-80 border-l bg-gray-50 p-4 overflow-y-auto\">\r\n            <h3 className=\"font-semibold text-gray-900 mb-4\"> </h3>\r\n            \r\n            <div className=\"bg-white rounded-lg p-4 mb-4\">\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\"> </span>\r\n                  <span className=\"font-semibold\">{stats.total}</span>\r\n                </div>\r\n                {Object.entries(stats.levels).map(([level, count]) => (\r\n                  <div key={level} className=\"flex justify-between text-sm\">\r\n                    <span className=\"text-gray-500\"> {level}</span>\r\n                    <span>{String(count)}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <h4 className=\"font-medium text-gray-700 mb-2\"> </h4>\r\n            <div className=\"bg-white rounded-lg p-3 text-sm\">\r\n              {flattenCriteria(criteria).map((item, idx) => (\r\n                <div \r\n                  key={idx} \r\n                  className=\"py-1\"\r\n                  style={{ paddingLeft: `${(item.level - 1) * 16}px` }}\r\n                >\r\n                  <span className=\"text-gray-700\">\r\n                    {item.level > 1 && ' '}\r\n                    {item.name}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"mt-4 text-xs text-gray-500\">\r\n              <h5 className=\"font-medium mb-1\"></h5>\r\n              <ul className=\"space-y-1\">\r\n                <li>     </li>\r\n                <li>     </li>\r\n                <li>    ( )</li>\r\n                <li>     </li>\r\n                <li> /  /</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/*  */}\r\n        <div className=\"p-4 border-t bg-gray-50\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <div className=\"text-sm text-gray-600\">\r\n              {stats.total}  \r\n            </div>\r\n            <div className=\"flex space-x-2\">\r\n              {onClose && (\r\n                <Button variant=\"secondary\" onClick={onClose}>\r\n                  \r\n                </Button>\r\n              )}\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={() => onSave(criteria)}\r\n                disabled={stats.total === 0}\r\n              >\r\n                \r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/*    */}\r\n      <Modal\r\n        isOpen={pendingDeleteId !== null}\r\n        onClose={() => setPendingDeleteId(null)}\r\n        title=\" \"\r\n        size=\"sm\"\r\n        footer={\r\n          <div className=\"flex justify-end space-x-2\">\r\n            <Button size=\"sm\" variant=\"secondary\" onClick={() => setPendingDeleteId(null)}>\r\n              \r\n            </Button>\r\n            <Button size=\"sm\" variant=\"primary\" onClick={confirmDeleteNode}>\r\n              \r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <p className=\"text-sm text-gray-700\">     . ?</p>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VisualCriteriaBuilder;","import React, { useState, useEffect, useCallback } from 'react';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport Modal from '../common/Modal';\r\nimport HierarchyTreeVisualization from '../common/HierarchyTreeVisualization';\r\nimport BulkCriteriaInput from '../criteria/BulkCriteriaInput';\r\nimport CriteriaTemplates, { CriteriaTemplate } from '../criteria/CriteriaTemplates';\r\nimport VisualCriteriaBuilder, { CriteriaNode as VisualCriteriaNode } from '../criteria/VisualCriteriaBuilder';\r\nimport cleanDataService from '../../services/dataService_clean';\r\nimport { generateUUID, isTempId } from '../../utils/uuid';\r\n\r\ninterface TemplateItem {\r\n  name: string;\r\n  description?: string;\r\n  children?: TemplateItem[];\r\n}\r\n\r\ninterface Criterion {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  parent_id?: string | null;\r\n  level: number;\r\n  order?: number;\r\n  children?: Criterion[];\r\n  weight?: number;\r\n  type?: 'criteria';\r\n}\r\n\r\ninterface CriteriaManagementProps {\r\n  projectId: string;\r\n  projectTitle?: string;\r\n  onCriteriaChange: (count: number) => void;\r\n  onComplete?: () => void;\r\n}\r\n\r\nconst CriteriaManagement: React.FC<CriteriaManagementProps> = ({ \r\n  projectId, \r\n  onCriteriaChange, \r\n  onComplete \r\n}) => {\r\n  //     ( )\r\n  const [criteria, setCriteria] = useState<Criterion[]>([]);\r\n  //   \r\n  const [savedCriteria, setSavedCriteria] = useState<Criterion[]>([]);\r\n  //    (/   )\r\n  const [tempCriteria, setTempCriteria] = useState<Criterion[]>([]);\r\n  //    \r\n  const [hasTempChanges, setHasTempChanges] = useState(false);\r\n  \r\n  //    \r\n  const isTemplateName = (name: string): boolean => {\r\n    return /^(||)\\s*\\d+(-\\d+)*$/.test(name);\r\n  };\r\n  \r\n  const isTemplateDescription = (description?: string): boolean => {\r\n    if (!description) return false;\r\n    return description === '   ' || \r\n           description === '  ' || \r\n           description.includes('  ') || \r\n           description === ' ';\r\n  };\r\n\r\n  // UI \r\n  const [actionMessage, setActionMessage] = useState<{type:'success'|'error'|'info', text:string}|null>(null);\r\n  const [pendingAction, setPendingAction] = useState<{type: 'reset' | 'deleteCriterion', criterionId?: string} | null>(null);\r\n\r\n  const showActionMessage = (type: 'success'|'error'|'info', text: string) => {\r\n    setActionMessage({type, text});\r\n    setTimeout(() => setActionMessage(null), 3000);\r\n  };\r\n\r\n  const [showTemplates, setShowTemplates] = useState(false);\r\n  const [showBulkInput, setShowBulkInput] = useState(false);\r\n  const [activeInputMode, setActiveInputMode] = useState<'template' | 'bulk' | 'visual' | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [layoutMode, setLayoutMode] = useState<'vertical' | 'horizontal'>('vertical');\r\n  const [editMode, setEditMode] = useState(false);\r\n  \r\n  //   \r\n  const [editingCriteria, setEditingCriteria] = useState<{[key: string]: {name: string, description: string}}>({});\r\n\r\n  //   \r\n  const loadCriteria = useCallback(async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const loadedCriteria = await cleanDataService.getCriteria(projectId);\r\n      \r\n      // parent_id, parent, level, order  \r\n      const normalizedCriteria = (loadedCriteria || []).map((c, index) => {\r\n        //  parent  parent_id   \r\n        // ID     \r\n        const parentId = c.parent || c.parent_id || null;\r\n\r\n        return {\r\n          id: String(c.id || generateUUID()), // ID  \r\n          name: c.name,\r\n          description: c.description,\r\n          parent_id: parentId ? String(parentId) : null, // parent_id  \r\n          level: c.level || 1,\r\n          order: c.order || c.position || index + 1,\r\n          weight: c.weight || 1,\r\n          type: 'criteria' as const,\r\n          children: []\r\n        };\r\n      });\r\n      \r\n      //   \r\n      const hierarchicalCriteria = buildHierarchy(normalizedCriteria);\r\n\r\n      setCriteria(hierarchicalCriteria);\r\n      setSavedCriteria(hierarchicalCriteria);\r\n      setTempCriteria([]);\r\n      setHasTempChanges(false);\r\n    } catch (error) {\r\n      showActionMessage('error', '    .');\r\n      setCriteria([]);\r\n      setSavedCriteria([]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [projectId]);\r\n\r\n  //   \r\n  const buildHierarchy = (flatCriteria: Criterion[]): Criterion[] => {\r\n    const criteriaMap = new Map<string, Criterion>();\r\n    const rootCriteria: Criterion[] = [];\r\n\r\n    //     - ID  \r\n    flatCriteria.forEach(criterion => {\r\n      const idString = String(criterion.id);\r\n      criteriaMap.set(idString, { ...criterion, id: idString, children: [] });\r\n    });\r\n\r\n    //   \r\n    flatCriteria.forEach(criterion => {\r\n      const idString = String(criterion.id);\r\n      const criterionObj = criteriaMap.get(idString);\r\n      if (!criterionObj) return;\r\n\r\n      // parent_id  \r\n      const parentIdString = criterion.parent_id ? String(criterion.parent_id) : null;\r\n\r\n      // parent_id      \r\n      if (parentIdString && criteriaMap.has(parentIdString)) {\r\n        const parent = criteriaMap.get(parentIdString);\r\n        if (parent) {\r\n          parent.children = parent.children || [];\r\n          parent.children.push(criterionObj);\r\n          \r\n          //  level  level + 1  \r\n          const parentLevel = parent.level || 1;\r\n          criterionObj.level = parentLevel + 1;\r\n          \r\n        }\r\n      } else {\r\n        // parent_id        \r\n\r\n        //    rootCriteria \r\n        criterionObj.level = 1;\r\n        criterionObj.parent_id = null; //  parent_id  null \r\n        rootCriteria.push(criterionObj);\r\n      }\r\n    });\r\n\r\n    //   order \r\n    const sortByOrder = (items: Criterion[]) => {\r\n      items.sort((a, b) => (a.order || 0) - (b.order || 0));\r\n      items.forEach(item => {\r\n        if (item.children && item.children.length > 0) {\r\n          sortByOrder(item.children);\r\n        }\r\n      });\r\n    };\r\n    \r\n    sortByOrder(rootCriteria);\r\n\r\n    return rootCriteria;\r\n  };\r\n\r\n  //   \r\n  const flattenCriteria = (hierarchicalCriteria: Criterion[]): Criterion[] => {\r\n    const result: Criterion[] = [];\r\n    \r\n    const traverse = (items: Criterion[], parentId: string | null = null, level: number = 1) => {\r\n      items.forEach((item, index) => {\r\n        result.push({\r\n          ...item,\r\n          parent_id: parentId,\r\n          level: level,\r\n          order: index + 1,\r\n          children: undefined // children  \r\n        });\r\n        \r\n        if (item.children && item.children.length > 0) {\r\n          traverse(item.children, item.id, level + 1);\r\n        }\r\n      });\r\n    };\r\n    \r\n    traverse(hierarchicalCriteria);\r\n    return result;\r\n  };\r\n\r\n  //     \r\n  useEffect(() => {\r\n    if (projectId) {\r\n      loadCriteria();\r\n    }\r\n  }, [projectId, loadCriteria]);\r\n\r\n  //       \r\n  useEffect(() => {\r\n    const count = flattenCriteria(savedCriteria).length;\r\n    onCriteriaChange(count);\r\n  }, [savedCriteria, onCriteriaChange]);\r\n\r\n  //  - trigger\r\n  const handleReset = () => {\r\n    setPendingAction({ type: 'reset' });\r\n  };\r\n\r\n  //  - confirm\r\n  const confirmReset = async () => {\r\n    setPendingAction(null);\r\n    try {\r\n      setIsLoading(true);\r\n      const existingCriteria = await cleanDataService.getCriteria(projectId);\r\n      for (const criterion of existingCriteria) {\r\n        if (criterion.id) {\r\n          await cleanDataService.deleteCriteria(projectId, criterion.id);\r\n        }\r\n      }\r\n      setCriteria([]);\r\n      setSavedCriteria([]);\r\n      setTempCriteria([]);\r\n      setHasTempChanges(false);\r\n      showActionMessage('success', '  .');\r\n    } catch (error) {\r\n      showActionMessage('error', '    .');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  //  \r\n  const handleSaveCriteria = async () => {\r\n    //      ,    \r\n    const criteriaToSave = hasTempChanges ? tempCriteria : criteria;\r\n    const flatCriteria = flattenCriteria(criteriaToSave);\r\n    \r\n    if (flatCriteria.length === 0) {\r\n      showActionMessage('error', '  .');\r\n      return;\r\n    }\r\n\r\n    setIsSaving(true);\r\n    try {\r\n      //     (   )\r\n      const existingCriteria = await cleanDataService.getCriteria(projectId);\r\n      for (const criterion of existingCriteria) {\r\n        if (criterion.id) {\r\n          await cleanDataService.deleteCriteria(projectId, criterion.id);\r\n        }\r\n      }\r\n      \r\n      //   \r\n      let success = true;\r\n      const createdCriteriaMap = new Map<string, { id: string; level: number; name: string }>(); //  ID ->   \r\n      \r\n      //     (  ,    order )\r\n      const sortedCriteria = flatCriteria.sort((a, b) => {\r\n        if (a.level !== b.level) {\r\n          return a.level - b.level; //  \r\n        }\r\n        return (a.order || 0) - (b.order || 0); //    \r\n      });\r\n      \r\n      for (const criterion of sortedCriteria) {\r\n        //  ID  -  ID   ID \r\n        let parentId = null;\r\n        let resolvedLevel = criterion.level || 1;\r\n        \r\n        if (criterion.parent_id) {\r\n          if (createdCriteriaMap.has(criterion.parent_id)) {\r\n            //      ID \r\n            const parentCriteria = createdCriteriaMap.get(criterion.parent_id);\r\n\r\n            parentId = parentCriteria?.id;\r\n\r\n            //   + 1   \r\n            if (parentCriteria?.level !== undefined) {\r\n              resolvedLevel = parentCriteria.level + 1;\r\n            }\r\n          } else if (!isTempId(criterion.parent_id)) {\r\n            //  UUID    (  )\r\n            parentId = criterion.parent_id;\r\n          } else {\r\n            //  ID    -   \r\n            parentId = null;\r\n            resolvedLevel = 1; //   \r\n          }\r\n        }\r\n        \r\n        const criteriaData = {\r\n          project_id: projectId,\r\n          project: projectId,\r\n          name: criterion.name,\r\n          description: criterion.description || '',\r\n          level: resolvedLevel,\r\n          order: criterion.order || 0,\r\n          position: criterion.order || 0,\r\n          weight: criterion.weight || 1,\r\n          type: 'criteria' as const,\r\n          parent: parentId,\r\n          parent_id: parentId,\r\n          is_active: true\r\n        };\r\n        \r\n        const result = await cleanDataService.createCriteria(criteriaData);\r\n        if (!result) {\r\n          success = false;\r\n          break;\r\n        }\r\n        \r\n        //     (    )\r\n        //    \r\n        //   ID      \r\n        const mappedCriteria = {\r\n          id: result?.id ?? criterion.id, //  id  (fallback to original id)\r\n          level: resolvedLevel,\r\n          name: result?.name || criterion.name\r\n        };\r\n\r\n        createdCriteriaMap.set(criterion.id, mappedCriteria);\r\n      }\r\n\r\n      if (success) {\r\n        //     \r\n        await loadCriteria();\r\n        \r\n        showActionMessage('success', '  .');\r\n      } else {\r\n        throw new Error('   ');\r\n      }\r\n    } catch (error) {\r\n      showActionMessage('error', `    : ${error}`);\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  //   \r\n  const startEditing = (criterionId: string, name: string, description: string) => {\r\n    setEditingCriteria({\r\n      ...editingCriteria,\r\n      [criterionId]: { \r\n        name: isTemplateName(name) ? '' : name, \r\n        description: isTemplateDescription(description) ? '' : description \r\n      }\r\n    });\r\n  };\r\n\r\n  //    ( )\r\n  const saveInlineEdit = async (criterionId: string) => {\r\n    if (!editingCriteria[criterionId]) return;\r\n\r\n    const updateCriteria = (criteria: Criterion[]): Criterion[] => {\r\n      return criteria.map(criterion => {\r\n        if (criterion.id === criterionId) {\r\n          return {\r\n            ...criterion,\r\n            name: editingCriteria[criterionId].name,\r\n            description: editingCriteria[criterionId].description\r\n          };\r\n        }\r\n        if (criterion.children) {\r\n          return {\r\n            ...criterion,\r\n            children: updateCriteria(criterion.children)\r\n          };\r\n        }\r\n        return criterion;\r\n      });\r\n    };\r\n\r\n    const updatedCriteria = updateCriteria(hasTempChanges ? tempCriteria : criteria);\r\n    \r\n    //  UI \r\n    if (hasTempChanges) {\r\n      setTempCriteria(updatedCriteria);\r\n    } else {\r\n      setCriteria(updatedCriteria);\r\n      setTempCriteria(updatedCriteria);\r\n      setHasTempChanges(true);\r\n    }\r\n\r\n    //   \r\n    const newEditingCriteria = { ...editingCriteria };\r\n    delete newEditingCriteria[criterionId];\r\n    setEditingCriteria(newEditingCriteria);\r\n\r\n    //   \r\n    try {\r\n      await handleSaveCriteria();\r\n    } catch (error) {\r\n      showActionMessage('error', '  .  .');\r\n    }\r\n  };\r\n\r\n  //   \r\n  const cancelInlineEdit = (criterionId: string) => {\r\n    const newEditingCriteria = { ...editingCriteria };\r\n    delete newEditingCriteria[criterionId];\r\n    setEditingCriteria(newEditingCriteria);\r\n  };\r\n\r\n  //   \r\n  const moveCriterion = (criterionId: string, direction: 'up' | 'down') => {\r\n    const moveCriteriaInList = (criteria: Criterion[]): Criterion[] => {\r\n      const newCriteria = [...criteria];\r\n      const index = newCriteria.findIndex(c => c.id === criterionId);\r\n      \r\n      if (index === -1) {\r\n        //   \r\n        return newCriteria.map(criterion => ({\r\n          ...criterion,\r\n          children: criterion.children ? moveCriteriaInList(criterion.children) : undefined\r\n        }));\r\n      }\r\n      \r\n      const targetIndex = direction === 'up' ? index - 1 : index + 1;\r\n      \r\n      if (targetIndex >= 0 && targetIndex < newCriteria.length) {\r\n        //  \r\n        [newCriteria[index], newCriteria[targetIndex]] = [newCriteria[targetIndex], newCriteria[index]];\r\n        \r\n        // order  \r\n        newCriteria.forEach((criterion, idx) => {\r\n          criterion.order = idx;\r\n        });\r\n      }\r\n      \r\n      return newCriteria;\r\n    };\r\n\r\n    const updatedCriteria = moveCriteriaInList(hasTempChanges ? tempCriteria : criteria);\r\n    \r\n    if (hasTempChanges) {\r\n      setTempCriteria(updatedCriteria);\r\n    } else {\r\n      setCriteria(updatedCriteria);\r\n      setTempCriteria(updatedCriteria);\r\n      setHasTempChanges(true);\r\n    }\r\n  };\r\n\r\n  //   - trigger\r\n  const deleteCriterion = (criterionId: string) => {\r\n    setPendingAction({ type: 'deleteCriterion', criterionId });\r\n  };\r\n\r\n  //   - confirm\r\n  const confirmDeleteCriterion = () => {\r\n    if (!pendingAction?.criterionId) return;\r\n    const criterionId = pendingAction.criterionId;\r\n    setPendingAction(null);\r\n\r\n    const deleteCriteriaFromList = (criteria: Criterion[]): Criterion[] => {\r\n      return criteria\r\n        .filter(c => c.id !== criterionId)\r\n        .map(criterion => ({\r\n          ...criterion,\r\n          children: criterion.children ? deleteCriteriaFromList(criterion.children) : undefined\r\n        }));\r\n    };\r\n\r\n    const updatedCriteria = deleteCriteriaFromList(hasTempChanges ? tempCriteria : criteria);\r\n    \r\n    if (hasTempChanges) {\r\n      setTempCriteria(updatedCriteria);\r\n    } else {\r\n      setCriteria(updatedCriteria);\r\n      setTempCriteria(updatedCriteria);\r\n      setHasTempChanges(true);\r\n    }\r\n  };\r\n\r\n  //     \r\n  const renderEditableCriteriaList = (criteriaList: Criterion[]) => {\r\n    const flatCriteria = getAllCriteria(criteriaList);\r\n\r\n    return (\r\n      <div className=\"space-y-3\">\r\n        {flatCriteria.map((criterion) => {\r\n          const isEditing = editingCriteria[criterion.id];\r\n          const indent = (criterion.level - 1) * 24;\r\n          \r\n          return (\r\n            <div \r\n              key={criterion.id}\r\n              className=\"bg-white border border-gray-200 rounded-lg p-4 shadow-sm\"\r\n              style={{ marginLeft: `${indent}px` }}\r\n            >\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex-1 mr-4\">\r\n                  {isEditing ? (\r\n                    <div className=\"space-y-2\">\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingCriteria[criterion.id]?.name || ''}\r\n                        onChange={(e) => {\r\n                          setEditingCriteria({\r\n                            ...editingCriteria,\r\n                            [criterion.id]: {\r\n                              ...editingCriteria[criterion.id],\r\n                              name: e.target.value\r\n                            }\r\n                          });\r\n                        }}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-medium\"\r\n                        placeholder={isTemplateName(criterion.name) ? criterion.name : (criterion.level === 1 ? \":  \" : criterion.level === 2 ? \":  \" : \":  \")}\r\n                      />\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingCriteria[criterion.id]?.description || ''}\r\n                        onChange={(e) => {\r\n                          setEditingCriteria({\r\n                            ...editingCriteria,\r\n                            [criterion.id]: {\r\n                              ...editingCriteria[criterion.id],\r\n                              description: e.target.value\r\n                            }\r\n                          });\r\n                        }}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\"\r\n                        placeholder={isTemplateDescription(criterion.description) ? criterion.description : (criterion.level === 1 ? \":      \" : criterion.level === 2 ? \":    \" : \":     \")}\r\n                      />\r\n                    </div>\r\n                  ) : (\r\n                    <div>\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <span className=\"text-lg\">\r\n                          {criterion.level === 1 ? '' : \r\n                           criterion.level === 2 ? '' : \r\n                           criterion.level === 3 ? '' : \r\n                           criterion.level === 4 ? '' : ''}\r\n                        </span>\r\n                        <span className=\"font-medium text-gray-900\">{criterion.name}</span>\r\n                        <span className=\"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded\">\r\n                          L{criterion.level}\r\n                        </span>\r\n                      </div>\r\n                      {criterion.description && (\r\n                        <div className=\"text-sm text-gray-600 mt-1 ml-7\">\r\n                          {criterion.description}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-1\">\r\n                  {isEditing ? (\r\n                    <>\r\n                      <button\r\n                        onClick={() => saveInlineEdit(criterion.id)}\r\n                        className=\"p-2 text-green-600 hover:bg-green-100 rounded-md transition-colors\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                      <button\r\n                        onClick={() => cancelInlineEdit(criterion.id)}\r\n                        className=\"p-2 text-gray-600 hover:bg-gray-100 rounded-md transition-colors\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <button\r\n                        onClick={() => startEditing(criterion.id, criterion.name, criterion.description || '')}\r\n                        className=\"p-2 text-blue-600 hover:bg-blue-100 rounded-md transition-colors\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                      <button\r\n                        onClick={() => moveCriterion(criterion.id, 'up')}\r\n                        className=\"p-2 text-gray-600 hover:bg-gray-100 rounded-md transition-colors\"\r\n                        title=\" \"\r\n                      >\r\n                        \r\n                      </button>\r\n                      <button\r\n                        onClick={() => moveCriterion(criterion.id, 'down')}\r\n                        className=\"p-2 text-gray-600 hover:bg-gray-100 rounded-md transition-colors\"\r\n                        title=\" \"\r\n                      >\r\n                        \r\n                      </button>\r\n                      <button\r\n                        onClick={() => deleteCriterion(criterion.id)}\r\n                        className=\"p-2 text-red-600 hover:bg-red-100 rounded-md transition-colors\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  //   \r\n  const handleTemplateSelect = (template: CriteriaTemplate) => {\r\n    const convertTemplateStructure = (items: TemplateItem[], parentId: string | null = null, level: number = 1): Criterion[] => {\r\n      const result: Criterion[] = [];\r\n      \r\n      items.forEach((item, index) => {\r\n        const id = generateUUID();\r\n        const criterion: Criterion = {\r\n          id,\r\n          name: item.name,\r\n          description: item.description,\r\n          parent_id: parentId,\r\n          level,\r\n          order: index + 1,\r\n          weight: 1,\r\n          type: 'criteria',\r\n          children: []\r\n        };\r\n        \r\n        if (item.children && item.children.length > 0) {\r\n          criterion.children = convertTemplateStructure(item.children, id, level + 1);\r\n        }\r\n        \r\n        result.push(criterion);\r\n      });\r\n      \r\n      return result;\r\n    };\r\n    \r\n    const newCriteria = convertTemplateStructure(template.structure);\r\n    \r\n    //   \r\n    setTempCriteria(newCriteria);\r\n    setCriteria(newCriteria);\r\n    setHasTempChanges(true);\r\n    setShowTemplates(false);\r\n    setActiveInputMode(null);\r\n    \r\n    showActionMessage('success', `'${template.name}'  . ''    .`);\r\n  };\r\n\r\n  //   \r\n  const handleBulkImport = (importedCriteria: Criterion[]) => {\r\n    //  \r\n    if (!importedCriteria || importedCriteria.length === 0) {\r\n      showActionMessage('error', '  .');\r\n      return;\r\n    }\r\n    \r\n    // parent_id, level, order  \r\n    const normalizedCriteria = importedCriteria.map((criterion, index) => {\r\n      const normalized = {\r\n        ...criterion,\r\n        id: criterion.id || generateUUID(),\r\n        level: criterion.level || 1,\r\n        order: criterion.order || index + 1,\r\n        parent_id: criterion.parent_id || null,\r\n        type: 'criteria' as const\r\n      };\r\n\r\n      return normalized;\r\n    });\r\n\r\n    //   \r\n    const hierarchicalCriteria = buildHierarchy(normalizedCriteria);\r\n\r\n    //     fallback \r\n    if (hierarchicalCriteria.length === 0 && normalizedCriteria.length > 0) {\r\n      //      fallback\r\n      const fallbackCriteria = normalizedCriteria.map(criterion => ({\r\n        ...criterion,\r\n        level: 1,\r\n        parent_id: null,\r\n        children: []\r\n      }));\r\n\r\n      setTempCriteria(fallbackCriteria);\r\n      setCriteria(fallbackCriteria);\r\n      setHasTempChanges(true);\r\n      setShowBulkInput(false);\r\n      setActiveInputMode(null);\r\n      \r\n      showActionMessage('info', `         . (${normalizedCriteria.length})\\n     .`);\r\n      return;\r\n    }\r\n    \r\n    //     \r\n    setTempCriteria(hierarchicalCriteria);\r\n    setCriteria(hierarchicalCriteria);\r\n    setHasTempChanges(true);\r\n    setShowBulkInput(false);\r\n    setActiveInputMode(null);\r\n    \r\n    //      \r\n    const totalFlat = flattenCriteria(hierarchicalCriteria);\r\n    const levelStats = totalFlat.reduce((acc, c) => {\r\n      acc[c.level] = (acc[c.level] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<number, number>);\r\n    \r\n    const statsText = Object.entries(levelStats)\r\n      .map(([level, count]) => ` ${level}: ${count}`)\r\n      .join(', ');\r\n      \r\n    showActionMessage('success', `${normalizedCriteria.length}  . ${statsText} ''    .`);\r\n  };\r\n\r\n  //    \r\n  const convertVisualBuilderData = (builderCriteria: VisualCriteriaNode[]): Criterion[] => {\r\n    const result: Criterion[] = [];\r\n\r\n    const traverse = (nodes: VisualCriteriaNode[], parentId: string | null = null, level: number = 1) => {\r\n      nodes.forEach((node, index) => {\r\n        const criterion: Criterion = {\r\n          id: node.id || generateUUID(),\r\n          name: node.name,\r\n          description: node.description,\r\n          parent_id: parentId,\r\n          level,\r\n          order: index + 1,\r\n          weight: 1,\r\n          type: 'criteria',\r\n          children: []\r\n        };\r\n        \r\n        if (node.children && node.children.length > 0) {\r\n          criterion.children = traverse(node.children, criterion.id, level + 1);\r\n        }\r\n        \r\n        result.push(criterion);\r\n      });\r\n      \r\n      return result;\r\n    };\r\n    \r\n    return traverse(builderCriteria);\r\n  };\r\n\r\n  // Criterion CriteriaNode  ()\r\n  const convertToVisualNode = (criteria: Criterion[]): VisualCriteriaNode[] => {\r\n    return criteria.map(c => ({\r\n      id: c.id,\r\n      name: c.name,\r\n      description: c.description,\r\n      level: c.level,\r\n      parent_id: c.parent_id || null,\r\n      children: c.children ? convertToVisualNode(c.children) : [],\r\n      isExpanded: true\r\n    }));\r\n  };\r\n\r\n  //    \r\n  const handleVisualBuilderSave = (builderCriteria: VisualCriteriaNode[]) => {\r\n    const convertedCriteria = convertVisualBuilderData(builderCriteria);\r\n    \r\n    //   \r\n    setTempCriteria(convertedCriteria);\r\n    setCriteria(convertedCriteria);\r\n    setHasTempChanges(true);\r\n    \r\n    showActionMessage('success', `${convertedCriteria.length}    . ''    .`);\r\n  };\r\n\r\n  //    ( )\r\n  const getAllCriteria = (criteriaList: Criterion[]): Criterion[] => {\r\n    return flattenCriteria(criteriaList);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {actionMessage && (\r\n        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg ${actionMessage.type === 'success' ? 'bg-green-100 text-green-800' : actionMessage.type === 'info' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`}>\r\n          {actionMessage.text}\r\n        </div>\r\n      )}\r\n      <Card title=\"  \">\r\n        <div className=\"space-y-6\">\r\n          {/*    */}\r\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n            <h4 className=\"font-medium text-blue-900 mb-2\">   </h4>\r\n            <p className=\"text-sm text-blue-700\">\r\n                    .\r\n                   .\r\n            </p>\r\n            {hasTempChanges && (\r\n              <div className=\"mt-2 p-2 bg-yellow-100 border border-yellow-300 rounded\">\r\n                <p className=\"text-sm text-yellow-800\">\r\n                      . ''   .\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/*     */}\r\n          <div className=\"border-b pb-4\">\r\n            <h4 className=\"font-medium text-gray-900 mb-3\">  </h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n              <div className=\"relative\">\r\n                <Button\r\n                  variant={activeInputMode === 'template' ? 'primary' : 'outline'}\r\n                  onClick={() => {\r\n                    setActiveInputMode('template');\r\n                    setShowTemplates(true);\r\n                    setShowBulkInput(false);\r\n                  }}\r\n                  className=\"flex items-center justify-center w-full\"\r\n                  title=\"        .\"\r\n                >\r\n                  <span className=\"mr-2\"></span>\r\n                    \r\n                </Button>\r\n              </div>\r\n              \r\n              <div className=\"relative\">\r\n                <Button\r\n                  variant={activeInputMode === 'bulk' ? 'primary' : 'outline'}\r\n                  onClick={() => {\r\n                    setActiveInputMode('bulk');\r\n                    setShowBulkInput(true);\r\n                    setShowTemplates(false);\r\n                  }}\r\n                  className=\"flex items-center justify-center w-full\"\r\n                  title=\"       . , ,   .\"\r\n                >\r\n                  <span className=\"mr-2\"></span>\r\n                    \r\n                </Button>\r\n              </div>\r\n              \r\n              <div className=\"relative\">\r\n                <Button\r\n                  variant={activeInputMode === 'visual' ? 'primary' : 'outline'}\r\n                  onClick={() => {\r\n                    setActiveInputMode(activeInputMode === 'visual' ? null : 'visual');\r\n                    setShowTemplates(false);\r\n                    setShowBulkInput(false);\r\n                  }}\r\n                  className=\"flex items-center justify-center w-full\"\r\n                  title=\"       .\"\r\n                >\r\n                  <span className=\"mr-2\"></span>\r\n                   \r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/*       */}\r\n          <div className=\"min-h-[300px]\">\r\n            {activeInputMode === 'visual' ? (\r\n              //   \r\n              <div className=\"border border-gray-200 rounded-lg p-4\">\r\n                <VisualCriteriaBuilder\r\n                  initialCriteria={convertToVisualNode(criteria)}\r\n                  onSave={handleVisualBuilderSave}\r\n                  onClose={() => setActiveInputMode(null)}\r\n                />\r\n              </div>\r\n            ) : criteria.length > 0 ? (\r\n              <div>\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                  <h4 className=\"font-medium text-gray-900\"> </h4>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <button\r\n                      onClick={() => setEditMode(!editMode)}\r\n                      className={`px-3 py-1 text-sm rounded-md transition-colors ${\r\n                        editMode \r\n                          ? 'bg-green-100 text-green-700 border border-green-300' \r\n                          : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                      }`}\r\n                    >\r\n                      {editMode ? '  ' : ' '}\r\n                    </button>\r\n                    {!editMode && (\r\n                      <>\r\n                        <button\r\n                          onClick={() => setLayoutMode('vertical')}\r\n                          className={`px-3 py-1 text-sm rounded-md transition-colors ${\r\n                            layoutMode === 'vertical' \r\n                              ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                          }`}\r\n                        >\r\n                           \r\n                        </button>\r\n                        <button\r\n                          onClick={() => setLayoutMode('horizontal')}\r\n                          className={`px-3 py-1 text-sm rounded-md transition-colors ${\r\n                            layoutMode === 'horizontal' \r\n                              ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                          }`}\r\n                        >\r\n                           \r\n                        </button>\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                {editMode ? (\r\n                  <div className=\"space-y-4\">\r\n                    {renderEditableCriteriaList(hasTempChanges ? tempCriteria : criteria)}\r\n                  </div>\r\n                ) : (\r\n                  <HierarchyTreeVisualization \r\n                    nodes={getAllCriteria(criteria)}\r\n                    title=\"\"\r\n                    showWeights={false}\r\n                    interactive={true}\r\n                    layout={layoutMode}\r\n                    onLayoutChange={setLayoutMode}\r\n                  />\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg\">\r\n                <div className=\"text-gray-500\">\r\n                  <div className=\"text-4xl mb-3\"></div>\r\n                  <p className=\"text-lg font-medium\"> </p>\r\n                  <p className=\"text-sm mt-2\">       </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/*   */}\r\n          {criteria.length > 0 && (\r\n            <div className=\"bg-gray-50 rounded-lg p-4\">\r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-gray-900\">\r\n                    {getAllCriteria(criteria).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\"> </div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-gray-900\">\r\n                    {criteria.filter(c => c.level === 1).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\"> </div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-gray-900\">\r\n                    {getAllCriteria(criteria).filter(c => c.level > 1).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\"> </div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-gray-900\">\r\n                    {Math.max(...getAllCriteria(criteria).map(c => c.level), 0)}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\"> </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/*   */}\r\n          <div className=\"flex justify-between items-center pt-4 border-t\">\r\n            <Button\r\n              variant=\"secondary\"\r\n              onClick={handleReset}\r\n              disabled={isLoading || criteria.length === 0}\r\n              className=\"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200\"\r\n            >\r\n               \r\n            </Button>\r\n            \r\n            <div className=\"flex space-x-3\">\r\n              {onComplete && (\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={onComplete}\r\n                  disabled={isLoading || savedCriteria.length === 0}\r\n                >\r\n                   \r\n                </Button>\r\n              )}\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={handleSaveCriteria}\r\n                disabled={isLoading || isSaving || criteria.length === 0}\r\n              >\r\n                {isSaving ? ' ...' : ''}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n\r\n      {/*    */}\r\n      {showTemplates && (\r\n        <CriteriaTemplates\r\n          onSelectTemplate={handleTemplateSelect}\r\n          onClose={() => {\r\n            setShowTemplates(false);\r\n            setActiveInputMode(null);\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/*    */}\r\n      {showBulkInput && (\r\n        <BulkCriteriaInput\r\n          onImport={handleBulkImport}\r\n          onCancel={() => {\r\n            setShowBulkInput(false);\r\n            setActiveInputMode(null);\r\n          }}\r\n          existingCriteria={criteria}\r\n        />\r\n      )}\r\n\r\n      {/*   */}\r\n      <Modal\r\n        isOpen={pendingAction !== null}\r\n        onClose={() => setPendingAction(null)}\r\n        title={pendingAction?.type === 'reset' ? ' ' : ' '}\r\n        size=\"sm\"\r\n        footer={\r\n          <div className=\"flex justify-end space-x-2\">\r\n            <button\r\n              onClick={() => setPendingAction(null)}\r\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\"\r\n            >\r\n              \r\n            </button>\r\n            <button\r\n              onClick={pendingAction?.type === 'reset' ? confirmReset : confirmDeleteCriterion}\r\n              className=\"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md\"\r\n            >\r\n              {pendingAction?.type === 'reset' ? '' : ''}\r\n            </button>\r\n          </div>\r\n        }\r\n      >\r\n        {pendingAction?.type === 'reset' && (\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-gray-700\">  ?</p>\r\n            <p className=\"text-sm text-red-600 font-medium\">    .</p>\r\n          </div>\r\n        )}\r\n        {pendingAction?.type === 'deleteCriterion' && (\r\n          <p className=\"text-sm text-gray-700\">  ?</p>\r\n        )}\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CriteriaManagement;","import React, { useState, useEffect } from 'react';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport Input from '../common/Input';\r\nimport Modal from '../common/Modal';\r\nimport cleanDataService from '../../services/dataService_clean';\r\nimport { EvaluatorData } from '../../services/api';\r\nimport { QRCodeSVG as QRCode } from 'qrcode.react';\r\n\r\ninterface Evaluator {\r\n  id?: string;\r\n  project_id: string;\r\n  name: string;\r\n  email: string;\r\n  access_key?: string;\r\n  status: 'pending' | 'active' | 'completed';\r\n  inviteLink?: string;\r\n  progress?: number;\r\n  department?: string;\r\n  experience?: string;\r\n  code?: string;\r\n  showQR?: boolean;\r\n  completedAt?: string;\r\n  totalComparisons?: number;\r\n  completedComparisons?: number;\r\n  demographicSurveyUrl?: string;\r\n  demographicSurveyCompleted?: boolean;\r\n  qrCodeData?: string;\r\n}\r\n\r\ninterface EvaluatorAssignmentProps {\r\n  projectId: string;\r\n  onComplete: () => void;\r\n  onEvaluatorsChange?: (count: number) => void;\r\n  maxEvaluators?: number; //    \r\n  currentPlan?: string; //  \r\n}\r\n\r\nconst EvaluatorAssignment: React.FC<EvaluatorAssignmentProps> = ({ \r\n  projectId, \r\n  onComplete,\r\n  onEvaluatorsChange,\r\n  maxEvaluators = 50, // : Standard Plan\r\n  currentPlan = 'Standard Plan'\r\n}) => {\r\n  const [evaluators, setEvaluators] = useState<Evaluator[]>([]);\r\n  const [pendingDeleteId, setPendingDeleteId] = useState<string | null>(null);\r\n  const [actionMessage, setActionMessage] = useState<{type:'success'|'error'|'info', text:string}|null>(null);\r\n\r\n  const showActionMessage = (type: 'success'|'error'|'info', text: string) => {\r\n    setActionMessage({type, text});\r\n    setTimeout(() => setActionMessage(null), 3000);\r\n  };\r\n  const [evaluationStats, setEvaluationStats] = useState<{\r\n    total: number;\r\n    pending: number;\r\n    active: number;\r\n    completed: number;\r\n  }>({ total: 0, pending: 0, active: 0, completed: 0 });\r\n\r\n  useEffect(() => {\r\n    //  DB   \r\n    const loadProjectEvaluators = async () => {\r\n      const base = window.location.href.split('?')[0].replace(/\\/$/, '');\r\n      try {\r\n        const evaluatorsData = await cleanDataService.getEvaluators(projectId);\r\n\r\n        // EvaluatorData Evaluator  \r\n        const convertedEvaluators: Evaluator[] = evaluatorsData.map((evaluator: EvaluatorData) => {\r\n          const evalLink = evaluator.access_key\r\n            ? `${base}/?project=${projectId}&key=${evaluator.access_key}`\r\n            : undefined;\r\n\r\n          return {\r\n            id: evaluator.id,\r\n            project_id: evaluator.project_id,\r\n            name: evaluator.name,\r\n            email: evaluator.email,\r\n            access_key: evaluator.access_key,\r\n            status: evaluator.status,\r\n            progress: 0,\r\n            code: evaluator.access_key || `EVL${String(Math.floor(Math.random() * 999) + 1).padStart(3, '0')}`,\r\n            inviteLink: evalLink,\r\n            demographicSurveyCompleted: false\r\n          };\r\n        });\r\n\r\n        setEvaluators(convertedEvaluators);\r\n\r\n        //  \r\n        updateEvaluationStats(convertedEvaluators);\r\n\r\n        //     \r\n        if (onEvaluatorsChange) {\r\n          onEvaluatorsChange(convertedEvaluators.length);\r\n        }\r\n      } catch (error) {\r\n        setEvaluators([]);\r\n        if (onEvaluatorsChange) {\r\n          onEvaluatorsChange(0);\r\n        }\r\n      }\r\n    };\r\n\r\n    if (projectId) {\r\n      loadProjectEvaluators();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [projectId]);\r\n\r\n  const [newEvaluator, setNewEvaluator] = useState({ name: '', email: '' });\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n\r\n  const generateAccessKey = (): string => {\r\n    const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\r\n    const array = new Uint8Array(8);\r\n    crypto.getRandomValues(array);\r\n    const key = Array.from(array, byte => charset[byte % 36]).join('');\r\n    return 'KEY_' + key;\r\n  };\r\n\r\n  const updateEvaluationStats = (evaluatorList: Evaluator[]) => {\r\n    const stats = {\r\n      total: evaluatorList.length,\r\n      pending: evaluatorList.filter(e => e.status === 'pending').length,\r\n      active: evaluatorList.filter(e => e.status === 'active').length,\r\n      completed: evaluatorList.filter(e => e.status === 'completed').length\r\n    };\r\n    setEvaluationStats(stats);\r\n    \r\n    //     \r\n    if (onEvaluatorsChange) {\r\n      onEvaluatorsChange(evaluatorList.length);\r\n    }\r\n  };\r\n\r\n  const toggleQRCode = (evaluatorId: string) => {\r\n    setEvaluators(prev => prev.map(e => \r\n      e.id === evaluatorId ? { ...e, showQR: !e.showQR } : e\r\n    ));\r\n  };\r\n\r\n  const validateEvaluator = (evaluator: { name: string; email: string }): boolean => {\r\n    const newErrors: Record<string, string> = {};\r\n\r\n    if (!evaluator.name.trim()) {\r\n      newErrors.name = '  .';\r\n    } else if (evaluator.name.length < 2) {\r\n      newErrors.name = ' 2  .';\r\n    }\r\n\r\n    if (!evaluator.email.trim()) {\r\n      newErrors.email = ' .';\r\n    } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(evaluator.email)) {\r\n      newErrors.email = '   .';\r\n    } else if (evaluators.some(e => e.email === evaluator.email)) {\r\n      newErrors.email = '  .';\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleAddEvaluator = async () => {\r\n    //    \r\n    if (evaluators.length >= maxEvaluators) {\r\n      showActionMessage('error', `  (${maxEvaluators}) . ${currentPlan}   ${maxEvaluators}   .`);\r\n      return;\r\n    }\r\n\r\n    if (!validateEvaluator(newEvaluator)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const evaluatorData: Omit<EvaluatorData, 'id'> = {\r\n        project_id: projectId,\r\n        name: newEvaluator.name,\r\n        email: newEvaluator.email,\r\n        access_key: generateAccessKey(),\r\n        status: 'pending'\r\n      };\r\n\r\n      const createdEvaluator = await cleanDataService.createEvaluator(evaluatorData);\r\n\r\n      if (createdEvaluator) {\r\n        const base = window.location.href.split('?')[0].replace(/\\/$/, '');\r\n        const evalLink = `${base}/?project=${projectId}&key=${createdEvaluator.access_key}`;\r\n\r\n        const newEval: Evaluator = {\r\n          id: createdEvaluator.id,\r\n          project_id: createdEvaluator.project_id,\r\n          name: createdEvaluator.name,\r\n          email: createdEvaluator.email,\r\n          access_key: createdEvaluator.access_key,\r\n          status: createdEvaluator.status,\r\n          progress: 0,\r\n          code: createdEvaluator.access_key,\r\n          inviteLink: evalLink,\r\n          demographicSurveyCompleted: false\r\n        };\r\n\r\n        const updatedEvaluators = [...evaluators, newEval];\r\n        setEvaluators(updatedEvaluators);\r\n        setNewEvaluator({ name: '', email: '' });\r\n        setErrors({});\r\n\r\n        if (onEvaluatorsChange) {\r\n          onEvaluatorsChange(updatedEvaluators.length);\r\n        }\r\n      } else {\r\n        setErrors({ general: '  .' });\r\n      }\r\n    } catch (error) {\r\n      setErrors({ general: error instanceof Error ? error.message : '    .' });\r\n    }\r\n  };\r\n\r\n  const handleSendInvite = async (id: string) => {\r\n    //      (   API )\r\n    const updatedEvaluators = evaluators.map(evaluator => \r\n      evaluator.id === id \r\n        ? { ...evaluator, status: 'active' as const }\r\n        : evaluator\r\n    );\r\n    setEvaluators(updatedEvaluators);\r\n  };\r\n\r\n  const handleDeleteEvaluator = (id: string) => {\r\n    setPendingDeleteId(id);\r\n  };\r\n\r\n  const handleConfirmDeleteEvaluator = async () => {\r\n    if (!pendingDeleteId) return;\r\n    const id = pendingDeleteId;\r\n    setPendingDeleteId(null);\r\n\r\n    try {\r\n      await cleanDataService.deleteEvaluator(id, projectId);\r\n\r\n      const updatedEvaluators = evaluators.filter(e => e.id !== id);\r\n      setEvaluators(updatedEvaluators);\r\n\r\n      if (onEvaluatorsChange) {\r\n        onEvaluatorsChange(updatedEvaluators.length);\r\n      }\r\n    } catch (error) {\r\n      showActionMessage('error', '    .');\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: Evaluator['status']) => {\r\n    const styles = {\r\n      pending: 'bg-gray-100 text-gray-800',\r\n      active: 'bg-green-100 text-green-800',\r\n      completed: 'bg-purple-100 text-purple-800'\r\n    };\r\n\r\n    const labels = {\r\n      pending: '',\r\n      active: '',\r\n      completed: ''\r\n    };\r\n\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-medium ${styles[status]}`}>\r\n        {labels[status]}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const getProgressBadge = (progress: number) => {\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-medium ${\r\n        progress === 0 ? 'bg-gray-100 text-gray-800' :\r\n        progress < 50 ? 'bg-red-100 text-red-800' :\r\n        progress < 100 ? 'bg-yellow-100 text-yellow-800' :\r\n        'bg-green-100 text-green-800'\r\n      }`}>\r\n        {progress}%\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {actionMessage && (\r\n        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg ${actionMessage.type === 'success' ? 'bg-green-100 text-green-800' : actionMessage.type === 'info' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`}>\r\n          {actionMessage.text}\r\n        </div>\r\n      )}\r\n\r\n      <Modal\r\n        isOpen={pendingDeleteId !== null}\r\n        onClose={() => setPendingDeleteId(null)}\r\n        title=\" \"\r\n        size=\"sm\"\r\n        footer={\r\n          <div className=\"flex justify-end space-x-3\">\r\n            <Button variant=\"secondary\" onClick={() => setPendingDeleteId(null)}>\r\n              \r\n            </Button>\r\n            <Button variant=\"error\" onClick={handleConfirmDeleteEvaluator}>\r\n              \r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <p className=\"text-sm text-gray-600\">   ?</p>\r\n      </Modal>\r\n\r\n      <Card title=\" \">\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-purple-50 border border-purple-200 rounded-lg p-4\">\r\n            <h4 className=\"font-medium text-purple-900 mb-2\">   </h4>\r\n            <ul className=\"text-sm text-purple-700 space-y-1\">\r\n              <li>       </li>\r\n              <li> QR       </li>\r\n              <li>      </li>\r\n              <li>        </li>\r\n              <li>      </li>\r\n            </ul>\r\n          </div>\r\n\r\n          {/*     */}\r\n          <div className=\"grid grid-cols-4 gap-4\">\r\n            <div className=\"bg-white border rounded-lg p-3\">\r\n              <div className=\"text-2xl font-bold text-gray-900\">{evaluationStats.total}</div>\r\n              <div className=\"text-sm text-gray-500\"> </div>\r\n            </div>\r\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\r\n              <div className=\"text-2xl font-bold text-yellow-800\">{evaluationStats.pending}</div>\r\n              <div className=\"text-sm text-yellow-700\"></div>\r\n            </div>\r\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\r\n              <div className=\"text-2xl font-bold text-blue-800\">{evaluationStats.active}</div>\r\n              <div className=\"text-sm text-blue-700\"></div>\r\n            </div>\r\n            <div className=\"bg-green-50 border border-green-200 rounded-lg p-3\">\r\n              <div className=\"text-2xl font-bold text-green-800\">{evaluationStats.completed}</div>\r\n              <div className=\"text-sm text-green-700\"></div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Current Evaluators List */}\r\n          <div>\r\n            <h4 className=\"font-medium text-gray-900 mb-4\">   </h4>\r\n\r\n            {evaluators.length === 0 ? (\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                   .\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                {evaluators.map((evaluator) => (\r\n                  <div\r\n                    key={evaluator.id}\r\n                    className=\"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white hover:bg-gray-50\"\r\n                  >\r\n                    <div className=\"flex items-center flex-1\">\r\n                      <div className=\"flex items-center justify-center w-12 h-12 bg-blue-100 text-blue-800 rounded-full text-sm font-medium mr-4\">\r\n                        {evaluator.code || evaluator.access_key?.substring(0, 3) || 'EVL'}\r\n                      </div>\r\n                      \r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <h5 className=\"font-medium text-gray-900\">{evaluator.name}</h5>\r\n                          {getStatusBadge(evaluator.status)}\r\n                          {getProgressBadge(evaluator.progress || 0)}\r\n                        </div>\r\n                        {evaluator.email && (\r\n                          <p className=\"text-sm text-gray-600 mt-1\">{evaluator.email}</p>\r\n                        )}\r\n                        {(evaluator.department || evaluator.experience) && (\r\n                          <div className=\"flex items-center space-x-4 mt-1\">\r\n                            {evaluator.department && (\r\n                              <span className=\"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded\">\r\n                                {evaluator.department}\r\n                              </span>\r\n                            )}\r\n                            {evaluator.experience && (\r\n                              <span className=\"text-xs bg-green-50 text-green-700 px-2 py-1 rounded\">\r\n                                 {evaluator.experience}\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                        {evaluator.inviteLink && (\r\n                          <div className=\"mt-2 space-y-1\">\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <span className=\"text-xs text-gray-500\"> :</span>\r\n                              <code className=\"text-xs bg-green-50 text-green-700 px-2 py-1 rounded border border-green-200\">\r\n                                {evaluator.inviteLink}\r\n                              </code>\r\n                            </div>\r\n                            {evaluator.demographicSurveyUrl && (\r\n                              <div className=\"flex items-center space-x-2\">\r\n                                <span className=\"text-xs text-gray-500\">:</span>\r\n                                <code className=\"text-xs bg-yellow-50 text-yellow-700 px-2 py-1 rounded border border-yellow-200\">\r\n                                  {evaluator.demographicSurveyUrl}\r\n                                </code>\r\n                              </div>\r\n                            )}\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <button\r\n                                onClick={() => window.open(evaluator.inviteLink, '_blank')}\r\n                                className=\"text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition-colors\"\r\n                              >\r\n                                  \r\n                              </button>\r\n                              <button\r\n                                onClick={() => navigator.clipboard.writeText(evaluator.inviteLink || '')}\r\n                                className=\"text-xs bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors\"\r\n                              >\r\n                                  \r\n                              </button>\r\n                              <button\r\n                                onClick={() => toggleQRCode(evaluator.id ?? '')}\r\n                                className=\"text-xs bg-purple-500 text-white px-3 py-1 rounded hover:bg-purple-600 transition-colors\"\r\n                              >\r\n                                {evaluator.showQR ? ' QR ' : ' QR '}\r\n                              </button>\r\n                            </div>\r\n                            {evaluator.showQR && evaluator.inviteLink && (\r\n                              <div className=\"mt-3 p-3 bg-gray-50 rounded-lg\">\r\n                                <div className=\"text-center\">\r\n                                  <h5 className=\"text-sm font-medium text-gray-700 mb-2\">  QR </h5>\r\n                                  <div className=\"inline-block p-2 bg-white rounded border border-gray-200\">\r\n                                    <QRCode \r\n                                      value={JSON.stringify({\r\n                                        evaluationUrl: evaluator.inviteLink,\r\n                                        surveyUrl: evaluator.demographicSurveyUrl,\r\n                                        projectId: projectId,\r\n                                        evaluatorId: evaluator.id,\r\n                                        accessKey: evaluator.access_key\r\n                                      })} \r\n                                      size={200}\r\n                                      level=\"M\"\r\n                                      includeMargin={true}\r\n                                    />\r\n                                  </div>\r\n                                  <p className=\"text-xs text-gray-500 mt-2\">\r\n                                    QR      \r\n                                  </p>\r\n                                  <div className=\"mt-2 space-y-1\">\r\n                                    <p className=\"text-xs text-blue-600\">1.  </p>\r\n                                    <p className=\"text-xs text-green-600\">2. AHP  </p>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center space-x-2 ml-4\">\r\n                      {evaluator.status === 'pending' && (\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"primary\"\r\n                          onClick={() => handleSendInvite(evaluator.id ?? '')}\r\n                        >\r\n                            \r\n                        </Button>\r\n                      )}\r\n                      <button\r\n                        onClick={() => handleDeleteEvaluator(evaluator.id ?? '')}\r\n                        className=\"text-red-500 hover:text-red-700 text-sm\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Add New Evaluator */}\r\n          <div className=\"border-t pt-6\">\r\n            <h4 className=\"font-medium text-gray-900 mb-4\">   </h4>\r\n            \r\n            {/*    */}\r\n            {errors.general && (\r\n              <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\r\n                <div className=\"flex items-center\">\r\n                  <span className=\"text-red-600 mr-2\"></span>\r\n                  <span className=\"text-red-800 text-sm\">{errors.general}</span>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n              <Input\r\n                id=\"evaluatorName\"\r\n                label=\" \"\r\n                placeholder=\" \"\r\n                value={newEvaluator.name}\r\n                onChange={(value) => setNewEvaluator(prev => ({ ...prev, name: value }))}\r\n                error={errors.name}\r\n                required\r\n              />\r\n\r\n              <Input\r\n                id=\"evaluatorEmail\"\r\n                label=\"\"\r\n                placeholder=\"email@example.com\"\r\n                value={newEvaluator.email}\r\n                onChange={(value) => setNewEvaluator(prev => ({ ...prev, email: value }))}\r\n                error={errors.email}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex justify-end\">\r\n              <Button onClick={handleAddEvaluator} variant=\"primary\">\r\n                 \r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Summary */}\r\n          <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\r\n              <div>\r\n                <div className=\"text-2xl font-bold text-gray-900\">{evaluators.length}</div>\r\n                <div className=\"text-sm text-gray-600\"> </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-2xl font-bold text-blue-600\">\r\n                  {evaluators.filter(e => e.status === 'pending').length}\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\"></div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-2xl font-bold text-green-600\">\r\n                  {evaluators.filter(e => e.status === 'active').length}\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\"> </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-2xl font-bold text-purple-600\">\r\n                  {evaluators.filter(e => e.status === 'completed').length}\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\"> </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex justify-between items-center pt-6 border-t\">\r\n            <div className=\"text-sm text-gray-600\">\r\n              {evaluators.length === 0 && (\r\n                <span className=\"text-blue-600\">       .</span>\r\n              )}\r\n            </div>\r\n            <div className=\"flex space-x-3\">\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => showActionMessage('success', '  .')}\r\n              >\r\n                \r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={onComplete}\r\n              >\r\n                 \r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EvaluatorAssignment;","import React, { useState } from 'react';\r\nimport Modal from './Modal';\r\n\r\ninterface TreeNode {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  children?: TreeNode[];\r\n  weight?: number;\r\n  parent_id?: string | null;\r\n}\r\n\r\ninterface HierarchyTreeVisualizationProps {\r\n  nodes: TreeNode[];\r\n  title?: string;\r\n  showWeights?: boolean;\r\n  interactive?: boolean;\r\n  onNodeClick?: (node: TreeNode) => void;\r\n  onNodeDelete?: (node: TreeNode) => void;\r\n  layout?: 'vertical' | 'horizontal';\r\n  onLayoutChange?: (layout: 'vertical' | 'horizontal') => void;\r\n  allowDelete?: boolean;\r\n}\r\n\r\nconst HierarchyTreeVisualization: React.FC<HierarchyTreeVisualizationProps> = ({\r\n  nodes,\r\n  title = \"\",\r\n  showWeights = false,\r\n  interactive = false,\r\n  onNodeClick,\r\n  onNodeDelete,\r\n  layout = 'vertical',\r\n  onLayoutChange,\r\n  allowDelete = false\r\n}) => {\r\n  const [pendingDeleteNode, setPendingDeleteNode] = useState<TreeNode | null>(null);\r\n\r\n  //   \r\n  const buildHierarchy = (flatNodes: TreeNode[]): TreeNode[] => {\r\n    const nodeMap = new Map<string, TreeNode>();\r\n    const rootNodes: TreeNode[] = [];\r\n\r\n    //     \r\n    flatNodes.forEach(node => {\r\n      nodeMap.set(node.id, { ...node, children: [] });\r\n    });\r\n\r\n    // -  \r\n    flatNodes.forEach(node => {\r\n      const nodeWithChildren = nodeMap.get(node.id);\r\n      if (!nodeWithChildren) return;\r\n      if (node.parent_id && nodeMap.has(node.parent_id)) {\r\n        const parent = nodeMap.get(node.parent_id);\r\n        if (!parent) return;\r\n        if (!parent.children) parent.children = [];\r\n        parent.children.push(nodeWithChildren);\r\n      } else {\r\n        rootNodes.push(nodeWithChildren);\r\n      }\r\n    });\r\n\r\n    return rootNodes;\r\n  };\r\n\r\n  const hierarchy = buildHierarchy(nodes);\r\n\r\n  const getNodeIcon = (node: TreeNode) => {\r\n    switch (node.level) {\r\n      case 1: return ''; // (Goal)\r\n      case 2: return ''; // (Criteria)\r\n      case 3: return ''; // (Alternatives)\r\n      case 4: return ''; // (Sub-criteria)\r\n      case 5: return ''; // (Detailed criteria)\r\n      default: return '';\r\n    }\r\n  };\r\n\r\n  const getNodeColor = (level: number) => {\r\n    switch (level) {\r\n      case 1: return 'bg-blue-100 border-blue-300 text-blue-800';\r\n      case 2: return 'bg-green-100 border-green-300 text-green-800';\r\n      case 3: return 'bg-purple-100 border-purple-300 text-purple-800';\r\n      case 4: return 'bg-yellow-100 border-yellow-300 text-yellow-800';\r\n      case 5: return 'bg-pink-100 border-pink-300 text-pink-800';\r\n      default: return 'bg-gray-100 border-gray-300 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const renderVerticalNode = (node: TreeNode, index: number, isLast: boolean[] = []): React.ReactNode => {\r\n    const hasChildren = node.children && node.children.length > 0;\r\n    const isClickable = interactive && onNodeClick;\r\n\r\n    return (\r\n      <div key={node.id} className=\"relative\">\r\n        {/*   */}\r\n        {node.level > 1 && (\r\n          <>\r\n            {/*  */}\r\n            <div \r\n              className=\"absolute w-px bg-gray-300 -left-6 top-0\"\r\n              style={{ height: '24px' }}\r\n            />\r\n            {/*  */}\r\n            <div \r\n              className=\"absolute h-px bg-gray-300 -left-6 top-6\"\r\n              style={{ width: '24px' }}\r\n            />\r\n          </>\r\n        )}\r\n\r\n        {/*   */}\r\n        <div \r\n          className={`\r\n            mb-3 p-3 rounded-lg border-2 transition-all duration-200 \r\n            ${getNodeColor(node.level)}\r\n            ${isClickable ? 'cursor-pointer hover:shadow-md hover:scale-105' : ''}\r\n            ${hasChildren ? 'font-medium' : ''}\r\n          `}\r\n          onClick={() => isClickable && onNodeClick!(node)}\r\n          style={{ marginLeft: `${(node.level - 1) * 32}px` }}\r\n        >\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\">{getNodeIcon(node)}</span>\r\n            <div className=\"flex-1\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <div className=\"font-medium\">{node.name}</div>\r\n                  {node.description && (\r\n                    <div className=\"text-xs opacity-75 mt-1\">{node.description}</div>\r\n                  )}\r\n                </div>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  {showWeights && node.weight && (\r\n                    <div className=\"text-xs font-mono bg-white bg-opacity-50 px-2 py-1 rounded\">\r\n                      {(node.weight * 100).toFixed(1)}%\r\n                    </div>\r\n                  )}\r\n                  {allowDelete && onNodeDelete && (\r\n                    <button\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setPendingDeleteNode(node);\r\n                      }}\r\n                      className=\"p-1 text-red-500 hover:text-red-700 hover:bg-red-100 rounded-md transition-colors duration-200\"\r\n                      title={`${node.name} `}\r\n                    >\r\n                      <span className=\"text-sm\"></span>\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {hasChildren && (\r\n              <span className=\"text-xs text-gray-600\">\r\n                ({node.children?.length ?? 0} )\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*    */}\r\n        {hasChildren && (\r\n          <div className=\"relative\">\r\n            {node.children?.map((child, childIndex) => {\r\n              const childIsLast = [...isLast, childIndex === (node.children?.length ?? 0) - 1];\r\n              return renderVerticalNode(child, childIndex, childIsLast);\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderHorizontalNode = (node: TreeNode): React.ReactNode => {\r\n    const hasChildren = node.children && node.children.length > 0;\r\n    const isClickable = interactive && onNodeClick;\r\n\r\n    return (\r\n      <div key={node.id} className=\"flex flex-col items-center\">\r\n        {/*   */}\r\n        <div \r\n          className={`\r\n            relative p-3 rounded-lg border-2 transition-all duration-200 min-w-[120px] text-center\r\n            ${getNodeColor(node.level)}\r\n            ${isClickable ? 'cursor-pointer hover:shadow-md hover:scale-105' : ''}\r\n            ${hasChildren ? 'font-medium' : ''}\r\n          `}\r\n          onClick={() => isClickable && onNodeClick!(node)}\r\n        >\r\n          {allowDelete && onNodeDelete && (\r\n            <button\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setPendingDeleteNode(node);\r\n              }}\r\n              className=\"absolute top-1 right-1 p-1 text-red-500 hover:text-red-700 hover:bg-red-100 rounded-md transition-colors duration-200\"\r\n              title={`${node.name} `}\r\n            >\r\n              <span className=\"text-xs\"></span>\r\n            </button>\r\n          )}\r\n          \r\n          <div className=\"flex flex-col items-center space-y-1\">\r\n            <span className=\"text-lg\">{getNodeIcon(node)}</span>\r\n            <div className=\"font-medium text-sm\">{node.name}</div>\r\n            {node.description && (\r\n              <div className=\"text-xs opacity-75\">{node.description}</div>\r\n            )}\r\n            {showWeights && node.weight && (\r\n              <div className=\"text-xs font-mono bg-white bg-opacity-50 px-2 py-1 rounded\">\r\n                {(node.weight * 100).toFixed(1)}%\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*    */}\r\n        {hasChildren && (\r\n          <div className=\"relative mt-8\">\r\n            {/*    */}\r\n            <div className=\"absolute top-0 left-1/2 transform -translate-x-1/2\">\r\n              {/*   */}\r\n              <div className=\"w-px h-4 bg-gray-300 -mt-8\"></div>\r\n            </div>\r\n            \r\n            {/*        */}\r\n            {(node.children?.length ?? 0) > 1 && (\r\n              <div className=\"absolute top-0 left-0 right-0 flex justify-center -mt-4\">\r\n                <div\r\n                  className=\"h-px bg-gray-300\"\r\n                  style={{\r\n                    width: `${((node.children?.length ?? 0) - 1) * 150}px`,\r\n                    marginLeft: '75px',\r\n                    marginRight: '75px'\r\n                  }}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/*      */}\r\n            <div className=\"flex space-x-6 justify-center\">\r\n              {node.children?.map((child, index) => (\r\n                <div key={child.id} className=\"relative\">\r\n                  {/*      */}\r\n                  {(node.children?.length ?? 0) > 1 && (\r\n                    <div className=\"absolute top-0 left-1/2 transform -translate-x-1/2 w-px h-4 bg-gray-300 -mt-4\"></div>\r\n                  )}\r\n                  {renderHorizontalNode(child)}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const deleteModal = (\r\n    <Modal\r\n      isOpen={pendingDeleteNode !== null}\r\n      onClose={() => setPendingDeleteNode(null)}\r\n      title=\"  \"\r\n      size=\"sm\"\r\n      footer={\r\n        <div className=\"flex justify-end space-x-3\">\r\n          <button\r\n            onClick={() => setPendingDeleteNode(null)}\r\n            className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\"\r\n          >\r\n            \r\n          </button>\r\n          <button\r\n            onClick={() => {\r\n              if (pendingDeleteNode && onNodeDelete) {\r\n                onNodeDelete(pendingDeleteNode);\r\n              }\r\n              setPendingDeleteNode(null);\r\n            }}\r\n            className=\"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700\"\r\n          >\r\n            \r\n          </button>\r\n        </div>\r\n      }\r\n    >\r\n      <p className=\"text-sm text-gray-600\">\r\n        \"{pendingDeleteNode?.name}\"  ?\r\n      </p>\r\n      <p className=\"text-sm text-red-600 mt-2\">\r\n            .\r\n      </p>\r\n    </Modal>\r\n  );\r\n\r\n  if (hierarchy.length === 0) {\r\n    return (\r\n      <>\r\n        <div className=\"text-center py-12 text-gray-500\">\r\n          <div className=\"text-4xl mb-4\"></div>\r\n          <p className=\"text-lg\"> </p>\r\n          <p className=\"text-sm\">   </p>\r\n        </div>\r\n        {deleteModal}\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\r\n          <span className=\"text-2xl mr-2\"></span>\r\n          {title}\r\n        </h3>\r\n        <div className=\"flex items-center space-x-4\">\r\n          <div className=\"text-sm text-gray-500\">\r\n             {nodes.length} \r\n          </div>\r\n          {onLayoutChange && (\r\n            <div className=\"flex items-center space-x-2\">\r\n              <span className=\"text-sm text-gray-600\">:</span>\r\n              <button\r\n                onClick={() => onLayoutChange('vertical')}\r\n                className={`px-3 py-1 text-xs rounded-md transition-colors ${\r\n                  layout === 'vertical' \r\n                    ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                }`}\r\n              >\r\n                 \r\n              </button>\r\n              <button\r\n                onClick={() => onLayoutChange('horizontal')}\r\n                className={`px-3 py-1 text-xs rounded-md transition-colors ${\r\n                  layout === 'horizontal' \r\n                    ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                }`}\r\n              >\r\n                 \r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/*   */}\r\n      <div className={layout === 'horizontal' ? 'overflow-x-auto pb-8' : 'space-y-2'}>\r\n        {layout === 'vertical' ? (\r\n          <div className=\"space-y-2\">\r\n            {hierarchy.map((node, index) => renderVerticalNode(node, index))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"flex justify-center min-w-max py-8\">\r\n            <div className=\"inline-block\">\r\n              {/*         */}\r\n              {hierarchy.length === 1 ? (\r\n                renderHorizontalNode(hierarchy[0])\r\n              ) : (\r\n                <div className=\"flex space-x-8\">\r\n                  {hierarchy.map((node) => renderHorizontalNode(node))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/*  */}\r\n      <div className=\"mt-6 pt-4 border-t border-gray-200\">\r\n        <h4 className=\"text-sm font-medium text-gray-700 mb-3\"></h4>\r\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L1)</span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L2)</span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L3)</span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L4)</span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L5)</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {deleteModal}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HierarchyTreeVisualization;"],"names":["_ref","projectId","onComplete","onAlternativesChange","alternatives","setAlternatives","useState","convertToAlternative","data","id","concat","Date","now","Math","random","name","description","order","position","cost","weight","rank","useEffect","async","convertedAlternatives","dataService","getAlternatives","map","length","error","loadProjectAlternatives","newAlternative","setNewAlternative","editingId","setEditingId","editingAlternative","setEditingAlternative","errors","setErrors","actionMessage","setActionMessage","showActionMessage","type","text","setTimeout","validateAlternative","excludeId","newErrors","trim","some","alt","toLowerCase","Object","keys","handleSaveEdit","response","criteriaApi","updateCriteria","project_id","success","general","prev","_objectSpread","Error","message","handleCancelEdit","_jsxs","className","children","_jsx","Card","title","fill","viewBox","fillRule","d","clipRule","sort","a","b","alternative","index","Input","label","placeholder","value","onChange","toFixed","_Fragment","onClick","findIndex","newAlternatives","forEach","idx","handleMoveUp","disabled","handleMoveDown","find","handleEditAlternative","deleteAlternative","convertedUpdatedAlternatives","handleDeleteAlternative","required","Button","maxOrder","max","alternativeData","createAlternative","variant","join","parseText","lines","split","filter","line","criteria","nameMap","Map","i","parsed","this","parseLine","lowerName","has","push","set","level","structureErrors","validateHierarchy","lineNumber","numberedMatch","match","number","content","includes","p","extractNameAndDescription","markdownMatch","indent","spaces","replace","floor","indentMatch","plainMatch","dashMatch","colonMatch","parenthesesMatch","c","levelSet","Set","levels","Array","from","getExampleTexts","markdown","numbered","indented","onImport","onCancel","existingCriteria","inputText","setInputText","activeTab","setActiveTab","parseResult","setParseResult","isProcessing","setIsProcessing","convertParsedCriteriaFlat","parsedCriteria","allCriteria","levelParentMap","parent_id","parentLevel","parentNode","get","criterion","undefined","delete","getAllCriteria","criteriaList","all","traverse","items","item","exampleTexts","TextParser","e","target","handleParse","result","existingNames","duplicates","levelCounts","reduce","acc","entries","_ref2","count","style","paddingLeft","_ref3","key","size","handleImport","convertedCriteria","validationErrors","idSet","CRITERIA_TEMPLATES","icon","structure","onSelectTemplate","onClose","template","slice","initialCriteria","onSave","isInline","setCriteria","isExpanded","selectedNodeId","setSelectedNodeId","draggedNodeId","setDraggedNodeId","pendingDeleteId","setPendingDeleteId","findNode","nodes","node","found","updateNode","updates","addNode","parentId","_findNode","newNode","isEditing","addChildToParent","confirmDeleteNode","removeNode","toggleEditMode","_findNode2","handleDragOver","preventDefault","dataTransfer","dropEffect","renderNode","depth","arguments","hasChildren","isSelected","draggable","onDragStart","handleDragStart","nodeId","effectAllowed","onDragOver","onDrop","handleDrop","targetId","draggedNode","isDescendantOf","ancestorId","searchId","ancestor","check","n","fixLevels","newParentId","insertAtTarget","movedNode","stopPropagation","_findNode3","updateNodeName","autoFocus","updateNodeDescription","onDoubleClick","child","flattenCriteria","stats","getStats","flatten","total","Modal","isOpen","footer","String","onCriteriaChange","savedCriteria","setSavedCriteria","tempCriteria","setTempCriteria","hasTempChanges","setHasTempChanges","isTemplateName","test","isTemplateDescription","pendingAction","setPendingAction","showTemplates","setShowTemplates","showBulkInput","setShowBulkInput","activeInputMode","setActiveInputMode","isLoading","setIsLoading","isSaving","setIsSaving","layoutMode","setLayoutMode","editMode","setEditMode","editingCriteria","setEditingCriteria","loadCriteria","useCallback","normalizedCriteria","cleanDataService","getCriteria","parent","generateUUID","hierarchicalCriteria","buildHierarchy","flatCriteria","criteriaMap","rootCriteria","idString","criterionObj","parentIdString","sortByOrder","handleSaveCriteria","deleteCriteria","createdCriteriaMap","sortedCriteria","_result$id","resolvedLevel","parentCriteria","isTempId","criteriaData","project","is_active","createCriteria","mappedCriteria","moveCriterion","criterionId","direction","moveCriteriaInList","newCriteria","targetIndex","updatedCriteria","convertToVisualNode","VisualCriteriaBuilder","builderCriteria","convertVisualBuilderData","_editingCriteria$crit","_editingCriteria$crit2","marginLeft","newEditingCriteria","saveInlineEdit","cancelInlineEdit","startEditing","deleteCriterion","renderEditableCriteriaList","HierarchyTreeVisualization","showWeights","interactive","layout","onLayoutChange","handleReset","CriteriaTemplates","convertTemplateStructure","BulkCriteriaInput","importedCriteria","fallbackCriteria","levelStats","statsText","confirmDeleteCriterion","deleteCriteriaFromList","onEvaluatorsChange","maxEvaluators","currentPlan","evaluators","setEvaluators","evaluationStats","setEvaluationStats","pending","active","completed","base","window","location","href","convertedEvaluators","getEvaluators","evaluator","evalLink","access_key","email","status","progress","code","padStart","inviteLink","demographicSurveyCompleted","updateEvaluationStats","loadProjectEvaluators","newEvaluator","setNewEvaluator","generateAccessKey","array","Uint8Array","crypto","getRandomValues","byte","evaluatorList","deleteEvaluator","updatedEvaluators","_evaluator$access_key","substring","department","experience","demographicSurveyUrl","open","navigator","clipboard","writeText","_evaluator$id","evaluatorId","showQR","QRCode","JSON","stringify","evaluationUrl","surveyUrl","accessKey","includeMargin","_evaluator$id2","handleSendInvite","_evaluator$id3","validateEvaluator","evaluatorData","createdEvaluator","createEvaluator","newEval","onNodeClick","onNodeDelete","allowDelete","pendingDeleteNode","setPendingDeleteNode","hierarchy","flatNodes","nodeMap","rootNodes","nodeWithChildren","getNodeIcon","getNodeColor","renderVerticalNode","_node$children$length","_node$children","_node$children2","isLast","isClickable","height","width","childIndex","_node$children$length2","_node$children3","childIsLast","renderHorizontalNode","_node$children$length3","_node$children4","_node$children$length4","_node$children5","_node$children6","marginRight","_node$children$length5","_node$children7","deleteModal"],"sourceRoot":""}