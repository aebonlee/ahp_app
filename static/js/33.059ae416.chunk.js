"use strict";(self.webpackChunkahp_research_platform=self.webpackChunkahp_research_platform||[]).push([[33,604],{4604(e,t,a){a.r(t),a.d(t,{default:()=>c});var s=a(5043),l=a(3593),r=a(7907),n=a(6291),i=a(579);const c=e=>{var t,a,c;let{projectId:d,projectTitle:o,onBack:x,onProjectStatusChange:u,criteriaCount:m=0,evaluatorsCount:p=0}=e;const[g,v]=(0,s.useState)(null),[h,j]=(0,s.useState)(!1),[b,y]=(0,s.useState)(!1),[f,N]=(0,s.useState)("both"),[C,w]=(0,s.useState)(null),[A,S]=(0,s.useState)(!0),[_,k]=(0,s.useState)([]),[D,R]=(0,s.useState)([]),[E,I]=(0,s.useState)(null),P=(e,t)=>{I({type:e,text:t}),setTimeout(()=>I(null),4e3)},L=(0,s.useCallback)(async()=>{S(!0);try{const[a,s,l]=await Promise.allSettled([n.Ay.get("/api/service/projects/projects/".concat(d,"/")),n.Ay.get("/api/service/projects/criteria/?project=".concat(d,"&page_size=200")),n.Ay.get("/api/service/evaluations/evaluations/?project=".concat(d,"&page_size=200"))]);if("fulfilled"===s.status){var e;const t=s.value.data,a=Array.isArray(t)?t:null!==(e=t.results)&&void 0!==e?e:[];k(a.map(e=>{var t,a,s;return{id:String(e.id),name:null!==(t=e.name)&&void 0!==t?t:"",description:e.description,level:null!==(a=e.level)&&void 0!==a?a:1,parent_id:null!==(s=e.parent_id)&&void 0!==s?s:null}}))}let r=[];if("fulfilled"===l.status){var t;const e=l.value.data;r=(Array.isArray(e)?e:null!==(t=e.results)&&void 0!==t?t:[]).map(e=>{var t,a,s,l,r;return{id:String(e.id),evaluator_name:e.evaluator_name||e.evaluator_username||"\uc54c \uc218 \uc5c6\uc74c",evaluator_username:null!==(t=e.evaluator_username)&&void 0!==t?t:"",status:null!==(a=e.status)&&void 0!==a?a:"pending",progress:null!==(s=e.progress)&&void 0!==s?s:0,consistency_ratio:null!==(l=e.consistency_ratio)&&void 0!==l?l:null,is_consistent:null!==(r=e.is_consistent)&&void 0!==r?r:null}}),R(r)}const i="fulfilled"===s.status?((e,t,a)=>{const l=s.value.data;return Array.isArray(l)?l.length:null!==(e=null!==(t=l.count)&&void 0!==t?t:null===(a=l.results)||void 0===a?void 0:a.length)&&void 0!==e?e:0})():m,c=r.filter(e=>"completed"===e.status),o=r.filter(e=>"in_progress"===e.status),x=r.filter(e=>"pending"===e.status||"cancelled"===e.status),u=r.length>0?Math.round(c.length/r.length*100):0,g=c.map(e=>e.consistency_ratio).filter(e=>null!==e),v=g.length>0?g.reduce((e,t)=>e+t,0)/g.length:null;let h=(new Date).toLocaleDateString("ko-KR"),j=(new Date).toLocaleDateString("ko-KR");if("fulfilled"===a.status){const e=a.value.data;e.created_at&&(h=new Date(e.created_at).toLocaleDateString("ko-KR")),e.updated_at&&(j=new Date(e.updated_at).toLocaleDateString("ko-KR"))}w({totalCriteria:i,totalEvaluators:r.length||p,completedEvaluators:c.length,activeEvaluators:o.length,pendingEvaluators:x.length,completionRate:u,avgConsistencyRatio:v,createdDate:h,lastModified:j})}catch(a){w({totalCriteria:m,totalEvaluators:p,completedEvaluators:0,activeEvaluators:0,pendingEvaluators:p,completionRate:0,avgConsistencyRatio:null,createdDate:(new Date).toLocaleDateString("ko-KR"),lastModified:(new Date).toLocaleDateString("ko-KR")})}finally{S(!1)}},[d,m,p]);(0,s.useEffect)(()=>{L()},[L]);const M=async e=>{const t={status:e};"completed"===e&&(t.workflow_stage="completed");return await n.Ay.patch("/api/service/projects/projects/".concat(d,"/"),t)},z=[{id:"test",label:"\ud3c9\uac00 \ud14c\uc2a4\ud2b8",icon:"\ud83e\uddea",description:"\uc5f0\uad6c\uc790\uac00 \ud3c9\uac00 \ud654\uba74\uc744 \ubbf8\ub9ac \ud14c\uc2a4\ud2b8\ud574\ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4.",warning:"\ud14c\uc2a4\ud2b8 \ub370\uc774\ud130\ub294 \uc800\uc7a5\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",danger:!1},{id:"sendEmail",label:"\ud3c9\uac00 \uc694\uccad \ubc1c\uc1a1",icon:"\ud83d\udce7",description:"\ub300\uae30 \uc911\uc778 \ud3c9\uac00\uc790\uc5d0\uac8c \ud3c9\uac00 \uc694\uccad\uc744 \uc54c\ub9bd\ub2c8\ub2e4.",warning:"\ubc31\uc5d4\ub4dc SMTP \uc124\uc815 \ud6c4 \uc2e4\uc81c \uc774\uba54\uc77c \ubc1c\uc1a1\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4.",danger:!1},{id:"complete",label:"\ud504\ub85c\uc81d\ud2b8 \uc644\ub8cc",icon:"\u2705",description:"\ud504\ub85c\uc81d\ud2b8\ub97c \uc131\uacf5\uc801\uc73c\ub85c \uc644\ub8cc \ucc98\ub9ac\ud569\ub2c8\ub2e4.",warning:"\uc644\ub8cc\ub41c \ud504\ub85c\uc81d\ud2b8\ub294 \ub354 \uc774\uc0c1 \uc218\uc815\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",danger:!1},{id:"terminate",label:"\ud504\ub85c\uc81d\ud2b8 \uc911\ub2e8",icon:"\u23f9\ufe0f",description:"\ud504\ub85c\uc81d\ud2b8\ub97c \ubcf4\uad00(\uc911\ub2e8) \ucc98\ub9ac\ud569\ub2c8\ub2e4.",warning:"\uc911\ub2e8\ub41c \ud504\ub85c\uc81d\ud2b8\ub294 \ubcf4\uad00 \uc0c1\ud0dc\ub85c \uc804\ud658\ub429\ub2c8\ub2e4.",danger:!0},{id:"lock",label:"\uacb0\uacfc \uc7a0\uae08",icon:"\ud83d\udd12",description:"\ud604\uc7ac \uacb0\uacfc\ub97c \uc7a0\uae08 \ucc98\ub9ac\ud558\uc5ec \ubcc0\uacbd\uc744 \ubc29\uc9c0\ud569\ub2c8\ub2e4.",warning:"\uc7a0\uae08\ub41c \uacb0\uacfc\ub294 \uad00\ub9ac\uc790\ub9cc \ud574\uc81c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.",danger:!1},{id:"export",label:"\uacb0\uacfc \ub0b4\ubcf4\ub0b4\uae30 (CSV)",icon:"\ud83d\udce4",description:"\ud3c9\uac00\uc790 \ud604\ud669\uacfc \uacb0\uacfc\ub97c CSV \ud30c\uc77c\ub85c \ub0b4\ubcf4\ub0c5\ub2c8\ub2e4.",warning:"\ub0b4\ubcf4\ub0b4\uae30 \ud6c4\uc5d0\ub3c4 \ud504\ub85c\uc81d\ud2b8\ub294 \uacc4\uc18d \uc9c4\ud589\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.",danger:!1}];return A?(0,i.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,i.jsx)("div",{className:"text-gray-500",children:"\ud504\ub85c\uc81d\ud2b8 \uc815\ubcf4 \ub85c\ub529 \uc911..."})}):C?(0,i.jsxs)("div",{className:"max-w-4xl mx-auto",children:[E&&(0,i.jsx)("div",{className:"fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg max-w-sm ".concat("success"===E.type?"bg-green-100 text-green-800":"info"===E.type?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:E.text}),(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\ub2e8\uacc4 4 \u2014 \ud504\ub85c\uc81d\ud2b8 \uc911\ub2e8/\uc644\ub8cc"}),(0,i.jsxs)("p",{className:"text-gray-600",children:["\ud504\ub85c\uc81d\ud2b8: ",(0,i.jsx)("span",{className:"font-medium",children:o})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(r.A,{variant:"secondary",onClick:L,children:"\ud83d\udd04 \uc0c8\ub85c\uace0\uce68"}),(0,i.jsx)(r.A,{variant:"secondary",onClick:x,children:"\uc774\uc804 \ub2e8\uacc4\ub85c"})]})]})}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,i.jsx)(l.A,{title:"\ud83d\udccb \ud3c9\uac00 \uae30\uc900 \uad6c\uc870",children:0===_.length?(0,i.jsx)("div",{className:"text-gray-500 text-center py-4 text-sm",children:"\ud3c9\uac00 \uae30\uc900\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."}):(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["\ucd1d ",_.length,"\uac1c\uc758 \ud3c9\uac00 \uae30\uc900"]}),(0,i.jsx)("div",{className:"max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:_.map(e=>(0,i.jsxs)("div",{className:"py-1 text-sm",style:{paddingLeft:"".concat(16*(e.level-1),"px")},children:[(0,i.jsx)("span",{className:"text-gray-400 mr-1",children:1===e.level?"\ud83d\udcc1":2===e.level?"\ud83d\udcc2":"\ud83d\udcc4"}),(0,i.jsx)("span",{className:"font-medium",children:e.name}),e.description&&(0,i.jsxs)("span",{className:"ml-1 text-gray-500 text-xs",children:["(",e.description,")"]})]},e.id))})]})}),(0,i.jsx)(l.A,{title:"\ud83d\udc65 \ud3c9\uac00\uc790 \ud604\ud669",children:0===D.length?(0,i.jsx)("div",{className:"text-gray-500 text-center py-4 text-sm",children:"\ubc30\uc815\ub41c \ud3c9\uac00\uc790\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["\ucd1d ",D.length,"\uba85\uc758 \ud3c9\uac00\uc790"]}),(0,i.jsx)("div",{className:"max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2 space-y-1",children:D.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-2 hover:bg-gray-50 rounded",children:[(0,i.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.evaluator_name}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:["completed"===e.status&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"\uc644\ub8cc"}),null!==e.consistency_ratio&&(0,i.jsxs)("span",{className:"text-xs ".concat(e.is_consistent?"text-green-600":"text-red-600"),children:["CR=",e.consistency_ratio.toFixed(3)]})]}),"in_progress"===e.status&&(0,i.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full",children:["\uc9c4\ud589 ",Math.round(e.progress),"%"]}),("pending"===e.status||"cancelled"===e.status)&&(0,i.jsx)("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full",children:"\ub300\uae30"})]})]},e.id))})]})})]}),(0,i.jsxs)(l.A,{title:"\ud83d\udcca \ud504\ub85c\uc81d\ud2b8 \uc694\uc57d \ud604\ud669",children:[(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"\ud3c9\uac00 \uae30\uc900",value:C.totalCriteria,bg:"bg-blue-50 border-blue-200",text:"text-blue-900",sub:"text-blue-700"},{label:"\ucd1d \ud3c9\uac00\uc790",value:C.totalEvaluators,bg:"bg-purple-50 border-purple-200",text:"text-purple-900",sub:"text-purple-700"},{label:"\uc644\ub8cc",value:C.completedEvaluators,bg:"bg-green-50 border-green-200",text:"text-green-900",sub:"text-green-700"},{label:"\uc9c4\ud589\ub960",value:"".concat(C.completionRate,"%"),bg:"bg-orange-50 border-orange-200",text:"text-orange-900",sub:"text-orange-700"}].map(e=>{let{label:t,value:a,bg:s,text:l,sub:r}=e;return(0,i.jsxs)("div",{className:"text-center p-4 ".concat(s," border rounded-lg"),children:[(0,i.jsx)("div",{className:"text-2xl font-bold ".concat(l),children:a}),(0,i.jsx)("div",{className:"text-sm ".concat(r),children:t})]},t)})}),(0,i.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[(0,i.jsxs)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:[(0,i.jsx)("div",{className:"text-xl font-bold text-yellow-900",children:C.pendingEvaluators}),(0,i.jsx)("div",{className:"text-sm text-yellow-700",children:"\ub300\uae30 \uc911"})]}),(0,i.jsxs)("div",{className:"p-3 bg-indigo-50 border border-indigo-200 rounded-lg text-center",children:[(0,i.jsx)("div",{className:"text-xl font-bold text-indigo-900",children:C.activeEvaluators}),(0,i.jsx)("div",{className:"text-sm text-indigo-700",children:"\uc9c4\ud589 \uc911"})]}),(0,i.jsxs)("div",{className:"p-3 bg-teal-50 border border-teal-200 rounded-lg text-center",children:[(0,i.jsx)("div",{className:"text-xl font-bold text-teal-900",children:C.completedEvaluators}),(0,i.jsx)("div",{className:"text-sm text-teal-700",children:"\uc644\ub8cc"})]})]}),null!==C.avgConsistencyRatio&&(0,i.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[(0,i.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"\ud3c9\uade0 \uc77c\uad00\uc131 \ube44\uc728 (CR)"}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"text-2xl font-bold",children:C.avgConsistencyRatio.toFixed(3)}),C.avgConsistencyRatio<=.1?(0,i.jsx)("span",{className:"text-green-600 text-sm",children:"\u2705 \uc801\ud569 (CR \u2264 0.1)"}):(0,i.jsx)("span",{className:"text-red-600 text-sm",children:"\u26a0\ufe0f \uc7ac\uac80\ud1a0 \ud544\uc694 (CR > 0.1)"})]})]})]}),(0,i.jsx)(l.A,{title:"\ud83c\udfaf \uc791\uc5c5 \uc120\ud0dd",children:(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:z.map(e=>(0,i.jsx)("button",{onClick:()=>{v(e.id),j(!1)},className:"p-4 border-2 rounded-lg text-left transition-all hover:shadow-md ".concat(g===e.id?e.danger?"border-red-500 bg-red-50":"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,i.jsxs)("div",{className:"flex items-start gap-3",children:[(0,i.jsx)("span",{className:"text-2xl",children:e.icon}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h4",{className:"font-medium ".concat(e.danger?"text-red-800":"text-gray-900"),children:e.label}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),g===e.id&&(0,i.jsxs)("p",{className:"text-xs text-orange-600 mt-2",children:["\u26a0\ufe0f ",e.warning]})]})]})},e.id))})}),"sendEmail"===g&&(0,i.jsx)(l.A,{title:"\ud83d\udce7 \ud3c9\uac00 \uc694\uccad \ubc1c\uc1a1",children:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,i.jsxs)("h4",{className:"font-medium text-blue-900 mb-2",children:["\ub300\uae30 \uc911\uc778 \ud3c9\uac00\uc790 (",D.filter(e=>"pending"===e.status).length,"\uba85)"]}),0===D.filter(e=>"pending"===e.status).length?(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"\ubaa8\ub4e0 \ud3c9\uac00\uc790\uac00 \uc774\ubbf8 \ud3c9\uac00\ub97c \uc2dc\uc791\ud588\uc2b5\ub2c8\ub2e4."}):(0,i.jsx)("ul",{className:"text-sm text-blue-700 space-y-1",children:D.filter(e=>"pending"===e.status).map(e=>(0,i.jsxs)("li",{children:["\u2022 ",e.evaluator_name," (@",e.evaluator_username,")"]},e.id))})]}),(0,i.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm text-yellow-800",children:"\u26a0\ufe0f \uc2e4\uc81c \uc774\uba54\uc77c \ubc1c\uc1a1\uc740 \ubc31\uc5d4\ub4dc SMTP(SendGrid \ub4f1) \uc124\uc815 \ud6c4 \ud65c\uc131\ud654\ub429\ub2c8\ub2e4."})]})}),"export"===g&&(0,i.jsx)(l.A,{title:"\ud83d\udce4 \ub0b4\ubcf4\ub0b4\uae30 \uc124\uc815",children:(0,i.jsx)("div",{className:"space-y-3",children:[{value:"excel",label:"CSV \ud30c\uc77c",description:"\ud3c9\uac00\uc790 \ud604\ud669 \ubc0f CR \ud3ec\ud568 (\ub85c\uceec \uc0dd\uc131)"},{value:"pdf",label:"PDF \ubb38\uc11c",description:"\ucd94\ud6c4 \uc81c\uacf5 \uc608\uc815"},{value:"both",label:"CSV + PDF",description:"\ucd94\ud6c4 \uc81c\uacf5 \uc608\uc815"}].map(e=>(0,i.jsxs)("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[(0,i.jsx)("input",{type:"radio",value:e.value,checked:f===e.value,onChange:e=>N(e.target.value),className:"text-blue-600"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"font-medium text-sm",children:e.label}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})]},e.value))})}),g&&!h&&(0,i.jsx)("div",{className:"text-center",children:(0,i.jsxs)(r.A,{onClick:()=>j(!0),variant:"primary",size:"lg",children:[null===(t=z.find(e=>e.id===g))||void 0===t?void 0:t.label," \uc9c4\ud589"]})}),h&&(0,i.jsx)(l.A,{title:"\ud83d\udea8 \ucd5c\uc885 \ud655\uc778",children:(0,i.jsxs)("div",{className:"text-center space-y-4",children:[(0,i.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,i.jsxs)("h4",{className:"font-medium text-red-900 mb-1",children:[null===(a=z.find(e=>e.id===g))||void 0===a?void 0:a.label,"\uc744(\ub97c) \uc2e4\ud589\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"]}),(0,i.jsx)("p",{className:"text-sm text-red-700",children:null===(c=z.find(e=>e.id===g))||void 0===c?void 0:c.warning})]}),(0,i.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,i.jsx)(r.A,{onClick:async()=>{if(g){y(!0);try{switch(g){case"test":{const e="".concat(window.location.origin).concat("/ahp_app","/?project=").concat(d,"&test=true");window.open(e,"_blank"),P("info","\ud14c\uc2a4\ud2b8 \ubaa8\ub4dc\ub85c \ud3c9\uac00 \ud654\uba74\uc744 \uc5f4\uc5c8\uc2b5\ub2c8\ub2e4. \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130\ub294 \uc800\uc7a5\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");break}case"sendEmail":await(async()=>{const e=D.filter(e=>"pending"===e.status);0!==e.length?P("info","\uc774\uba54\uc77c \ubc1c\uc1a1 \uae30\ub2a5\uc740 \ubc31\uc5d4\ub4dc SMTP \uc124\uc815 \ud6c4 \uc0ac\uc6a9 \uac00\ub2a5\ud569\ub2c8\ub2e4. \ub300\uae30 \uc911\uc778 \ud3c9\uac00\uc790: ".concat(e.length,"\uba85")):P("info","\ub300\uae30 \uc911\uc778 \ud3c9\uac00\uc790\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \ubaa8\ub4e0 \ud3c9\uac00\uc790\uac00 \uc774\ubbf8 \ud3c9\uac00\ub97c \uc2dc\uc791\ud588\uc2b5\ub2c8\ub2e4.")})();break;case"terminate":await M("archived"),P("info","\ud504\ub85c\uc81d\ud2b8\uac00 \ubcf4\uad00(\uc911\ub2e8) \ucc98\ub9ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),u("terminated");break;case"complete":await M("completed"),P("success","\ud504\ub85c\uc81d\ud2b8\uac00 \uc644\ub8cc \ucc98\ub9ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),u("completed");break;case"lock":P("success","\uacb0\uacfc \uc7a0\uae08 \uae30\ub2a5\uc740 \ucd94\ud6c4 \uc81c\uacf5\ub420 \uc608\uc815\uc785\ub2c8\ub2e4.");break;case"export":await(async()=>{const e=[["\ud3c9\uac00\uc790","\uc0c1\ud0dc","\uc9c4\ud589\ub960","\uc77c\uad00\uc131\ube44\uc728","\uc77c\uad00\uc131\uc5ec\ubd80"],...D.map(e=>[e.evaluator_name,"completed"===e.status?"\uc644\ub8cc":"in_progress"===e.status?"\uc9c4\ud589\uc911":"\ub300\uae30","".concat(Math.round(e.progress),"%"),null!==e.consistency_ratio?e.consistency_ratio.toFixed(4):"-",!0===e.is_consistent?"\uc801\ud569":!1===e.is_consistent?"\ubd80\uc801\ud569":"-"])].map(e=>e.join(",")).join("\n"),t=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download="".concat(o,"_\ud3c9\uac00\uacb0\uacfc.csv"),s.click(),URL.revokeObjectURL(a),P("success","CSV \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc\uac00 \uc2dc\uc791\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")})()}}catch(i){var e,t,a,s,l,r,n;const c=i,d=null!==(e=null!==(t=null===c||void 0===c||null===(a=c.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.detail)&&void 0!==t?t:null===c||void 0===c||null===(l=c.response)||void 0===l||null===(r=l.data)||void 0===r||null===(n=r.status)||void 0===n?void 0:n[0])&&void 0!==e?e:"\uc791\uc5c5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.";P("error",d)}finally{y(!1),v(null),j(!1)}}},variant:"error",size:"lg",disabled:b,children:b?"\ucc98\ub9ac \uc911...":"\ud655\uc778\ud558\uace0 \uc2e4\ud589"}),(0,i.jsx)(r.A,{onClick:()=>j(!1),variant:"secondary",size:"lg",disabled:b,children:"\ucde8\uc18c"})]})]})}),(0,i.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,i.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"\ud83d\udccb \ud504\ub85c\uc81d\ud2b8 \uc815\ubcf4"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3",children:[(0,i.jsxs)("div",{children:["\uc0dd\uc131\uc77c: ",C.createdDate]}),(0,i.jsxs)("div",{children:["\ucd5c\uc885 \uc218\uc815: ",C.lastModified]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm border-t border-gray-300 pt-3",children:[(0,i.jsxs)("div",{className:"bg-white p-2 rounded text-center",children:[(0,i.jsx)("span",{className:"font-medium",children:"\uae30\uc900: "}),C.totalCriteria,"\uac1c"]}),(0,i.jsxs)("div",{className:"bg-white p-2 rounded text-center",children:[(0,i.jsx)("span",{className:"font-medium",children:"\ud3c9\uac00\uc790: "}),C.totalEvaluators,"\uba85"]}),(0,i.jsxs)("div",{className:"bg-white p-2 rounded text-center",children:[(0,i.jsx)("span",{className:"font-medium",children:"\uc644\ub8cc\uc728: "}),C.completionRate,"%"]})]})]})]})]}):(0,i.jsx)("div",{className:"text-center py-8 text-red-600",children:"\ud504\ub85c\uc81d\ud2b8 \uc815\ubcf4\ub97c \ub85c\ub4dc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."})}},9033(e,t,a){a.r(t),a.d(t,{default:()=>v});var s=a(2555),l=a(5043),r=a(3593),n=a(7907),i=a(8100),c=a(2497),d=a(6811),o=a(9405),x=a(1673),u=a(4604),m=a(3138),p=a(6291),g=a(579);const v=e=>{let{onComplete:t,onCancel:a}=e;const[v,h]=(0,l.useState)({currentStep:1,projectId:null,projectData:null,criteriaCount:0,alternativesCount:0,evaluatorsCount:0}),[j,b]=(0,l.useState)(!1),[y,f]=(0,l.useState)(null),[N,C]=(0,l.useState)(!1),w=["\ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131","\ud3c9\uac00 \uae30\uc900 \uc124\uc815","\ub300\uc548 \uc124\uc815","\ud3c9\uac00\uc790 \ubc30\uc815","\ud504\ub85c\uc81d\ud2b8 \uc644\ub8cc"],A=async e=>{try{var t;b(!0);const a=await m.A.createProject({title:e.title,description:null!==(t=e.description)&&void 0!==t?t:"",objective:e.objective,ahp_type:e.ahpType,status:"active",evaluation_mode:e.evaluationMode||"practical",workflow_stage:"creating"});a&&a.id&&h(e=>(0,s.A)((0,s.A)({},e),{},{currentStep:2,projectId:a.id||null,projectData:a}))}catch(y){f("\ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")}finally{b(!1)}},S=()=>{h(e=>(0,s.A)((0,s.A)({},e),{},{currentStep:3}))},_=()=>{h(e=>(0,s.A)((0,s.A)({},e),{},{currentStep:4}))},k=()=>{h(e=>(0,s.A)((0,s.A)({},e),{},{currentStep:5}))},D=async e=>{try{if(v.projectId){const s="completed"===e?"completed":"archived";await p.Ay.patch("/api/service/projects/projects/".concat(v.projectId,"/"),{status:s,workflow_stage:"completed"===e?"completed":"terminated"}),"completed"===e&&t?t():"terminated"===e&&a&&a()}}catch(y){f((y instanceof Error?y.message:"")||"\ud504\ub85c\uc81d\ud2b8 \uc0c1\ud0dc \ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},R=()=>{v.currentStep>1&&h(e=>(0,s.A)((0,s.A)({},e),{},{currentStep:e.currentStep-1}))},E=()=>{C(!0)};return(0,g.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,g.jsx)(i.A,{isOpen:N,onClose:()=>C(!1),title:"\ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131 \ucde8\uc18c",size:"sm",footer:(0,g.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,g.jsx)(n.A,{variant:"secondary",onClick:()=>C(!1),children:"\uacc4\uc18d \uc9c4\ud589"}),(0,g.jsx)(n.A,{variant:"error",onClick:async()=>{C(!1);try{v.projectId&&await m.A.deleteProject(v.projectId),a&&a()}catch(y){f((y instanceof Error?y.message:"")||"\ud504\ub85c\uc81d\ud2b8 \ucde8\uc18c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},children:"\ucde8\uc18c \ud655\uc778"})]}),children:(0,g.jsx)("p",{className:"text-sm text-gray-600",children:"\ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131\uc744 \ucde8\uc18c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc785\ub825\ud55c \ubaa8\ub4e0 \ub370\uc774\ud130\uac00 \uc0ad\uc81c\ub429\ub2c8\ub2e4."})}),(0,g.jsxs)("div",{className:"mb-6",children:[(0,g.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"AHP \ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131 \uc6cc\ud06c\ud50c\ub85c\uc6b0"}),(0,g.jsx)("p",{className:"text-gray-600 mt-2",children:"\ub2e8\uacc4\ubcc4\ub85c \ud504\ub85c\uc81d\ud2b8\ub97c \uad6c\uc131\ud558\uace0 \ud3c9\uac00\ub97c \uc900\ube44\ud569\ub2c8\ub2e4."})]}),(0,g.jsx)("div",{className:"mb-8",children:(0,g.jsx)("div",{className:"flex items-center justify-between mb-4",children:w.map((e,t)=>{const a=t+1,s=v.currentStep===a,l=v.currentStep>a;return(0,g.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,g.jsxs)("div",{className:"flex flex-col items-center flex-1",children:[(0,g.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold transition-colors ".concat(s?"bg-blue-500 text-white":l?"bg-green-500 text-white":"bg-gray-200 text-gray-500"),children:l?"\u2713":a}),(0,g.jsx)("span",{className:"mt-2 text-xs ".concat(s?"text-blue-600 font-semibold":l?"text-green-600":"text-gray-500"),children:e})]}),t<w.length-1&&(0,g.jsx)("div",{className:"h-1 flex-1 mx-2 ".concat(v.currentStep>a?"bg-green-500":"bg-gray-200")})]},a)})})}),v.projectData&&(0,g.jsx)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("h3",{className:"font-semibold text-blue-900",children:["\ud504\ub85c\uc81d\ud2b8: ",v.projectData.title]}),(0,g.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["ID: ",v.projectId," | \uae30\uc900: ",v.criteriaCount,"\uac1c | \ub300\uc548: ",v.alternativesCount,"\uac1c | \ud3c9\uac00\uc790: ",v.evaluatorsCount,"\uba85"]})]}),v.currentStep>1&&v.currentStep<5&&(0,g.jsx)(n.A,{variant:"outline",size:"sm",onClick:R,children:"\u2190 \uc774\uc804 \ub2e8\uacc4"})]})}),(()=>{var e;if(y)return(0,g.jsx)(r.A,{children:(0,g.jsxs)("div",{className:"text-center py-8",children:[(0,g.jsx)("div",{className:"text-red-600 mb-4",children:y}),(0,g.jsx)(n.A,{onClick:()=>f(null),variant:"primary",children:"\ub2e4\uc2dc \uc2dc\ub3c4"})]})});switch(v.currentStep){case 1:return(0,g.jsx)(c.A,{onProjectCreated:()=>{},onCancel:E,loading:j,createProject:A});case 2:return v.projectId?(0,g.jsx)(d.A,{projectId:v.projectId,projectTitle:null===(e=v.projectData)||void 0===e?void 0:e.title,onComplete:S,onCriteriaChange:e=>h(t=>(0,s.A)((0,s.A)({},t),{},{criteriaCount:e}))}):null;case 3:return v.projectId?(0,g.jsx)(o.A,{projectId:v.projectId,onComplete:_,onAlternativesChange:e=>h(t=>(0,s.A)((0,s.A)({},t),{},{alternativesCount:e}))}):null;case 4:return v.projectId?(0,g.jsx)(x.A,{projectId:v.projectId,onComplete:k,onEvaluatorsChange:e=>h(t=>(0,s.A)((0,s.A)({},t),{},{evaluatorsCount:e}))}):null;case 5:return v.projectId&&v.projectData?(0,g.jsx)(u.default,{projectId:v.projectId,projectTitle:v.projectData.title,onBack:R,onProjectStatusChange:D,criteriaCount:v.criteriaCount,alternativesCount:v.alternativesCount,evaluatorsCount:v.evaluatorsCount}):null;default:return null}})(),!1]})}}}]);
//# sourceMappingURL=33.059ae416.chunk.js.map