{"version":3,"file":"static/js/319.23a58eb6.chunk.js","mappings":"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","sources":["components/admin/EvaluatorAssignment.tsx","components/common/HierarchyTreeVisualization.tsx","utils/textParser.ts","components/criteria/BulkCriteriaInput.tsx","components/criteria/CriteriaTemplates.tsx","components/criteria/VisualCriteriaBuilder.tsx","components/admin/CriteriaManagement.tsx","components/admin/AlternativeManagement.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport Input from '../common/Input';\r\nimport Modal from '../common/Modal';\r\nimport cleanDataService from '../../services/dataService_clean';\r\nimport { EvaluatorData } from '../../services/api';\r\nimport { QRCodeSVG as QRCode } from 'qrcode.react';\r\n\r\ninterface Evaluator {\r\n  id?: string;\r\n  project_id: string;\r\n  name: string;\r\n  email: string;\r\n  access_key?: string;\r\n  status: 'pending' | 'active' | 'completed';\r\n  inviteLink?: string;\r\n  progress?: number;\r\n  department?: string;\r\n  experience?: string;\r\n  code?: string;\r\n  showQR?: boolean;\r\n  completedAt?: string;\r\n  totalComparisons?: number;\r\n  completedComparisons?: number;\r\n  demographicSurveyUrl?: string;\r\n  demographicSurveyCompleted?: boolean;\r\n  qrCodeData?: string;\r\n}\r\n\r\ninterface EvaluatorAssignmentProps {\r\n  projectId: string;\r\n  onComplete: () => void;\r\n  onEvaluatorsChange?: (count: number) => void;\r\n  maxEvaluators?: number; //    \r\n  currentPlan?: string; //  \r\n}\r\n\r\nconst EvaluatorAssignment: React.FC<EvaluatorAssignmentProps> = ({ \r\n  projectId, \r\n  onComplete,\r\n  onEvaluatorsChange,\r\n  maxEvaluators = 50, // : Standard Plan\r\n  currentPlan = 'Standard Plan'\r\n}) => {\r\n  const [evaluators, setEvaluators] = useState<Evaluator[]>([]);\r\n  const [pendingDeleteId, setPendingDeleteId] = useState<string | null>(null);\r\n  const [actionMessage, setActionMessage] = useState<{type:'success'|'error'|'info', text:string}|null>(null);\r\n\r\n  const showActionMessage = (type: 'success'|'error'|'info', text: string) => {\r\n    setActionMessage({type, text});\r\n    setTimeout(() => setActionMessage(null), 3000);\r\n  };\r\n  const [evaluationStats, setEvaluationStats] = useState<{\r\n    total: number;\r\n    pending: number;\r\n    active: number;\r\n    completed: number;\r\n  }>({ total: 0, pending: 0, active: 0, completed: 0 });\r\n\r\n  useEffect(() => {\r\n    //  DB   \r\n    const loadProjectEvaluators = async () => {\r\n      const base = window.location.href.split('?')[0].replace(/\\/$/, '');\r\n      try {\r\n        const evaluatorsData = await cleanDataService.getEvaluators(projectId);\r\n\r\n        // EvaluatorData Evaluator  \r\n        const convertedEvaluators: Evaluator[] = evaluatorsData.map((evaluator: EvaluatorData) => {\r\n          const evalLink = evaluator.access_key\r\n            ? `${base}/?project=${projectId}&key=${evaluator.access_key}`\r\n            : undefined;\r\n\r\n          return {\r\n            id: evaluator.id,\r\n            project_id: evaluator.project_id,\r\n            name: evaluator.name,\r\n            email: evaluator.email,\r\n            access_key: evaluator.access_key,\r\n            status: evaluator.status,\r\n            progress: 0,\r\n            code: evaluator.access_key || `EVL${String(Math.floor(Math.random() * 999) + 1).padStart(3, '0')}`,\r\n            inviteLink: evalLink,\r\n            demographicSurveyCompleted: false\r\n          };\r\n        });\r\n\r\n        setEvaluators(convertedEvaluators);\r\n\r\n        //  \r\n        updateEvaluationStats(convertedEvaluators);\r\n\r\n        //     \r\n        if (onEvaluatorsChange) {\r\n          onEvaluatorsChange(convertedEvaluators.length);\r\n        }\r\n      } catch (error) {\r\n        setEvaluators([]);\r\n        if (onEvaluatorsChange) {\r\n          onEvaluatorsChange(0);\r\n        }\r\n      }\r\n    };\r\n\r\n    if (projectId) {\r\n      loadProjectEvaluators();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [projectId]);\r\n\r\n  const [newEvaluator, setNewEvaluator] = useState({ name: '', email: '' });\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n\r\n  const generateAccessKey = (): string => {\r\n    const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\r\n    const array = new Uint8Array(8);\r\n    crypto.getRandomValues(array);\r\n    const key = Array.from(array, byte => charset[byte % 36]).join('');\r\n    return 'KEY_' + key;\r\n  };\r\n\r\n  const updateEvaluationStats = (evaluatorList: Evaluator[]) => {\r\n    const stats = {\r\n      total: evaluatorList.length,\r\n      pending: evaluatorList.filter(e => e.status === 'pending').length,\r\n      active: evaluatorList.filter(e => e.status === 'active').length,\r\n      completed: evaluatorList.filter(e => e.status === 'completed').length\r\n    };\r\n    setEvaluationStats(stats);\r\n    \r\n    //     \r\n    if (onEvaluatorsChange) {\r\n      onEvaluatorsChange(evaluatorList.length);\r\n    }\r\n  };\r\n\r\n  const toggleQRCode = (evaluatorId: string) => {\r\n    setEvaluators(prev => prev.map(e => \r\n      e.id === evaluatorId ? { ...e, showQR: !e.showQR } : e\r\n    ));\r\n  };\r\n\r\n  const validateEvaluator = (evaluator: { name: string; email: string }): boolean => {\r\n    const newErrors: Record<string, string> = {};\r\n\r\n    if (!evaluator.name.trim()) {\r\n      newErrors.name = '  .';\r\n    } else if (evaluator.name.length < 2) {\r\n      newErrors.name = ' 2  .';\r\n    }\r\n\r\n    if (!evaluator.email.trim()) {\r\n      newErrors.email = ' .';\r\n    } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(evaluator.email)) {\r\n      newErrors.email = '   .';\r\n    } else if (evaluators.some(e => e.email === evaluator.email)) {\r\n      newErrors.email = '  .';\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleAddEvaluator = async () => {\r\n    //    \r\n    if (evaluators.length >= maxEvaluators) {\r\n      showActionMessage('error', `  (${maxEvaluators}) . ${currentPlan}   ${maxEvaluators}   .`);\r\n      return;\r\n    }\r\n\r\n    if (!validateEvaluator(newEvaluator)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const evaluatorData: Omit<EvaluatorData, 'id'> = {\r\n        project_id: projectId,\r\n        name: newEvaluator.name,\r\n        email: newEvaluator.email,\r\n        access_key: generateAccessKey(),\r\n        status: 'pending'\r\n      };\r\n\r\n      const createdEvaluator = await cleanDataService.createEvaluator(evaluatorData);\r\n\r\n      if (createdEvaluator) {\r\n        const base = window.location.href.split('?')[0].replace(/\\/$/, '');\r\n        const evalLink = `${base}/?project=${projectId}&key=${createdEvaluator.access_key}`;\r\n\r\n        const newEval: Evaluator = {\r\n          id: createdEvaluator.id,\r\n          project_id: createdEvaluator.project_id,\r\n          name: createdEvaluator.name,\r\n          email: createdEvaluator.email,\r\n          access_key: createdEvaluator.access_key,\r\n          status: createdEvaluator.status,\r\n          progress: 0,\r\n          code: createdEvaluator.access_key,\r\n          inviteLink: evalLink,\r\n          demographicSurveyCompleted: false\r\n        };\r\n\r\n        const updatedEvaluators = [...evaluators, newEval];\r\n        setEvaluators(updatedEvaluators);\r\n        setNewEvaluator({ name: '', email: '' });\r\n        setErrors({});\r\n\r\n        if (onEvaluatorsChange) {\r\n          onEvaluatorsChange(updatedEvaluators.length);\r\n        }\r\n      } else {\r\n        setErrors({ general: '  .' });\r\n      }\r\n    } catch (error) {\r\n      setErrors({ general: error instanceof Error ? error.message : '    .' });\r\n    }\r\n  };\r\n\r\n  const handleSendInvite = async (id: string) => {\r\n    //      (   API )\r\n    const updatedEvaluators = evaluators.map(evaluator => \r\n      evaluator.id === id \r\n        ? { ...evaluator, status: 'active' as const }\r\n        : evaluator\r\n    );\r\n    setEvaluators(updatedEvaluators);\r\n  };\r\n\r\n  const handleDeleteEvaluator = (id: string) => {\r\n    setPendingDeleteId(id);\r\n  };\r\n\r\n  const handleConfirmDeleteEvaluator = async () => {\r\n    if (!pendingDeleteId) return;\r\n    const id = pendingDeleteId;\r\n    setPendingDeleteId(null);\r\n\r\n    try {\r\n      await cleanDataService.deleteEvaluator(id, projectId);\r\n\r\n      const updatedEvaluators = evaluators.filter(e => e.id !== id);\r\n      setEvaluators(updatedEvaluators);\r\n\r\n      if (onEvaluatorsChange) {\r\n        onEvaluatorsChange(updatedEvaluators.length);\r\n      }\r\n    } catch (error) {\r\n      showActionMessage('error', '    .');\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: Evaluator['status']) => {\r\n    const styles = {\r\n      pending: 'bg-gray-100 text-gray-800',\r\n      active: 'bg-green-100 text-green-800',\r\n      completed: 'bg-purple-100 text-purple-800'\r\n    };\r\n\r\n    const labels = {\r\n      pending: '',\r\n      active: '',\r\n      completed: ''\r\n    };\r\n\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-medium ${styles[status]}`}>\r\n        {labels[status]}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const getProgressBadge = (progress: number) => {\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-medium ${\r\n        progress === 0 ? 'bg-gray-100 text-gray-800' :\r\n        progress < 50 ? 'bg-red-100 text-red-800' :\r\n        progress < 100 ? 'bg-yellow-100 text-yellow-800' :\r\n        'bg-green-100 text-green-800'\r\n      }`}>\r\n        {progress}%\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {actionMessage && (\r\n        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg ${actionMessage.type === 'success' ? 'bg-green-100 text-green-800' : actionMessage.type === 'info' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`}>\r\n          {actionMessage.text}\r\n        </div>\r\n      )}\r\n\r\n      <Modal\r\n        isOpen={pendingDeleteId !== null}\r\n        onClose={() => setPendingDeleteId(null)}\r\n        title=\" \"\r\n        size=\"sm\"\r\n        footer={\r\n          <div className=\"flex justify-end space-x-3\">\r\n            <Button variant=\"secondary\" onClick={() => setPendingDeleteId(null)}>\r\n              \r\n            </Button>\r\n            <Button variant=\"error\" onClick={handleConfirmDeleteEvaluator}>\r\n              \r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <p className=\"text-sm text-gray-600\">   ?</p>\r\n      </Modal>\r\n\r\n      <Card title=\" \">\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-purple-50 border border-purple-200 rounded-lg p-4\">\r\n            <h4 className=\"font-medium text-purple-900 mb-2\">   </h4>\r\n            <ul className=\"text-sm text-purple-700 space-y-1\">\r\n              <li>       </li>\r\n              <li> QR       </li>\r\n              <li>      </li>\r\n              <li>        </li>\r\n              <li>      </li>\r\n            </ul>\r\n          </div>\r\n\r\n          {/*     */}\r\n          <div className=\"grid grid-cols-4 gap-4\">\r\n            <div className=\"bg-white border rounded-lg p-3\">\r\n              <div className=\"text-2xl font-bold text-gray-900\">{evaluationStats.total}</div>\r\n              <div className=\"text-sm text-gray-500\"> </div>\r\n            </div>\r\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\r\n              <div className=\"text-2xl font-bold text-yellow-800\">{evaluationStats.pending}</div>\r\n              <div className=\"text-sm text-yellow-700\"></div>\r\n            </div>\r\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\r\n              <div className=\"text-2xl font-bold text-blue-800\">{evaluationStats.active}</div>\r\n              <div className=\"text-sm text-blue-700\"></div>\r\n            </div>\r\n            <div className=\"bg-green-50 border border-green-200 rounded-lg p-3\">\r\n              <div className=\"text-2xl font-bold text-green-800\">{evaluationStats.completed}</div>\r\n              <div className=\"text-sm text-green-700\"></div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Current Evaluators List */}\r\n          <div>\r\n            <h4 className=\"font-medium text-gray-900 mb-4\">   </h4>\r\n\r\n            {evaluators.length === 0 ? (\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                   .\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                {evaluators.map((evaluator) => (\r\n                  <div\r\n                    key={evaluator.id}\r\n                    className=\"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white hover:bg-gray-50\"\r\n                  >\r\n                    <div className=\"flex items-center flex-1\">\r\n                      <div className=\"flex items-center justify-center w-12 h-12 bg-blue-100 text-blue-800 rounded-full text-sm font-medium mr-4\">\r\n                        {evaluator.code || evaluator.access_key?.substring(0, 3) || 'EVL'}\r\n                      </div>\r\n                      \r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <h5 className=\"font-medium text-gray-900\">{evaluator.name}</h5>\r\n                          {getStatusBadge(evaluator.status)}\r\n                          {getProgressBadge(evaluator.progress || 0)}\r\n                        </div>\r\n                        {evaluator.email && (\r\n                          <p className=\"text-sm text-gray-600 mt-1\">{evaluator.email}</p>\r\n                        )}\r\n                        {(evaluator.department || evaluator.experience) && (\r\n                          <div className=\"flex items-center space-x-4 mt-1\">\r\n                            {evaluator.department && (\r\n                              <span className=\"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded\">\r\n                                {evaluator.department}\r\n                              </span>\r\n                            )}\r\n                            {evaluator.experience && (\r\n                              <span className=\"text-xs bg-green-50 text-green-700 px-2 py-1 rounded\">\r\n                                 {evaluator.experience}\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                        {evaluator.inviteLink && (\r\n                          <div className=\"mt-2 space-y-1\">\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <span className=\"text-xs text-gray-500\"> :</span>\r\n                              <code className=\"text-xs bg-green-50 text-green-700 px-2 py-1 rounded border border-green-200\">\r\n                                {evaluator.inviteLink}\r\n                              </code>\r\n                            </div>\r\n                            {evaluator.demographicSurveyUrl && (\r\n                              <div className=\"flex items-center space-x-2\">\r\n                                <span className=\"text-xs text-gray-500\">:</span>\r\n                                <code className=\"text-xs bg-yellow-50 text-yellow-700 px-2 py-1 rounded border border-yellow-200\">\r\n                                  {evaluator.demographicSurveyUrl}\r\n                                </code>\r\n                              </div>\r\n                            )}\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <button\r\n                                onClick={() => window.open(evaluator.inviteLink, '_blank')}\r\n                                className=\"text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition-colors\"\r\n                              >\r\n                                  \r\n                              </button>\r\n                              <button\r\n                                onClick={() => navigator.clipboard.writeText(evaluator.inviteLink || '')}\r\n                                className=\"text-xs bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors\"\r\n                              >\r\n                                  \r\n                              </button>\r\n                              <button\r\n                                onClick={() => toggleQRCode(evaluator.id ?? '')}\r\n                                className=\"text-xs bg-purple-500 text-white px-3 py-1 rounded hover:bg-purple-600 transition-colors\"\r\n                              >\r\n                                {evaluator.showQR ? ' QR ' : ' QR '}\r\n                              </button>\r\n                            </div>\r\n                            {evaluator.showQR && evaluator.inviteLink && (\r\n                              <div className=\"mt-3 p-3 bg-gray-50 rounded-lg\">\r\n                                <div className=\"text-center\">\r\n                                  <h5 className=\"text-sm font-medium text-gray-700 mb-2\">  QR </h5>\r\n                                  <div className=\"inline-block p-2 bg-white rounded border border-gray-200\">\r\n                                    <QRCode \r\n                                      value={JSON.stringify({\r\n                                        evaluationUrl: evaluator.inviteLink,\r\n                                        surveyUrl: evaluator.demographicSurveyUrl,\r\n                                        projectId: projectId,\r\n                                        evaluatorId: evaluator.id,\r\n                                        accessKey: evaluator.access_key\r\n                                      })} \r\n                                      size={200}\r\n                                      level=\"M\"\r\n                                      includeMargin={true}\r\n                                    />\r\n                                  </div>\r\n                                  <p className=\"text-xs text-gray-500 mt-2\">\r\n                                    QR      \r\n                                  </p>\r\n                                  <div className=\"mt-2 space-y-1\">\r\n                                    <p className=\"text-xs text-blue-600\">1.  </p>\r\n                                    <p className=\"text-xs text-green-600\">2. AHP  </p>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center space-x-2 ml-4\">\r\n                      {evaluator.status === 'pending' && (\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"primary\"\r\n                          onClick={() => handleSendInvite(evaluator.id ?? '')}\r\n                        >\r\n                            \r\n                        </Button>\r\n                      )}\r\n                      <button\r\n                        onClick={() => handleDeleteEvaluator(evaluator.id ?? '')}\r\n                        className=\"text-red-500 hover:text-red-700 text-sm\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Add New Evaluator */}\r\n          <div className=\"border-t pt-6\">\r\n            <h4 className=\"font-medium text-gray-900 mb-4\">   </h4>\r\n            \r\n            {/*    */}\r\n            {errors.general && (\r\n              <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\r\n                <div className=\"flex items-center\">\r\n                  <span className=\"text-red-600 mr-2\"></span>\r\n                  <span className=\"text-red-800 text-sm\">{errors.general}</span>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n              <Input\r\n                id=\"evaluatorName\"\r\n                label=\" \"\r\n                placeholder=\" \"\r\n                value={newEvaluator.name}\r\n                onChange={(value) => setNewEvaluator(prev => ({ ...prev, name: value }))}\r\n                error={errors.name}\r\n                required\r\n              />\r\n\r\n              <Input\r\n                id=\"evaluatorEmail\"\r\n                label=\"\"\r\n                placeholder=\"email@example.com\"\r\n                value={newEvaluator.email}\r\n                onChange={(value) => setNewEvaluator(prev => ({ ...prev, email: value }))}\r\n                error={errors.email}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex justify-end\">\r\n              <Button onClick={handleAddEvaluator} variant=\"primary\">\r\n                 \r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Summary */}\r\n          <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\r\n              <div>\r\n                <div className=\"text-2xl font-bold text-gray-900\">{evaluators.length}</div>\r\n                <div className=\"text-sm text-gray-600\"> </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-2xl font-bold text-blue-600\">\r\n                  {evaluators.filter(e => e.status === 'pending').length}\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\"></div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-2xl font-bold text-green-600\">\r\n                  {evaluators.filter(e => e.status === 'active').length}\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\"> </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-2xl font-bold text-purple-600\">\r\n                  {evaluators.filter(e => e.status === 'completed').length}\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\"> </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex justify-between items-center pt-6 border-t\">\r\n            <div className=\"text-sm text-gray-600\">\r\n              {evaluators.length === 0 && (\r\n                <span className=\"text-blue-600\">       .</span>\r\n              )}\r\n            </div>\r\n            <div className=\"flex space-x-3\">\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => showActionMessage('success', '  .')}\r\n              >\r\n                \r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={onComplete}\r\n              >\r\n                 \r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EvaluatorAssignment;","import React, { useState } from 'react';\r\nimport Modal from './Modal';\r\n\r\ninterface TreeNode {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  children?: TreeNode[];\r\n  weight?: number;\r\n  parent_id?: string | null;\r\n}\r\n\r\ninterface HierarchyTreeVisualizationProps {\r\n  nodes: TreeNode[];\r\n  title?: string;\r\n  showWeights?: boolean;\r\n  interactive?: boolean;\r\n  onNodeClick?: (node: TreeNode) => void;\r\n  onNodeDelete?: (node: TreeNode) => void;\r\n  layout?: 'vertical' | 'horizontal';\r\n  onLayoutChange?: (layout: 'vertical' | 'horizontal') => void;\r\n  allowDelete?: boolean;\r\n}\r\n\r\nconst HierarchyTreeVisualization: React.FC<HierarchyTreeVisualizationProps> = ({\r\n  nodes,\r\n  title = \"\",\r\n  showWeights = false,\r\n  interactive = false,\r\n  onNodeClick,\r\n  onNodeDelete,\r\n  layout = 'vertical',\r\n  onLayoutChange,\r\n  allowDelete = false\r\n}) => {\r\n  const [pendingDeleteNode, setPendingDeleteNode] = useState<TreeNode | null>(null);\r\n\r\n  //   \r\n  const buildHierarchy = (flatNodes: TreeNode[]): TreeNode[] => {\r\n    const nodeMap = new Map<string, TreeNode>();\r\n    const rootNodes: TreeNode[] = [];\r\n\r\n    //     \r\n    flatNodes.forEach(node => {\r\n      nodeMap.set(node.id, { ...node, children: [] });\r\n    });\r\n\r\n    // -  \r\n    flatNodes.forEach(node => {\r\n      const nodeWithChildren = nodeMap.get(node.id);\r\n      if (!nodeWithChildren) return;\r\n      if (node.parent_id && nodeMap.has(node.parent_id)) {\r\n        const parent = nodeMap.get(node.parent_id);\r\n        if (!parent) return;\r\n        if (!parent.children) parent.children = [];\r\n        parent.children.push(nodeWithChildren);\r\n      } else {\r\n        rootNodes.push(nodeWithChildren);\r\n      }\r\n    });\r\n\r\n    return rootNodes;\r\n  };\r\n\r\n  const hierarchy = buildHierarchy(nodes);\r\n\r\n  const getNodeIcon = (node: TreeNode) => {\r\n    switch (node.level) {\r\n      case 1: return ''; // (Goal)\r\n      case 2: return ''; // (Criteria)\r\n      case 3: return ''; // (Alternatives)\r\n      case 4: return ''; // (Sub-criteria)\r\n      case 5: return ''; // (Detailed criteria)\r\n      default: return '';\r\n    }\r\n  };\r\n\r\n  const getNodeColor = (level: number) => {\r\n    switch (level) {\r\n      case 1: return 'bg-blue-100 border-blue-300 text-blue-800';\r\n      case 2: return 'bg-green-100 border-green-300 text-green-800';\r\n      case 3: return 'bg-purple-100 border-purple-300 text-purple-800';\r\n      case 4: return 'bg-yellow-100 border-yellow-300 text-yellow-800';\r\n      case 5: return 'bg-pink-100 border-pink-300 text-pink-800';\r\n      default: return 'bg-gray-100 border-gray-300 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const renderVerticalNode = (node: TreeNode, index: number, isLast: boolean[] = []): React.ReactNode => {\r\n    const hasChildren = node.children && node.children.length > 0;\r\n    const isClickable = interactive && onNodeClick;\r\n\r\n    return (\r\n      <div key={node.id} className=\"relative\">\r\n        {/*   */}\r\n        {node.level > 1 && (\r\n          <>\r\n            {/*  */}\r\n            <div \r\n              className=\"absolute w-px bg-gray-300 -left-6 top-0\"\r\n              style={{ height: '24px' }}\r\n            />\r\n            {/*  */}\r\n            <div \r\n              className=\"absolute h-px bg-gray-300 -left-6 top-6\"\r\n              style={{ width: '24px' }}\r\n            />\r\n          </>\r\n        )}\r\n\r\n        {/*   */}\r\n        <div \r\n          className={`\r\n            mb-3 p-3 rounded-lg border-2 transition-all duration-200 \r\n            ${getNodeColor(node.level)}\r\n            ${isClickable ? 'cursor-pointer hover:shadow-md hover:scale-105' : ''}\r\n            ${hasChildren ? 'font-medium' : ''}\r\n          `}\r\n          onClick={() => isClickable && onNodeClick!(node)}\r\n          style={{ marginLeft: `${(node.level - 1) * 32}px` }}\r\n        >\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\">{getNodeIcon(node)}</span>\r\n            <div className=\"flex-1\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <div className=\"font-medium\">{node.name}</div>\r\n                  {node.description && (\r\n                    <div className=\"text-xs opacity-75 mt-1\">{node.description}</div>\r\n                  )}\r\n                </div>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  {showWeights && node.weight && (\r\n                    <div className=\"text-xs font-mono bg-white bg-opacity-50 px-2 py-1 rounded\">\r\n                      {(node.weight * 100).toFixed(1)}%\r\n                    </div>\r\n                  )}\r\n                  {allowDelete && onNodeDelete && (\r\n                    <button\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setPendingDeleteNode(node);\r\n                      }}\r\n                      className=\"p-1 text-red-500 hover:text-red-700 hover:bg-red-100 rounded-md transition-colors duration-200\"\r\n                      title={`${node.name} `}\r\n                    >\r\n                      <span className=\"text-sm\"></span>\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {hasChildren && (\r\n              <span className=\"text-xs text-gray-600\">\r\n                ({node.children?.length ?? 0} )\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*    */}\r\n        {hasChildren && (\r\n          <div className=\"relative\">\r\n            {node.children?.map((child, childIndex) => {\r\n              const childIsLast = [...isLast, childIndex === (node.children?.length ?? 0) - 1];\r\n              return renderVerticalNode(child, childIndex, childIsLast);\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderHorizontalNode = (node: TreeNode): React.ReactNode => {\r\n    const hasChildren = node.children && node.children.length > 0;\r\n    const isClickable = interactive && onNodeClick;\r\n\r\n    return (\r\n      <div key={node.id} className=\"flex flex-col items-center\">\r\n        {/*   */}\r\n        <div \r\n          className={`\r\n            relative p-3 rounded-lg border-2 transition-all duration-200 min-w-[120px] text-center\r\n            ${getNodeColor(node.level)}\r\n            ${isClickable ? 'cursor-pointer hover:shadow-md hover:scale-105' : ''}\r\n            ${hasChildren ? 'font-medium' : ''}\r\n          `}\r\n          onClick={() => isClickable && onNodeClick!(node)}\r\n        >\r\n          {allowDelete && onNodeDelete && (\r\n            <button\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setPendingDeleteNode(node);\r\n              }}\r\n              className=\"absolute top-1 right-1 p-1 text-red-500 hover:text-red-700 hover:bg-red-100 rounded-md transition-colors duration-200\"\r\n              title={`${node.name} `}\r\n            >\r\n              <span className=\"text-xs\"></span>\r\n            </button>\r\n          )}\r\n          \r\n          <div className=\"flex flex-col items-center space-y-1\">\r\n            <span className=\"text-lg\">{getNodeIcon(node)}</span>\r\n            <div className=\"font-medium text-sm\">{node.name}</div>\r\n            {node.description && (\r\n              <div className=\"text-xs opacity-75\">{node.description}</div>\r\n            )}\r\n            {showWeights && node.weight && (\r\n              <div className=\"text-xs font-mono bg-white bg-opacity-50 px-2 py-1 rounded\">\r\n                {(node.weight * 100).toFixed(1)}%\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*    */}\r\n        {hasChildren && (\r\n          <div className=\"relative mt-8\">\r\n            {/*    */}\r\n            <div className=\"absolute top-0 left-1/2 transform -translate-x-1/2\">\r\n              {/*   */}\r\n              <div className=\"w-px h-4 bg-gray-300 -mt-8\"></div>\r\n            </div>\r\n            \r\n            {/*        */}\r\n            {(node.children?.length ?? 0) > 1 && (\r\n              <div className=\"absolute top-0 left-0 right-0 flex justify-center -mt-4\">\r\n                <div\r\n                  className=\"h-px bg-gray-300\"\r\n                  style={{\r\n                    width: `${((node.children?.length ?? 0) - 1) * 150}px`,\r\n                    marginLeft: '75px',\r\n                    marginRight: '75px'\r\n                  }}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/*      */}\r\n            <div className=\"flex space-x-6 justify-center\">\r\n              {node.children?.map((child, index) => (\r\n                <div key={child.id} className=\"relative\">\r\n                  {/*      */}\r\n                  {(node.children?.length ?? 0) > 1 && (\r\n                    <div className=\"absolute top-0 left-1/2 transform -translate-x-1/2 w-px h-4 bg-gray-300 -mt-4\"></div>\r\n                  )}\r\n                  {renderHorizontalNode(child)}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const deleteModal = (\r\n    <Modal\r\n      isOpen={pendingDeleteNode !== null}\r\n      onClose={() => setPendingDeleteNode(null)}\r\n      title=\"  \"\r\n      size=\"sm\"\r\n      footer={\r\n        <div className=\"flex justify-end space-x-3\">\r\n          <button\r\n            onClick={() => setPendingDeleteNode(null)}\r\n            className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\"\r\n          >\r\n            \r\n          </button>\r\n          <button\r\n            onClick={() => {\r\n              if (pendingDeleteNode && onNodeDelete) {\r\n                onNodeDelete(pendingDeleteNode);\r\n              }\r\n              setPendingDeleteNode(null);\r\n            }}\r\n            className=\"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700\"\r\n          >\r\n            \r\n          </button>\r\n        </div>\r\n      }\r\n    >\r\n      <p className=\"text-sm text-gray-600\">\r\n        \"{pendingDeleteNode?.name}\"  ?\r\n      </p>\r\n      <p className=\"text-sm text-red-600 mt-2\">\r\n            .\r\n      </p>\r\n    </Modal>\r\n  );\r\n\r\n  if (hierarchy.length === 0) {\r\n    return (\r\n      <>\r\n        <div className=\"text-center py-12 text-gray-500\">\r\n          <div className=\"text-4xl mb-4\"></div>\r\n          <p className=\"text-lg\"> </p>\r\n          <p className=\"text-sm\">   </p>\r\n        </div>\r\n        {deleteModal}\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center\">\r\n          <span className=\"text-2xl mr-2\"></span>\r\n          {title}\r\n        </h3>\r\n        <div className=\"flex items-center space-x-4\">\r\n          <div className=\"text-sm text-gray-500\">\r\n             {nodes.length} \r\n          </div>\r\n          {onLayoutChange && (\r\n            <div className=\"flex items-center space-x-2\">\r\n              <span className=\"text-sm text-gray-600\">:</span>\r\n              <button\r\n                onClick={() => onLayoutChange('vertical')}\r\n                className={`px-3 py-1 text-xs rounded-md transition-colors ${\r\n                  layout === 'vertical' \r\n                    ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                }`}\r\n              >\r\n                 \r\n              </button>\r\n              <button\r\n                onClick={() => onLayoutChange('horizontal')}\r\n                className={`px-3 py-1 text-xs rounded-md transition-colors ${\r\n                  layout === 'horizontal' \r\n                    ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                }`}\r\n              >\r\n                 \r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/*   */}\r\n      <div className={layout === 'horizontal' ? 'overflow-x-auto pb-8' : 'space-y-2'}>\r\n        {layout === 'vertical' ? (\r\n          <div className=\"space-y-2\">\r\n            {hierarchy.map((node, index) => renderVerticalNode(node, index))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"flex justify-center min-w-max py-8\">\r\n            <div className=\"inline-block\">\r\n              {/*         */}\r\n              {hierarchy.length === 1 ? (\r\n                renderHorizontalNode(hierarchy[0])\r\n              ) : (\r\n                <div className=\"flex space-x-8\">\r\n                  {hierarchy.map((node) => renderHorizontalNode(node))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/*  */}\r\n      <div className=\"mt-6 pt-4 border-t border-gray-200\">\r\n        <h4 className=\"text-sm font-medium text-gray-700 mb-3\"></h4>\r\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L1)</span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L2)</span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L3)</span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L4)</span>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-lg\"></span>\r\n            <span> (L5)</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {deleteModal}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HierarchyTreeVisualization;","interface ParsedCriterion {\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  parent_id?: string | null;\r\n}\r\n\r\ninterface ParseResult {\r\n  success: boolean;\r\n  criteria: ParsedCriterion[];\r\n  errors: string[];\r\n}\r\n\r\nexport class TextParser {\r\n  /**\r\n   *       .\r\n   *  :\r\n   * 1. / \r\n   * 2.   (-, *, +)\r\n   * 3.   (1., 1-1., 1.1., etc.)\r\n   * 4. Excel - ( )\r\n   */\r\n  static parseText(text: string): ParseResult {\r\n    const lines = text.split('\\n').filter(line => line.trim().length > 0);\r\n    const criteria: ParsedCriterion[] = [];\r\n    const errors: string[] = [];\r\n    const nameMap = new Map<string, boolean>(); //  \r\n\r\n    if (lines.length === 0) {\r\n      return { success: false, criteria: [], errors: ['  .'] };\r\n    }\r\n\r\n    try {\r\n      for (let i = 0; i < lines.length; i++) {\r\n        const line = lines[i];\r\n        const parsed = this.parseLine(line, i + 1);\r\n        \r\n        if (parsed) {\r\n          //   \r\n          const lowerName = parsed.name.toLowerCase();\r\n          if (nameMap.has(lowerName)) {\r\n            errors.push(` ${i + 1}:   \"${parsed.name}\"`);\r\n            continue;\r\n          }\r\n          nameMap.set(lowerName, true);\r\n\r\n          //   \r\n          if (parsed.name.length < 2) {\r\n            errors.push(` ${i + 1}:  2  .`);\r\n            continue;\r\n          }\r\n\r\n          //   (1-5 )\r\n          if (parsed.level > 5) {\r\n            errors.push(` ${i + 1}:  5 .`);\r\n            continue;\r\n          }\r\n\r\n          criteria.push(parsed);\r\n        } else {\r\n          errors.push(` ${i + 1}:    . \"${line}\"`);\r\n        }\r\n      }\r\n\r\n      //   \r\n      const structureErrors = this.validateHierarchy(criteria);\r\n      errors.push(...structureErrors);\r\n\r\n      return {\r\n        success: errors.length === 0,\r\n        criteria,\r\n        errors\r\n      };\r\n\r\n    } catch (error) {\r\n      return {\r\n        success: false,\r\n        criteria: [],\r\n        errors: [`   : ${error}`]\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   *   .\r\n   * : 1)  , 2)  , 3)  \r\n   */\r\n  private static parseLine(line: string, lineNumber: number): ParsedCriterion | null {\r\n    // 1.       (1., 1.1., 1-1., 2., 2.1. etc.)\r\n    //      \r\n    const numberedMatch = line.match(/^\\s*(\\d+(?:[.-]\\d+)*)\\.?\\s+(.+)$/);\r\n    if (numberedMatch) {\r\n      const [, number, content] = numberedMatch;\r\n      \r\n      //    \r\n      // \"1\", \"2\", \"3\" =  1\r\n      // \"1.1\", \"2.1\" =  2\r\n      // \"1.1.1\", \"2.1.1\" =  3\r\n      let level = 1;\r\n      \r\n      //      \r\n      if (number.includes('.') || number.includes('-')) {\r\n        const parts = number.split(/[.-]/).filter(p => p.trim() !== '');\r\n        level = parts.length;\r\n      }\r\n      \r\n      const [name, description] = this.extractNameAndDescription(content);\r\n      return { name: name.trim(), description, level };\r\n    }\r\n\r\n    // 2.    (-, *, +    )\r\n    const markdownMatch = line.match(/^(\\s*)([-*+])\\s+(.+)$/);\r\n    if (markdownMatch) {\r\n      const [, indent, , content] = markdownMatch;\r\n      //   \r\n      let level = 1;\r\n      if (indent.length > 0) {\r\n        //  4 \r\n        const spaces = indent.replace(/\\t/g, '    ').length;\r\n        // 2  4 1 \r\n        if (spaces >= 2) {\r\n          level = Math.floor(spaces / 2) + 1;\r\n        }\r\n      }\r\n      const [name, description] = this.extractNameAndDescription(content);\r\n      return { name: name.trim(), description, level };\r\n    }\r\n\r\n    //    (  )\r\n    const indentMatch = line.match(/^(\\s+)(.+)$/);\r\n    if (indentMatch) {\r\n      const [, indent, content] = indentMatch;\r\n      \r\n      //      \r\n      const spaces = indent.replace(/\\t/g, '    ').length;\r\n      \r\n      // 4 1  (4 =  2, 8 =  3, ...)\r\n      const level = Math.floor(spaces / 4) + 1;\r\n\r\n      const [name, description] = this.extractNameAndDescription(content);\r\n      return { name: name.trim(), description, level };\r\n    }\r\n\r\n    //      1 \r\n    const plainMatch = line.match(/^(.+)$/);\r\n    if (plainMatch) {\r\n      const [, content] = plainMatch;\r\n      const [name, description] = this.extractNameAndDescription(content);\r\n      return { name: name.trim(), description, level: 1 };\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   *    .\r\n   * : \" - \"  \": \"  \" ()\"\r\n   */\r\n  private static extractNameAndDescription(text: string): [string, string?] {\r\n    // \" - \" \r\n    const dashMatch = text.match(/^([^-]+?)\\s*-\\s*(.+)$/);\r\n    if (dashMatch) {\r\n      return [dashMatch[1].trim(), dashMatch[2].trim()];\r\n    }\r\n\r\n    // \": \" \r\n    const colonMatch = text.match(/^([^:]+?)\\s*:\\s*(.+)$/);\r\n    if (colonMatch) {\r\n      return [colonMatch[1].trim(), colonMatch[2].trim()];\r\n    }\r\n\r\n    // \" ()\" \r\n    const parenthesesMatch = text.match(/^([^(]+?)\\s*\\(([^)]+)\\)\\s*$/);\r\n    if (parenthesesMatch) {\r\n      return [parenthesesMatch[1].trim(), parenthesesMatch[2].trim()];\r\n    }\r\n\r\n    //   \r\n    return [text.trim()];\r\n  }\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  private static validateHierarchy(criteria: ParsedCriterion[]): string[] {\r\n    const errors: string[] = [];\r\n    \r\n    if (criteria.length === 0) {\r\n      return [' 1   .'];\r\n    }\r\n\r\n    //  1  \r\n    const level1Count = criteria.filter(c => c.level === 1).length;\r\n    if (level1Count === 0) {\r\n      errors.push(' ( 1)   1 .');\r\n    }\r\n\r\n    //   \r\n    const levelSet = new Set(criteria.map(c => c.level));\r\n    const levels = Array.from(levelSet).sort((a, b) => a - b);\r\n    for (let i = 0; i < levels.length - 1; i++) {\r\n      if (levels[i + 1] - levels[i] > 1) {\r\n        errors.push(` ${levels[i]}  ${levels[i + 1]}   .   .`);\r\n      }\r\n    }\r\n\r\n    return errors;\r\n  }\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  static getExampleTexts(): { [key: string]: string } {\r\n    return {\r\n      markdown: `-  \r\n  -  -   \r\n  -  -    \r\n  -  -   \r\n-  \r\n  -  -    \r\n  -   -   \r\n  -   - R&D   \r\n- \r\n  -   -    \r\n  -   -   \r\n  -  -   `,\r\n\r\n      numbered: `1.  \r\n  1.1.  -   \r\n  1.2.  -  \r\n  1.3.  -   \r\n2.  \r\n  2.1.  -    \r\n  2.2.   -   \r\n  2.3.   - R&D   \r\n3. \r\n  3.1.   -    \r\n  3.2.   -   \r\n  3.3.  -   `,\r\n\r\n      indented: ` \r\n     -   \r\n     -  \r\n     -   \r\n \r\n     -    \r\n      -   \r\n      - R&D   \r\n\r\n      -    \r\n      -   \r\n     -   `\r\n    };\r\n  }\r\n}\r\n\r\nexport default TextParser;","import React, { useState } from 'react';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport TextParser from '../../utils/textParser';\r\n\r\ninterface Criterion {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  parent_id?: string | null;\r\n  level: number;\r\n  children?: Criterion[];\r\n  weight?: number;\r\n  order?: number;\r\n}\r\n\r\ninterface ParsedCriterion {\r\n  name: string;\r\n  level: number;\r\n  description?: string;\r\n}\r\n\r\ninterface ParseResult {\r\n  success: boolean;\r\n  criteria: ParsedCriterion[];\r\n  errors: string[];\r\n}\r\n\r\ninterface BulkCriteriaInputProps {\r\n  onImport: (criteria: Criterion[]) => void;\r\n  onCancel: () => void;\r\n  existingCriteria: Criterion[];\r\n}\r\n\r\nconst BulkCriteriaInput: React.FC<BulkCriteriaInputProps> = ({\r\n  onImport,\r\n  onCancel,\r\n  existingCriteria\r\n}) => {\r\n  const [inputText, setInputText] = useState('');\r\n  const [activeTab, setActiveTab] = useState<'input' | 'examples'>('input');\r\n  const [parseResult, setParseResult] = useState<ParseResult | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [actionMessage, setActionMessage] = useState<{type:'success'|'error'|'info', text:string}|null>(null);\r\n\r\n  const showActionMessage = (type: 'success'|'error'|'info', text: string) => {\r\n    setActionMessage({type, text});\r\n    setTimeout(() => setActionMessage(null), 3000);\r\n  };\r\n\r\n  const handleParse = () => {\r\n    if (!inputText.trim()) {\r\n      setParseResult({\r\n        success: false,\r\n        criteria: [],\r\n        errors: ['  .']\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    \r\n    try {\r\n      const result = TextParser.parseText(inputText);\r\n\r\n      //     (   )\r\n      if (existingCriteria && existingCriteria.length > 0) {\r\n        const existingNames = getAllCriteria(existingCriteria).map(c => c.name.toLowerCase());\r\n        const duplicates = result.criteria.filter(c => \r\n          existingNames.includes(c.name.toLowerCase())\r\n        );\r\n        \r\n        if (duplicates.length > 0) {\r\n          result.errors.push(\r\n            `  : ${duplicates.map(d => d.name).join(', ')}`\r\n          );\r\n          result.success = false;\r\n        }\r\n      }\r\n      \r\n      setParseResult(result);\r\n    } catch (error) {\r\n      setParseResult({\r\n        success: false,\r\n        criteria: [],\r\n        errors: [`   : ${error}`]\r\n      });\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleImport = () => {\r\n    if (!parseResult || !parseResult.success) return;\r\n\r\n    //    Criterion   ( )\r\n    const convertedCriteria = convertParsedCriteriaFlat(parseResult.criteria);\r\n\r\n    //   \r\n    const validationErrors: string[] = [];\r\n    \r\n    // 1.   \r\n    convertedCriteria.forEach((criterion, index) => {\r\n      if (!criterion.id) validationErrors.push(`${index + 1} : ID `);\r\n      if (!criterion.name || criterion.name.trim() === '') validationErrors.push(`${index + 1} :  `);\r\n      if (!criterion.level || criterion.level < 1) validationErrors.push(`${index + 1} :   (${criterion.level})`);\r\n    });\r\n    \r\n    // 2. parent_id   \r\n    const idSet = new Set(convertedCriteria.map(c => c.id));\r\n    convertedCriteria.forEach((criterion, index) => {\r\n      if (criterion.parent_id && !idSet.has(criterion.parent_id)) {\r\n        validationErrors.push(`${index + 1}  '${criterion.name}':    ID (${criterion.parent_id})`);\r\n      }\r\n    });\r\n\r\n    if (validationErrors.length > 0) {\r\n      showActionMessage('error', `  : ${validationErrors.join(', ')}`);\r\n      return;\r\n    }\r\n\r\n    //      import\r\n    onImport(convertedCriteria);\r\n  };\r\n\r\n  //    (CriteriaManagement  )\r\n  const convertParsedCriteriaFlat = (parsedCriteria: ParsedCriterion[]): Criterion[] => {\r\n    const allCriteria: Criterion[] = [];\r\n    const levelParentMap: Map<number, Criterion> = new Map();\r\n    \r\n    //   \r\n    parsedCriteria.forEach((parsed, index) => {\r\n      const id = `temp_${Date.now()}_${index}_${Math.floor(Math.random() * 1000)}`;\r\n      \r\n      //  :   1    \r\n      let parent_id: string | null = null;\r\n      if (parsed.level > 1) {\r\n        const parentLevel = parsed.level - 1;\r\n        const parentNode = levelParentMap.get(parentLevel);\r\n        if (parentNode) {\r\n          parent_id = parentNode.id;\r\n        }\r\n      }\r\n      \r\n      const criterion: Criterion = {\r\n        id,\r\n        name: parsed.name,\r\n        description: parsed.description,\r\n        parent_id,\r\n        level: parsed.level,\r\n        children: undefined, //   children \r\n        weight: 1,\r\n        order: index + 1\r\n      };\r\n      \r\n      allCriteria.push(criterion);\r\n\r\n      //      ( /     )\r\n      levelParentMap.set(parsed.level, criterion);\r\n\r\n      //     (     )\r\n      for (let level = parsed.level + 1; level <= 10; level++) {\r\n        levelParentMap.delete(level);\r\n      }\r\n    });\r\n\r\n    //    \r\n    return allCriteria;\r\n  };\r\n\r\n  const buildHierarchy = (flatCriteria: Criterion[]): Criterion[] => {\r\n    const criteriaMap = new Map<string, Criterion>();\r\n    const rootCriteria: Criterion[] = [];\r\n\r\n    //     (children  )\r\n    flatCriteria.forEach(criterion => {\r\n      criteriaMap.set(criterion.id, { \r\n        ...criterion, \r\n        children: [] \r\n      });\r\n    });\r\n\r\n    //  \r\n    flatCriteria.forEach(criterion => {\r\n      const criterionObj = criteriaMap.get(criterion.id);\r\n      if (!criterionObj) return;\r\n\r\n      if (criterion.parent_id && criteriaMap.has(criterion.parent_id)) {\r\n        //     children \r\n        const parent = criteriaMap.get(criterion.parent_id);\r\n        if (parent) {\r\n          parent.children = parent.children || [];\r\n          parent.children.push(criterionObj);\r\n        }\r\n      } else {\r\n        //    1   \r\n        rootCriteria.push(criterionObj);\r\n      }\r\n    });\r\n\r\n    // \r\n    const sortByOrder = (items: Criterion[]) => {\r\n      items.sort((a, b) => (a.order || 0) - (b.order || 0));\r\n      items.forEach(item => {\r\n        if (item.children && item.children.length > 0) {\r\n          sortByOrder(item.children);\r\n        }\r\n      });\r\n    };\r\n    \r\n    sortByOrder(rootCriteria);\r\n    return rootCriteria;\r\n  };\r\n\r\n  const getAllCriteria = (criteriaList: Criterion[]): Criterion[] => {\r\n    const all: Criterion[] = [];\r\n    const traverse = (items: Criterion[]) => {\r\n      items.forEach(item => {\r\n        all.push(item);\r\n        if (item.children && item.children.length > 0) {\r\n          traverse(item.children);\r\n        }\r\n      });\r\n    };\r\n    traverse(criteriaList);\r\n    return all;\r\n  };\r\n\r\n  const exampleTexts = TextParser.getExampleTexts();\r\n\r\n  const insertExample = (exampleKey: string) => {\r\n    setInputText(exampleTexts[exampleKey]);\r\n    setActiveTab('input');\r\n    setParseResult(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      {actionMessage && (\r\n        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg ${actionMessage.type === 'success' ? 'bg-green-100 text-green-800' : actionMessage.type === 'info' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`}>\r\n          {actionMessage.text}\r\n        </div>\r\n      )}\r\n      <div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col\">\r\n        <Card title=\"   \">\r\n          <div className=\"flex flex-col h-full max-h-[80vh]\">\r\n            {/*   -  */}\r\n            <div className=\"flex border-b flex-shrink-0\">\r\n              <button\r\n                className={`px-4 py-2 font-medium ${\r\n                  activeTab === 'input'\r\n                    ? 'border-b-2 border-blue-500 text-blue-600'\r\n                    : 'text-gray-500 hover:text-gray-700'\r\n                }`}\r\n                onClick={() => setActiveTab('input')}\r\n              >\r\n                 \r\n              </button>\r\n              <button\r\n                className={`px-4 py-2 font-medium ${\r\n                  activeTab === 'examples'\r\n                    ? 'border-b-2 border-blue-500 text-blue-600'\r\n                    : 'text-gray-500 hover:text-gray-700'\r\n                }`}\r\n                onClick={() => setActiveTab('examples')}\r\n              >\r\n                 \r\n              </button>\r\n            </div>\r\n\r\n            {/*     */}\r\n            <div className=\"flex-1 overflow-y-scroll p-6 space-y-6 pb-20\">\r\n\r\n            {activeTab === 'input' && (\r\n              <div className=\"space-y-4\">\r\n                {/*   -   */}\r\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n                  <h4 className=\"font-medium text-blue-900 mb-3\">   </h4>\r\n                  <div className=\"text-sm text-blue-700 space-y-3\">\r\n                    <div>\r\n                      <strong>   </strong>\r\n                      <div className=\"ml-4 mt-1 font-mono text-xs bg-white p-2 rounded\">\r\n                        - <br/>\r\n                        &nbsp;&nbsp;-  (2 )<br/>\r\n                        &nbsp;&nbsp;&nbsp;&nbsp;-  (4 )\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <strong>   </strong>\r\n                      <div className=\"ml-4 mt-1 font-mono text-xs bg-white p-2 rounded\">\r\n                        1. <br/>\r\n                        &nbsp;&nbsp;1.1. <br/>\r\n                        &nbsp;&nbsp;1.2. \r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <strong>  </strong>\r\n                      <div className=\"ml-4 mt-1 font-mono text-xs bg-white p-2 rounded\">\r\n                        <br/>\r\n                        &nbsp;&nbsp;&nbsp;&nbsp; (4 )<br/>\r\n                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (8 )\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-yellow-700 bg-yellow-50 p-2 rounded\">\r\n                       <strong>:</strong>     !<br/>\r\n                       : 2 <br/>\r\n                       : 4 \r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/*    */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      \r\n                  </label>\r\n                  <textarea\r\n                    className=\"w-full h-64 p-3 border border-gray-300 rounded-lg font-mono text-sm resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                    placeholder=\"  ...\r\n\r\n:\r\n-  \r\n  -  -     \r\n  -  -    \r\n  -  -       \r\n- \r\n  -   -      \r\n  -   -     \"\r\n                    value={inputText}\r\n                    onChange={(e) => setInputText(e.target.value)}\r\n                  />\r\n                </div>\r\n\r\n                {/*   */}\r\n                <div className=\"flex justify-center\">\r\n                  <Button\r\n                    variant=\"primary\"\r\n                    onClick={handleParse}\r\n                    disabled={!inputText.trim() || isProcessing}\r\n                  >\r\n                    {isProcessing ? ' ...' : '  '}\r\n                  </Button>\r\n                </div>\r\n\r\n                {/*   */}\r\n                {parseResult && (\r\n                  <div className=\"space-y-4\">\r\n                    {parseResult.success ? (\r\n                      <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n                        <h4 className=\"font-medium text-green-900 mb-3\">\r\n                             ({parseResult.criteria.length} )\r\n                        </h4>\r\n                        <div className=\"space-y-2\">\r\n                          {/*   */}\r\n                          <div className=\"text-sm text-green-700 mb-3\">\r\n                            {(() => {\r\n                              const levelCounts = parseResult.criteria.reduce((acc: Record<number, number>, c: ParsedCriterion) => {\r\n                                acc[c.level] = (acc[c.level] || 0) + 1;\r\n                                return acc;\r\n                              }, {} as Record<number, number>);\r\n                              return Object.entries(levelCounts).map(([level, count]) => (\r\n                                <span key={level} className=\"inline-block mr-4\">\r\n                                  {` ${level}: ${count}`}\r\n                                </span>\r\n                              ));\r\n                            })()}\r\n                          </div>\r\n                          {/*   */}\r\n                          <div className=\"bg-white rounded p-3 text-sm\">\r\n                            {parseResult.criteria.map((criterion: ParsedCriterion, index: number) => (\r\n                              <div key={index} className=\"py-1\">\r\n                                <span style={{ paddingLeft: `${(criterion.level - 1) * 20}px` }}>\r\n                                  {criterion.level === 1 && ' '}\r\n                                  {criterion.level === 2 && ' '}\r\n                                  {criterion.level === 3 && ' '}\r\n                                  {criterion.level === 4 && ' '}\r\n                                  {criterion.level >= 5 && ' '}\r\n                                  <span className=\"font-medium\">{criterion.name}</span>\r\n                                  {criterion.description && (\r\n                                    <span className=\"ml-2 text-gray-600\">- {criterion.description}</span>\r\n                                  )}\r\n                                </span>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n                        <h4 className=\"font-medium text-red-900 mb-2\">  </h4>\r\n                        <ul className=\"text-sm text-red-700 space-y-1\">\r\n                          {parseResult.errors.map((error: string, index: number) => (\r\n                            <li key={index}> {error}</li>\r\n                          ))}\r\n                        </ul>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {activeTab === 'examples' && (\r\n              <div className=\"space-y-6 pb-8\">\r\n                <div className=\"text-center\">\r\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-2\">  </h3>\r\n                  <p className=\"text-gray-600 text-sm\">\r\n                         .\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"grid gap-4 mb-8\">\r\n                  {Object.entries(exampleTexts).map(([key, text]) => (\r\n                    <div key={key} className=\"border border-gray-200 rounded-lg p-4\">\r\n                      <div className=\"flex items-center justify-between mb-2\">\r\n                        <h4 className=\"font-medium text-gray-900\">\r\n                          {key === 'markdown' && '    (2 )'}\r\n                          {key === 'numbered' && '   '}\r\n                          {key === 'indented' && '   (4 )'}\r\n                        </h4>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => insertExample(key)}\r\n                        >\r\n                          \r\n                        </Button>\r\n                      </div>\r\n                      <pre className=\"text-xs bg-gray-50 p-3 rounded border overflow-x-auto whitespace-pre\">\r\n                        {text}\r\n                      </pre>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n                \r\n                {/*       */}\r\n                <div className=\"h-16\"></div>\r\n              </div>\r\n            )}\r\n            </div>\r\n\r\n            {/*   -   */}\r\n            <div className=\"flex justify-end space-x-3 pt-4 px-6 pb-6 border-t flex-shrink-0 bg-white\">\r\n              <Button variant=\"secondary\" onClick={onCancel}>\r\n                \r\n              </Button>\r\n              {parseResult && parseResult.success && (\r\n                <Button variant=\"primary\" onClick={handleImport}>\r\n                   {parseResult.criteria.length}  \r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BulkCriteriaInput;","import React from 'react';\r\nimport Button from '../common/Button';\r\n\r\nexport interface CriteriaTemplateNode {\r\n  name: string;\r\n  description?: string;\r\n  children?: CriteriaTemplateNode[];\r\n}\r\n\r\nexport interface CriteriaTemplate {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  structure: CriteriaTemplateNode[];\r\n}\r\n\r\nexport const CRITERIA_TEMPLATES: CriteriaTemplate[] = [\r\n  {\r\n    id: '3x3',\r\n    name: '3x3  ',\r\n    description: '3 ,  3 ',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: ' 1',\r\n        description: '   ',\r\n        children: [\r\n          { name: ' 1-1', description: '  ' },\r\n          { name: ' 1-2', description: '  ' },\r\n          { name: ' 1-3', description: '  ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' 2',\r\n        description: '   ',\r\n        children: [\r\n          { name: ' 2-1', description: '  ' },\r\n          { name: ' 2-2', description: '  ' },\r\n          { name: ' 2-3', description: '  ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' 3',\r\n        description: '   ',\r\n        children: [\r\n          { name: ' 3-1', description: '  ' },\r\n          { name: ' 3-2', description: '  ' },\r\n          { name: ' 3-3', description: '  ' }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    id: '4x2',\r\n    name: '4x2 ',\r\n    description: '4 ,  2 ',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: '',\r\n        description: '/  ',\r\n        children: [\r\n          { name: '', description: '   ' },\r\n          { name: '', description: ' ' }\r\n        ]\r\n      },\r\n      {\r\n        name: '',\r\n        description: ' ',\r\n        children: [\r\n          { name: '', description: '   ' },\r\n          { name: '', description: '   ' }\r\n        ]\r\n      },\r\n      {\r\n        name: '',\r\n        description: '  ',\r\n        children: [\r\n          { name: '', description: '   ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      },\r\n      {\r\n        name: '',\r\n        description: '  ',\r\n        children: [\r\n          { name: '', description: '   ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    id: '2x4',\r\n    name: '2x4  ',\r\n    description: '2 ,  4 ',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          { name: ' ', description: 'KPI ' },\r\n          { name: '', description: '  ' },\r\n          { name: '', description: '  ' },\r\n          { name: '', description: ' ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          { name: '', description: '  ' },\r\n          { name: '', description: ' ' },\r\n          { name: '', description: ' ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    id: 'simple3',\r\n    name: ' 3',\r\n    description: '3  ( )',\r\n    icon: '',\r\n    structure: [\r\n      { name: '', description: '  ' },\r\n      { name: '', description: '  ' },\r\n      { name: '', description: '  ' }\r\n    ]\r\n  },\r\n  {\r\n    id: 'complex',\r\n    name: ' ',\r\n    description: '  (3)',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          {\r\n            name: ' ',\r\n            description: '  ',\r\n            children: [\r\n              { name: ' ', description: '  ' },\r\n              { name: ' ', description: '  ' }\r\n            ]\r\n          },\r\n          {\r\n            name: ' ',\r\n            description: ' ',\r\n            children: [\r\n              { name: '', description: '  ' },\r\n              { name: ' ', description: ' ' }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          {\r\n            name: '',\r\n            description: '  ',\r\n            children: [\r\n              { name: '', description: '  ' },\r\n              { name: '', description: '  ' }\r\n            ]\r\n          },\r\n          {\r\n            name: ' ',\r\n            description: '  ',\r\n            children: [\r\n              { name: ' ', description: '  ' },\r\n              { name: ' ', description: '  ' }\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    id: 'it_project',\r\n    name: 'IT  ',\r\n    description: 'SW/   (33 )',\r\n    icon: '',\r\n    structure: [\r\n      {\r\n        name: ' ',\r\n        description: '  ',\r\n        children: [\r\n          { name: '', description: '  ' },\r\n          { name: '', description: '  ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' ',\r\n        description: ' ',\r\n        children: [\r\n          { name: 'ROI', description: '  ' },\r\n          { name: ' ', description: '  ' },\r\n          { name: ' ', description: 'UX/UI ' }\r\n        ]\r\n      },\r\n      {\r\n        name: ' ',\r\n        description: ' ',\r\n        children: [\r\n          { name: '', description: '  ' },\r\n          { name: ' ', description: '  ' },\r\n          { name: '', description: '  ' }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n];\r\n\r\ninterface CriteriaTemplatesProps {\r\n  onSelectTemplate: (template: CriteriaTemplate) => void;\r\n  onClose: () => void;\r\n}\r\n\r\nconst CriteriaTemplates: React.FC<CriteriaTemplatesProps> = ({ \r\n  onSelectTemplate, \r\n  onClose \r\n}) => {\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\r\n        <div className=\"p-6 border-b\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-2xl font-bold text-gray-900\">\r\n                \r\n            </h2>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"text-gray-500 hover:text-gray-700\"\r\n            >\r\n              \r\n            </button>\r\n          </div>\r\n          <p className=\"text-gray-600 mt-2\">\r\n                .    .\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-120px)]\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            {CRITERIA_TEMPLATES.map(template => (\r\n              <div\r\n                key={template.id}\r\n                className=\"border rounded-lg p-4 hover:border-blue-500 hover:shadow-md transition-all cursor-pointer\"\r\n                onClick={() => onSelectTemplate(template)}\r\n              >\r\n                <div className=\"flex items-start space-x-3\">\r\n                  <div className=\"text-3xl\">{template.icon}</div>\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"font-semibold text-gray-900\">\r\n                      {template.name}\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-600 mb-2\">\r\n                      {template.description}\r\n                    </p>\r\n                    \r\n                    {/*   */}\r\n                    <div className=\"bg-gray-50 rounded p-2 text-xs space-y-1\">\r\n                      {template.structure.slice(0, 3).map((item, idx) => (\r\n                        <div key={idx} className=\"text-gray-700\">\r\n                          <span className=\"font-medium\"> {item.name}</span>\r\n                          {item.children && (\r\n                            <span className=\"text-gray-500 ml-2\">\r\n                              ({item.children.length} )\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                      {template.structure.length > 3 && (\r\n                        <div className=\"text-gray-500\">\r\n                          ...  {template.structure.length - 3}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-4 border-t bg-gray-50\">\r\n          <div className=\"flex justify-end\">\r\n            <Button variant=\"secondary\" onClick={onClose}>\r\n              \r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CriteriaTemplates;","import React, { useState } from 'react';\r\nimport Button from '../common/Button';\r\nimport Modal from '../common/Modal';\r\n\r\nexport interface CriteriaNode {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  parent_id: string | null;\r\n  children: CriteriaNode[];\r\n  isEditing?: boolean;\r\n  isExpanded?: boolean;\r\n}\r\n\r\ninterface FlatCriteriaItem {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  parent_id: string | null;\r\n  order: number;\r\n}\r\n\r\ninterface VisualCriteriaBuilderProps {\r\n  initialCriteria?: CriteriaNode[];\r\n  onSave: (criteria: CriteriaNode[]) => void;\r\n  onClose?: () => void;\r\n  isInline?: boolean; //   \r\n}\r\n\r\nconst VisualCriteriaBuilder: React.FC<VisualCriteriaBuilderProps> = ({\r\n  initialCriteria = [],\r\n  onSave,\r\n  onClose,\r\n  isInline = true //   \r\n}) => {\r\n  const [criteria, setCriteria] = useState<CriteriaNode[]>(() => {\r\n    if (initialCriteria.length > 0) {\r\n      return initialCriteria.map(c => ({ ...c, isExpanded: true }));\r\n    }\r\n    //    \r\n    return [{\r\n      id: `temp_${Date.now()}`,\r\n      name: ' ',\r\n      description: '  ',\r\n      level: 1,\r\n      parent_id: null,\r\n      children: [],\r\n      isExpanded: true\r\n    }];\r\n  });\r\n\r\n  const [selectedNodeId, setSelectedNodeId] = useState<string | null>(null);\r\n  const [draggedNodeId, setDraggedNodeId] = useState<string | null>(null);\r\n  const [pendingDeleteId, setPendingDeleteId] = useState<string | null>(null);\r\n\r\n  //  \r\n  const findNode = (nodes: CriteriaNode[], id: string): CriteriaNode | null => {\r\n    for (const node of nodes) {\r\n      if (node.id === id) return node;\r\n      const found = findNode(node.children, id);\r\n      if (found) return found;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  //  \r\n  const updateNode = (nodes: CriteriaNode[], id: string, updates: Partial<CriteriaNode>): CriteriaNode[] => {\r\n    return nodes.map(node => {\r\n      if (node.id === id) {\r\n        return { ...node, ...updates };\r\n      }\r\n      return {\r\n        ...node,\r\n        children: updateNode(node.children, id, updates)\r\n      };\r\n    });\r\n  };\r\n\r\n  //  \r\n  const addNode = (parentId: string | null) => {\r\n    const newNode: CriteriaNode = {\r\n      id: `temp_${Date.now()}_${Math.floor(Math.random() * 1000)}`,\r\n      name: ' ',\r\n      description: '',\r\n      level: parentId ? (findNode(criteria, parentId)?.level || 0) + 1 : 1,\r\n      parent_id: parentId,\r\n      children: [],\r\n      isEditing: true,\r\n      isExpanded: true\r\n    };\r\n\r\n    if (parentId) {\r\n      //    \r\n      setCriteria(prev => {\r\n        const addChildToParent = (nodes: CriteriaNode[]): CriteriaNode[] => {\r\n          return nodes.map(node => {\r\n            if (node.id === parentId) {\r\n              return {\r\n                ...node,\r\n                children: [...node.children, newNode],\r\n                isExpanded: true\r\n              };\r\n            }\r\n            return {\r\n              ...node,\r\n              children: addChildToParent(node.children)\r\n            };\r\n          });\r\n        };\r\n        return addChildToParent(prev);\r\n      });\r\n    } else {\r\n      //   \r\n      setCriteria(prev => [...prev, newNode]);\r\n    }\r\n    \r\n    setSelectedNodeId(newNode.id);\r\n  };\r\n\r\n  //  \r\n  const deleteNode = (id: string) => {\r\n    setPendingDeleteId(id);\r\n  };\r\n\r\n  const confirmDeleteNode = () => {\r\n    if (!pendingDeleteId) return;\r\n\r\n    const id = pendingDeleteId;\r\n    const removeNode = (nodes: CriteriaNode[]): CriteriaNode[] => {\r\n      return nodes.filter(node => {\r\n        if (node.id === id) return false;\r\n        node.children = removeNode(node.children);\r\n        return true;\r\n      });\r\n    };\r\n\r\n    setCriteria(prev => removeNode(prev));\r\n    setSelectedNodeId(null);\r\n    setPendingDeleteId(null);\r\n  };\r\n\r\n  //    \r\n  const toggleEditMode = (id: string) => {\r\n    setCriteria(prev => updateNode(prev, id, { isEditing: !findNode(prev, id)?.isEditing }));\r\n  };\r\n\r\n  //  / \r\n  const toggleExpanded = (id: string) => {\r\n    setCriteria(prev => updateNode(prev, id, { isExpanded: !findNode(prev, id)?.isExpanded }));\r\n  };\r\n\r\n  //   \r\n  const updateNodeName = (id: string, name: string) => {\r\n    setCriteria(prev => updateNode(prev, id, { name }));\r\n  };\r\n\r\n  //   \r\n  const updateNodeDescription = (id: string, description: string) => {\r\n    setCriteria(prev => updateNode(prev, id, { description }));\r\n  };\r\n\r\n  //    \r\n  const handleDragStart = (e: React.DragEvent, nodeId: string) => {\r\n    setDraggedNodeId(nodeId);\r\n    e.dataTransfer.effectAllowed = 'move';\r\n  };\r\n\r\n  const handleDragOver = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    e.dataTransfer.dropEffect = 'move';\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent, targetId: string) => {\r\n    e.preventDefault();\r\n    if (!draggedNodeId || draggedNodeId === targetId) return;\r\n\r\n    setCriteria(prev => {\r\n      const draggedNode = findNode(prev, draggedNodeId);\r\n      if (!draggedNode) return prev;\r\n\r\n      // Prevent dropping onto own descendant (would create circular reference)\r\n      const isDescendantOf = (ancestorId: string, searchId: string): boolean => {\r\n        const ancestor = findNode(prev, ancestorId);\r\n        if (!ancestor) return false;\r\n        const check = (children: CriteriaNode[]): boolean =>\r\n          children.some(c => c.id === searchId || check(c.children));\r\n        return check(ancestor.children);\r\n      };\r\n      if (isDescendantOf(draggedNodeId, targetId)) return prev;\r\n\r\n      // Remove dragged node from its current position\r\n      const removeNode = (nodes: CriteriaNode[]): CriteriaNode[] =>\r\n        nodes\r\n          .filter(n => n.id !== draggedNodeId)\r\n          .map(n => ({ ...n, children: removeNode(n.children) }));\r\n\r\n      // Recursively fix levels and parent references after move\r\n      const fixLevels = (node: CriteriaNode, parentLevel: number, newParentId: string | null): CriteriaNode => ({\r\n        ...node,\r\n        level: parentLevel + 1,\r\n        parent_id: newParentId,\r\n        children: node.children.map(c => fixLevels(c, parentLevel + 1, node.id))\r\n      });\r\n\r\n      // Insert dragged node as a child of the target\r\n      const insertAtTarget = (nodes: CriteriaNode[]): CriteriaNode[] =>\r\n        nodes.map(n => {\r\n          if (n.id === targetId) {\r\n            const movedNode = fixLevels(draggedNode, n.level, targetId);\r\n            return { ...n, children: [...n.children, movedNode], isExpanded: true };\r\n          }\r\n          return { ...n, children: insertAtTarget(n.children) };\r\n        });\r\n\r\n      return insertAtTarget(removeNode(prev));\r\n    });\r\n\r\n    setDraggedNodeId(null);\r\n  };\r\n\r\n  //  \r\n  const renderNode = (node: CriteriaNode, depth: number = 0) => {\r\n    const hasChildren = node.children && node.children.length > 0;\r\n    const isSelected = selectedNodeId === node.id;\r\n\r\n    return (\r\n      <div key={node.id} className=\"mb-2\">\r\n        <div\r\n          className={`\r\n            flex items-center p-2 rounded-lg border transition-all\r\n            ${isSelected ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'}\r\n            ${depth > 0 ? 'ml-8' : ''}\r\n          `}\r\n          onClick={() => setSelectedNodeId(node.id)}\r\n          draggable\r\n          onDragStart={(e) => handleDragStart(e, node.id)}\r\n          onDragOver={handleDragOver}\r\n          onDrop={(e) => handleDrop(e, node.id)}\r\n        >\r\n          {/* /  */}\r\n          {hasChildren && (\r\n            <button\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                toggleExpanded(node.id);\r\n              }}\r\n              className=\"mr-2 text-gray-500 hover:text-gray-700\"\r\n            >\r\n              {node.isExpanded ? '' : ''}\r\n            </button>\r\n          )}\r\n\r\n          {/*   */}\r\n          <div className={`\r\n            w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold mr-2\r\n            ${depth === 0 ? 'bg-purple-500 text-white' : \r\n              depth === 1 ? 'bg-blue-500 text-white' : \r\n              depth === 2 ? 'bg-green-500 text-white' : \r\n              'bg-gray-500 text-white'}\r\n          `}>\r\n            {node.level}\r\n          </div>\r\n\r\n          {/*   */}\r\n          <div className=\"flex-1\">\r\n            {node.isEditing ? (\r\n              <div className=\"space-y-2\" onClick={(e) => e.stopPropagation()}>\r\n                <input\r\n                  value={node.name}\r\n                  onChange={(e) => updateNodeName(node.id, e.target.value)}\r\n                  placeholder=\" \"\r\n                  className=\"w-full px-2 py-1 text-sm border rounded focus:outline-none focus:border-blue-500\"\r\n                  autoFocus\r\n                />\r\n                <input\r\n                  value={node.description || ''}\r\n                  onChange={(e) => updateNodeDescription(node.id, e.target.value)}\r\n                  placeholder=\" ()\"\r\n                  className=\"w-full px-2 py-1 text-xs border rounded focus:outline-none focus:border-blue-500\"\r\n                />\r\n                <div className=\"flex space-x-2\">\r\n                  <button\r\n                    className=\"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n                    onClick={() => toggleEditMode(node.id)}\r\n                  >\r\n                    \r\n                  </button>\r\n                  <button\r\n                    className=\"px-3 py-1 text-xs bg-gray-200 text-gray-700 rounded hover:bg-gray-300\"\r\n                    onClick={() => {\r\n                      toggleEditMode(node.id);\r\n                      //   \r\n                    }}\r\n                  >\r\n                    \r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div \r\n                className=\"cursor-pointer\"\r\n                onDoubleClick={() => toggleEditMode(node.id)}\r\n              >\r\n                <div className=\"font-medium text-gray-900\">{node.name}</div>\r\n                {node.description && (\r\n                  <div className=\"text-xs text-gray-500\">{node.description}</div>\r\n                )}\r\n                <div className=\"text-xs text-blue-500 mt-1\"> </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/*   */}\r\n          {!node.isEditing && (\r\n            <div className=\"flex items-center space-x-1 ml-2\">\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  addNode(node.id);\r\n                }}\r\n                className=\"p-1 text-green-600 hover:bg-green-100 rounded\"\r\n                title=\"  \"\r\n              >\r\n                \r\n              </button>\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  toggleEditMode(node.id);\r\n                }}\r\n                className=\"p-1 text-blue-600 hover:bg-blue-100 rounded\"\r\n                title=\"\"\r\n              >\r\n                \r\n              </button>\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  deleteNode(node.id);\r\n                }}\r\n                className=\"p-1 text-red-600 hover:bg-red-100 rounded\"\r\n                title=\"\"\r\n              >\r\n                \r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/*   */}\r\n        {node.isExpanded && hasChildren && (\r\n          <div className=\"mt-1\">\r\n            {node.children.map(child => renderNode(child, depth + 1))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  //    ()\r\n  const flattenCriteria = (nodes: CriteriaNode[], parentId: string | null = null): FlatCriteriaItem[] => {\r\n    const result: FlatCriteriaItem[] = [];\r\n    nodes.forEach((node, index) => {\r\n      result.push({\r\n        id: node.id,\r\n        name: node.name,\r\n        description: node.description,\r\n        level: node.level,\r\n        parent_id: parentId,\r\n        order: index + 1\r\n      });\r\n      if (node.children && node.children.length > 0) {\r\n        result.push(...flattenCriteria(node.children, node.id));\r\n      }\r\n    });\r\n    return result;\r\n  };\r\n\r\n  //  \r\n  const getStats = () => {\r\n    const flatten = flattenCriteria(criteria);\r\n    const levels = flatten.reduce((acc, c) => {\r\n      acc[c.level] = (acc[c.level] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<number, number>);\r\n    \r\n    return {\r\n      total: flatten.length,\r\n      levels\r\n    };\r\n  };\r\n\r\n  const stats = getStats();\r\n\r\n  //    \r\n  if (isInline) {\r\n    return (\r\n      <div className=\"w-full\">\r\n        {/*  */}\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h3 className=\"text-lg font-bold text-gray-900\">  </h3>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n                  ,  \r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center space-x-4\">\r\n            <div className=\"text-sm text-gray-600\">\r\n               : <span className=\"font-semibold\">{stats.total}</span>\r\n            </div>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => addNode(null)}\r\n            >\r\n                 \r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/*    */}\r\n        <div className=\"border border-gray-200 rounded-lg p-4 bg-white max-h-[500px] overflow-y-auto\">\r\n          <div className=\"space-y-2\">\r\n            {criteria.map(node => renderNode(node))}\r\n          </div>\r\n\r\n          {criteria.length === 0 && (\r\n            <div className=\"text-center py-12 text-gray-500\">\r\n                    \r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/*   */}\r\n        <div className=\"flex justify-end mt-4 space-x-2\">\r\n          {onClose && (\r\n            <Button variant=\"secondary\" onClick={onClose}>\r\n              \r\n            </Button>\r\n          )}\r\n          <Button \r\n            variant=\"primary\" \r\n            onClick={() => onSave(criteria)}\r\n            disabled={stats.total === 0}\r\n          >\r\n            \r\n          </Button>\r\n        </div>\r\n\r\n        {/*  */}\r\n        <div className=\"mt-4 p-3 bg-gray-50 rounded-lg text-xs text-gray-600\">\r\n          <strong>  :</strong>\r\n              |     |   ( ) |\r\n             | / /\r\n        </div>\r\n\r\n        {/*    */}\r\n        <Modal\r\n          isOpen={pendingDeleteId !== null}\r\n          onClose={() => setPendingDeleteId(null)}\r\n          title=\" \"\r\n          size=\"sm\"\r\n          footer={\r\n            <div className=\"flex justify-end space-x-2\">\r\n              <Button size=\"sm\" variant=\"secondary\" onClick={() => setPendingDeleteId(null)}>\r\n                \r\n              </Button>\r\n              <Button size=\"sm\" variant=\"primary\" onClick={confirmDeleteNode}>\r\n                \r\n              </Button>\r\n            </div>\r\n          }\r\n        >\r\n          <p className=\"text-sm text-gray-700\">     . ?</p>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  //     ( )\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[90vh] flex flex-col\">\r\n        {/*  */}\r\n        <div className=\"p-4 border-b\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h2 className=\"text-2xl font-bold text-gray-900\">\r\n                  \r\n              </h2>\r\n              <p className=\"text-sm text-gray-600 mt-1\">\r\n                    ,  \r\n              </p>\r\n            </div>\r\n            {onClose && (\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-500 hover:text-gray-700 text-xl\"\r\n              >\r\n                \r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/*  */}\r\n        <div className=\"flex-1 flex overflow-hidden\">\r\n          {/* :    */}\r\n          <div className=\"flex-1 p-4 overflow-y-auto\">\r\n            <div className=\"mb-4\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => addNode(null)}\r\n                className=\"w-full\"\r\n              >\r\n                   \r\n              </Button>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              {criteria.map(node => renderNode(node))}\r\n            </div>\r\n\r\n            {criteria.length === 0 && (\r\n              <div className=\"text-center py-12 text-gray-500\">\r\n                      \r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* :    */}\r\n          <div className=\"w-80 border-l bg-gray-50 p-4 overflow-y-auto\">\r\n            <h3 className=\"font-semibold text-gray-900 mb-4\"> </h3>\r\n            \r\n            <div className=\"bg-white rounded-lg p-4 mb-4\">\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\"> </span>\r\n                  <span className=\"font-semibold\">{stats.total}</span>\r\n                </div>\r\n                {Object.entries(stats.levels).map(([level, count]) => (\r\n                  <div key={level} className=\"flex justify-between text-sm\">\r\n                    <span className=\"text-gray-500\"> {level}</span>\r\n                    <span>{String(count)}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <h4 className=\"font-medium text-gray-700 mb-2\"> </h4>\r\n            <div className=\"bg-white rounded-lg p-3 text-sm\">\r\n              {flattenCriteria(criteria).map((item, idx) => (\r\n                <div \r\n                  key={idx} \r\n                  className=\"py-1\"\r\n                  style={{ paddingLeft: `${(item.level - 1) * 16}px` }}\r\n                >\r\n                  <span className=\"text-gray-700\">\r\n                    {item.level > 1 && ' '}\r\n                    {item.name}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"mt-4 text-xs text-gray-500\">\r\n              <h5 className=\"font-medium mb-1\"></h5>\r\n              <ul className=\"space-y-1\">\r\n                <li>     </li>\r\n                <li>     </li>\r\n                <li>    ( )</li>\r\n                <li>     </li>\r\n                <li> /  /</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/*  */}\r\n        <div className=\"p-4 border-t bg-gray-50\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <div className=\"text-sm text-gray-600\">\r\n              {stats.total}  \r\n            </div>\r\n            <div className=\"flex space-x-2\">\r\n              {onClose && (\r\n                <Button variant=\"secondary\" onClick={onClose}>\r\n                  \r\n                </Button>\r\n              )}\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={() => onSave(criteria)}\r\n                disabled={stats.total === 0}\r\n              >\r\n                \r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/*    */}\r\n      <Modal\r\n        isOpen={pendingDeleteId !== null}\r\n        onClose={() => setPendingDeleteId(null)}\r\n        title=\" \"\r\n        size=\"sm\"\r\n        footer={\r\n          <div className=\"flex justify-end space-x-2\">\r\n            <Button size=\"sm\" variant=\"secondary\" onClick={() => setPendingDeleteId(null)}>\r\n              \r\n            </Button>\r\n            <Button size=\"sm\" variant=\"primary\" onClick={confirmDeleteNode}>\r\n              \r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <p className=\"text-sm text-gray-700\">     . ?</p>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VisualCriteriaBuilder;","import React, { useState, useEffect, useCallback } from 'react';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport Modal from '../common/Modal';\r\nimport HierarchyTreeVisualization from '../common/HierarchyTreeVisualization';\r\nimport BulkCriteriaInput from '../criteria/BulkCriteriaInput';\r\nimport CriteriaTemplates, { CriteriaTemplate } from '../criteria/CriteriaTemplates';\r\nimport VisualCriteriaBuilder, { CriteriaNode as VisualCriteriaNode } from '../criteria/VisualCriteriaBuilder';\r\nimport cleanDataService from '../../services/dataService_clean';\r\nimport { generateUUID, isTempId } from '../../utils/uuid';\r\n\r\ninterface TemplateItem {\r\n  name: string;\r\n  description?: string;\r\n  children?: TemplateItem[];\r\n}\r\n\r\ninterface Criterion {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  parent_id?: string | null;\r\n  level: number;\r\n  order?: number;\r\n  children?: Criterion[];\r\n  weight?: number;\r\n  type?: 'criteria';\r\n}\r\n\r\ninterface CriteriaManagementProps {\r\n  projectId: string;\r\n  projectTitle?: string;\r\n  onCriteriaChange: (count: number) => void;\r\n  onComplete?: () => void;\r\n}\r\n\r\nconst CriteriaManagement: React.FC<CriteriaManagementProps> = ({ \r\n  projectId, \r\n  onCriteriaChange, \r\n  onComplete \r\n}) => {\r\n  //     ( )\r\n  const [criteria, setCriteria] = useState<Criterion[]>([]);\r\n  //   \r\n  const [savedCriteria, setSavedCriteria] = useState<Criterion[]>([]);\r\n  //    (/   )\r\n  const [tempCriteria, setTempCriteria] = useState<Criterion[]>([]);\r\n  //    \r\n  const [hasTempChanges, setHasTempChanges] = useState(false);\r\n  \r\n  //    \r\n  const isTemplateName = (name: string): boolean => {\r\n    return /^(||)\\s*\\d+(-\\d+)*$/.test(name);\r\n  };\r\n  \r\n  const isTemplateDescription = (description?: string): boolean => {\r\n    if (!description) return false;\r\n    return description === '   ' || \r\n           description === '  ' || \r\n           description.includes('  ') || \r\n           description === ' ';\r\n  };\r\n\r\n  // UI \r\n  const [actionMessage, setActionMessage] = useState<{type:'success'|'error'|'info', text:string}|null>(null);\r\n  const [pendingAction, setPendingAction] = useState<{type: 'reset' | 'deleteCriterion', criterionId?: string} | null>(null);\r\n\r\n  const showActionMessage = (type: 'success'|'error'|'info', text: string) => {\r\n    setActionMessage({type, text});\r\n    setTimeout(() => setActionMessage(null), 3000);\r\n  };\r\n\r\n  const [showTemplates, setShowTemplates] = useState(false);\r\n  const [showBulkInput, setShowBulkInput] = useState(false);\r\n  const [activeInputMode, setActiveInputMode] = useState<'template' | 'bulk' | 'visual' | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [layoutMode, setLayoutMode] = useState<'vertical' | 'horizontal'>('vertical');\r\n  const [editMode, setEditMode] = useState(false);\r\n  \r\n  //   \r\n  const [editingCriteria, setEditingCriteria] = useState<{[key: string]: {name: string, description: string}}>({});\r\n\r\n  //   \r\n  const loadCriteria = useCallback(async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const loadedCriteria = await cleanDataService.getCriteria(projectId);\r\n      \r\n      // parent_id, parent, level, order  \r\n      const normalizedCriteria = (loadedCriteria || []).map((c, index) => {\r\n        //  parent  parent_id   \r\n        // ID     \r\n        const parentId = c.parent || c.parent_id || null;\r\n\r\n        return {\r\n          id: String(c.id || generateUUID()), // ID  \r\n          name: c.name,\r\n          description: c.description,\r\n          parent_id: parentId ? String(parentId) : null, // parent_id  \r\n          level: c.level || 1,\r\n          order: c.order || c.position || index + 1,\r\n          weight: c.weight || 1,\r\n          type: 'criteria' as const,\r\n          children: []\r\n        };\r\n      });\r\n      \r\n      //   \r\n      const hierarchicalCriteria = buildHierarchy(normalizedCriteria);\r\n\r\n      setCriteria(hierarchicalCriteria);\r\n      setSavedCriteria(hierarchicalCriteria);\r\n      setTempCriteria([]);\r\n      setHasTempChanges(false);\r\n    } catch (error) {\r\n      showActionMessage('error', '    .');\r\n      setCriteria([]);\r\n      setSavedCriteria([]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [projectId]);\r\n\r\n  //   \r\n  const buildHierarchy = (flatCriteria: Criterion[]): Criterion[] => {\r\n    const criteriaMap = new Map<string, Criterion>();\r\n    const rootCriteria: Criterion[] = [];\r\n\r\n    //     - ID  \r\n    flatCriteria.forEach(criterion => {\r\n      const idString = String(criterion.id);\r\n      criteriaMap.set(idString, { ...criterion, id: idString, children: [] });\r\n    });\r\n\r\n    //   \r\n    flatCriteria.forEach(criterion => {\r\n      const idString = String(criterion.id);\r\n      const criterionObj = criteriaMap.get(idString);\r\n      if (!criterionObj) return;\r\n\r\n      // parent_id  \r\n      const parentIdString = criterion.parent_id ? String(criterion.parent_id) : null;\r\n\r\n      // parent_id      \r\n      if (parentIdString && criteriaMap.has(parentIdString)) {\r\n        const parent = criteriaMap.get(parentIdString);\r\n        if (parent) {\r\n          parent.children = parent.children || [];\r\n          parent.children.push(criterionObj);\r\n          \r\n          //  level  level + 1  \r\n          const parentLevel = parent.level || 1;\r\n          criterionObj.level = parentLevel + 1;\r\n          \r\n        }\r\n      } else {\r\n        // parent_id        \r\n\r\n        //    rootCriteria \r\n        criterionObj.level = 1;\r\n        criterionObj.parent_id = null; //  parent_id  null \r\n        rootCriteria.push(criterionObj);\r\n      }\r\n    });\r\n\r\n    //   order \r\n    const sortByOrder = (items: Criterion[]) => {\r\n      items.sort((a, b) => (a.order || 0) - (b.order || 0));\r\n      items.forEach(item => {\r\n        if (item.children && item.children.length > 0) {\r\n          sortByOrder(item.children);\r\n        }\r\n      });\r\n    };\r\n    \r\n    sortByOrder(rootCriteria);\r\n\r\n    return rootCriteria;\r\n  };\r\n\r\n  //   \r\n  const flattenCriteria = (hierarchicalCriteria: Criterion[]): Criterion[] => {\r\n    const result: Criterion[] = [];\r\n    \r\n    const traverse = (items: Criterion[], parentId: string | null = null, level: number = 1) => {\r\n      items.forEach((item, index) => {\r\n        result.push({\r\n          ...item,\r\n          parent_id: parentId,\r\n          level: level,\r\n          order: index + 1,\r\n          children: undefined // children  \r\n        });\r\n        \r\n        if (item.children && item.children.length > 0) {\r\n          traverse(item.children, item.id, level + 1);\r\n        }\r\n      });\r\n    };\r\n    \r\n    traverse(hierarchicalCriteria);\r\n    return result;\r\n  };\r\n\r\n  //     \r\n  useEffect(() => {\r\n    if (projectId) {\r\n      loadCriteria();\r\n    }\r\n  }, [projectId, loadCriteria]);\r\n\r\n  //       \r\n  useEffect(() => {\r\n    const count = flattenCriteria(savedCriteria).length;\r\n    onCriteriaChange(count);\r\n  }, [savedCriteria, onCriteriaChange]);\r\n\r\n  //  - trigger\r\n  const handleReset = () => {\r\n    setPendingAction({ type: 'reset' });\r\n  };\r\n\r\n  //  - confirm\r\n  const confirmReset = async () => {\r\n    setPendingAction(null);\r\n    try {\r\n      setIsLoading(true);\r\n      const existingCriteria = await cleanDataService.getCriteria(projectId);\r\n      for (const criterion of existingCriteria) {\r\n        if (criterion.id) {\r\n          await cleanDataService.deleteCriteria(projectId, criterion.id);\r\n        }\r\n      }\r\n      setCriteria([]);\r\n      setSavedCriteria([]);\r\n      setTempCriteria([]);\r\n      setHasTempChanges(false);\r\n      showActionMessage('success', '  .');\r\n    } catch (error) {\r\n      showActionMessage('error', '    .');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  //  \r\n  const handleSaveCriteria = async () => {\r\n    //      ,    \r\n    const criteriaToSave = hasTempChanges ? tempCriteria : criteria;\r\n    const flatCriteria = flattenCriteria(criteriaToSave);\r\n    \r\n    if (flatCriteria.length === 0) {\r\n      showActionMessage('error', '  .');\r\n      return;\r\n    }\r\n\r\n    setIsSaving(true);\r\n    try {\r\n      //     (   )\r\n      const existingCriteria = await cleanDataService.getCriteria(projectId);\r\n      for (const criterion of existingCriteria) {\r\n        if (criterion.id) {\r\n          await cleanDataService.deleteCriteria(projectId, criterion.id);\r\n        }\r\n      }\r\n      \r\n      //   \r\n      let success = true;\r\n      const createdCriteriaMap = new Map<string, { id: string; level: number; name: string }>(); //  ID ->   \r\n      \r\n      //     (  ,    order )\r\n      const sortedCriteria = flatCriteria.sort((a, b) => {\r\n        if (a.level !== b.level) {\r\n          return a.level - b.level; //  \r\n        }\r\n        return (a.order || 0) - (b.order || 0); //    \r\n      });\r\n      \r\n      for (const criterion of sortedCriteria) {\r\n        //  ID  -  ID   ID \r\n        let parentId = null;\r\n        let resolvedLevel = criterion.level || 1;\r\n        \r\n        if (criterion.parent_id) {\r\n          if (createdCriteriaMap.has(criterion.parent_id)) {\r\n            //      ID \r\n            const parentCriteria = createdCriteriaMap.get(criterion.parent_id);\r\n\r\n            parentId = parentCriteria?.id;\r\n\r\n            //   + 1   \r\n            if (parentCriteria?.level !== undefined) {\r\n              resolvedLevel = parentCriteria.level + 1;\r\n            }\r\n          } else if (!isTempId(criterion.parent_id)) {\r\n            //  UUID    (  )\r\n            parentId = criterion.parent_id;\r\n          } else {\r\n            //  ID    -   \r\n            parentId = null;\r\n            resolvedLevel = 1; //   \r\n          }\r\n        }\r\n        \r\n        const criteriaData = {\r\n          project_id: projectId,\r\n          project: projectId,\r\n          name: criterion.name,\r\n          description: criterion.description || '',\r\n          level: resolvedLevel,\r\n          order: criterion.order || 0,\r\n          position: criterion.order || 0,\r\n          weight: criterion.weight || 1,\r\n          type: 'criteria' as const,\r\n          parent: parentId,\r\n          parent_id: parentId,\r\n          is_active: true\r\n        };\r\n        \r\n        const result = await cleanDataService.createCriteria(criteriaData);\r\n        if (!result) {\r\n          success = false;\r\n          break;\r\n        }\r\n        \r\n        //     (    )\r\n        //    \r\n        //   ID      \r\n        const mappedCriteria = {\r\n          id: result?.id ?? criterion.id, //  id  (fallback to original id)\r\n          level: resolvedLevel,\r\n          name: result?.name || criterion.name\r\n        };\r\n\r\n        createdCriteriaMap.set(criterion.id, mappedCriteria);\r\n      }\r\n\r\n      if (success) {\r\n        //     \r\n        await loadCriteria();\r\n        \r\n        showActionMessage('success', '  .');\r\n      } else {\r\n        throw new Error('   ');\r\n      }\r\n    } catch (error) {\r\n      showActionMessage('error', `    : ${error}`);\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  //   \r\n  const startEditing = (criterionId: string, name: string, description: string) => {\r\n    setEditingCriteria({\r\n      ...editingCriteria,\r\n      [criterionId]: { \r\n        name: isTemplateName(name) ? '' : name, \r\n        description: isTemplateDescription(description) ? '' : description \r\n      }\r\n    });\r\n  };\r\n\r\n  //    ( )\r\n  const saveInlineEdit = async (criterionId: string) => {\r\n    if (!editingCriteria[criterionId]) return;\r\n\r\n    const updateCriteria = (criteria: Criterion[]): Criterion[] => {\r\n      return criteria.map(criterion => {\r\n        if (criterion.id === criterionId) {\r\n          return {\r\n            ...criterion,\r\n            name: editingCriteria[criterionId].name,\r\n            description: editingCriteria[criterionId].description\r\n          };\r\n        }\r\n        if (criterion.children) {\r\n          return {\r\n            ...criterion,\r\n            children: updateCriteria(criterion.children)\r\n          };\r\n        }\r\n        return criterion;\r\n      });\r\n    };\r\n\r\n    const updatedCriteria = updateCriteria(hasTempChanges ? tempCriteria : criteria);\r\n    \r\n    //  UI \r\n    if (hasTempChanges) {\r\n      setTempCriteria(updatedCriteria);\r\n    } else {\r\n      setCriteria(updatedCriteria);\r\n      setTempCriteria(updatedCriteria);\r\n      setHasTempChanges(true);\r\n    }\r\n\r\n    //   \r\n    const newEditingCriteria = { ...editingCriteria };\r\n    delete newEditingCriteria[criterionId];\r\n    setEditingCriteria(newEditingCriteria);\r\n\r\n    //   \r\n    try {\r\n      await handleSaveCriteria();\r\n    } catch (error) {\r\n      showActionMessage('error', '  .  .');\r\n    }\r\n  };\r\n\r\n  //   \r\n  const cancelInlineEdit = (criterionId: string) => {\r\n    const newEditingCriteria = { ...editingCriteria };\r\n    delete newEditingCriteria[criterionId];\r\n    setEditingCriteria(newEditingCriteria);\r\n  };\r\n\r\n  //   \r\n  const moveCriterion = (criterionId: string, direction: 'up' | 'down') => {\r\n    const moveCriteriaInList = (criteria: Criterion[]): Criterion[] => {\r\n      const newCriteria = [...criteria];\r\n      const index = newCriteria.findIndex(c => c.id === criterionId);\r\n      \r\n      if (index === -1) {\r\n        //   \r\n        return newCriteria.map(criterion => ({\r\n          ...criterion,\r\n          children: criterion.children ? moveCriteriaInList(criterion.children) : undefined\r\n        }));\r\n      }\r\n      \r\n      const targetIndex = direction === 'up' ? index - 1 : index + 1;\r\n      \r\n      if (targetIndex >= 0 && targetIndex < newCriteria.length) {\r\n        //  \r\n        [newCriteria[index], newCriteria[targetIndex]] = [newCriteria[targetIndex], newCriteria[index]];\r\n        \r\n        // order  \r\n        newCriteria.forEach((criterion, idx) => {\r\n          criterion.order = idx;\r\n        });\r\n      }\r\n      \r\n      return newCriteria;\r\n    };\r\n\r\n    const updatedCriteria = moveCriteriaInList(hasTempChanges ? tempCriteria : criteria);\r\n    \r\n    if (hasTempChanges) {\r\n      setTempCriteria(updatedCriteria);\r\n    } else {\r\n      setCriteria(updatedCriteria);\r\n      setTempCriteria(updatedCriteria);\r\n      setHasTempChanges(true);\r\n    }\r\n  };\r\n\r\n  //   - trigger\r\n  const deleteCriterion = (criterionId: string) => {\r\n    setPendingAction({ type: 'deleteCriterion', criterionId });\r\n  };\r\n\r\n  //   - confirm\r\n  const confirmDeleteCriterion = () => {\r\n    if (!pendingAction?.criterionId) return;\r\n    const criterionId = pendingAction.criterionId;\r\n    setPendingAction(null);\r\n\r\n    const deleteCriteriaFromList = (criteria: Criterion[]): Criterion[] => {\r\n      return criteria\r\n        .filter(c => c.id !== criterionId)\r\n        .map(criterion => ({\r\n          ...criterion,\r\n          children: criterion.children ? deleteCriteriaFromList(criterion.children) : undefined\r\n        }));\r\n    };\r\n\r\n    const updatedCriteria = deleteCriteriaFromList(hasTempChanges ? tempCriteria : criteria);\r\n    \r\n    if (hasTempChanges) {\r\n      setTempCriteria(updatedCriteria);\r\n    } else {\r\n      setCriteria(updatedCriteria);\r\n      setTempCriteria(updatedCriteria);\r\n      setHasTempChanges(true);\r\n    }\r\n  };\r\n\r\n  //     \r\n  const renderEditableCriteriaList = (criteriaList: Criterion[]) => {\r\n    const flatCriteria = getAllCriteria(criteriaList);\r\n\r\n    return (\r\n      <div className=\"space-y-3\">\r\n        {flatCriteria.map((criterion) => {\r\n          const isEditing = editingCriteria[criterion.id];\r\n          const indent = (criterion.level - 1) * 24;\r\n          \r\n          return (\r\n            <div \r\n              key={criterion.id}\r\n              className=\"bg-white border border-gray-200 rounded-lg p-4 shadow-sm\"\r\n              style={{ marginLeft: `${indent}px` }}\r\n            >\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex-1 mr-4\">\r\n                  {isEditing ? (\r\n                    <div className=\"space-y-2\">\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingCriteria[criterion.id]?.name || ''}\r\n                        onChange={(e) => {\r\n                          setEditingCriteria({\r\n                            ...editingCriteria,\r\n                            [criterion.id]: {\r\n                              ...editingCriteria[criterion.id],\r\n                              name: e.target.value\r\n                            }\r\n                          });\r\n                        }}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-medium\"\r\n                        placeholder={isTemplateName(criterion.name) ? criterion.name : (criterion.level === 1 ? \":  \" : criterion.level === 2 ? \":  \" : \":  \")}\r\n                      />\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editingCriteria[criterion.id]?.description || ''}\r\n                        onChange={(e) => {\r\n                          setEditingCriteria({\r\n                            ...editingCriteria,\r\n                            [criterion.id]: {\r\n                              ...editingCriteria[criterion.id],\r\n                              description: e.target.value\r\n                            }\r\n                          });\r\n                        }}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\"\r\n                        placeholder={isTemplateDescription(criterion.description) ? criterion.description : (criterion.level === 1 ? \":      \" : criterion.level === 2 ? \":    \" : \":     \")}\r\n                      />\r\n                    </div>\r\n                  ) : (\r\n                    <div>\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <span className=\"text-lg\">\r\n                          {criterion.level === 1 ? '' : \r\n                           criterion.level === 2 ? '' : \r\n                           criterion.level === 3 ? '' : \r\n                           criterion.level === 4 ? '' : ''}\r\n                        </span>\r\n                        <span className=\"font-medium text-gray-900\">{criterion.name}</span>\r\n                        <span className=\"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded\">\r\n                          L{criterion.level}\r\n                        </span>\r\n                      </div>\r\n                      {criterion.description && (\r\n                        <div className=\"text-sm text-gray-600 mt-1 ml-7\">\r\n                          {criterion.description}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-1\">\r\n                  {isEditing ? (\r\n                    <>\r\n                      <button\r\n                        onClick={() => saveInlineEdit(criterion.id)}\r\n                        className=\"p-2 text-green-600 hover:bg-green-100 rounded-md transition-colors\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                      <button\r\n                        onClick={() => cancelInlineEdit(criterion.id)}\r\n                        className=\"p-2 text-gray-600 hover:bg-gray-100 rounded-md transition-colors\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <button\r\n                        onClick={() => startEditing(criterion.id, criterion.name, criterion.description || '')}\r\n                        className=\"p-2 text-blue-600 hover:bg-blue-100 rounded-md transition-colors\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                      <button\r\n                        onClick={() => moveCriterion(criterion.id, 'up')}\r\n                        className=\"p-2 text-gray-600 hover:bg-gray-100 rounded-md transition-colors\"\r\n                        title=\" \"\r\n                      >\r\n                        \r\n                      </button>\r\n                      <button\r\n                        onClick={() => moveCriterion(criterion.id, 'down')}\r\n                        className=\"p-2 text-gray-600 hover:bg-gray-100 rounded-md transition-colors\"\r\n                        title=\" \"\r\n                      >\r\n                        \r\n                      </button>\r\n                      <button\r\n                        onClick={() => deleteCriterion(criterion.id)}\r\n                        className=\"p-2 text-red-600 hover:bg-red-100 rounded-md transition-colors\"\r\n                        title=\"\"\r\n                      >\r\n                        \r\n                      </button>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  //   \r\n  const handleTemplateSelect = (template: CriteriaTemplate) => {\r\n    const convertTemplateStructure = (items: TemplateItem[], parentId: string | null = null, level: number = 1): Criterion[] => {\r\n      const result: Criterion[] = [];\r\n      \r\n      items.forEach((item, index) => {\r\n        const id = generateUUID();\r\n        const criterion: Criterion = {\r\n          id,\r\n          name: item.name,\r\n          description: item.description,\r\n          parent_id: parentId,\r\n          level,\r\n          order: index + 1,\r\n          weight: 1,\r\n          type: 'criteria',\r\n          children: []\r\n        };\r\n        \r\n        if (item.children && item.children.length > 0) {\r\n          criterion.children = convertTemplateStructure(item.children, id, level + 1);\r\n        }\r\n        \r\n        result.push(criterion);\r\n      });\r\n      \r\n      return result;\r\n    };\r\n    \r\n    const newCriteria = convertTemplateStructure(template.structure);\r\n    \r\n    //   \r\n    setTempCriteria(newCriteria);\r\n    setCriteria(newCriteria);\r\n    setHasTempChanges(true);\r\n    setShowTemplates(false);\r\n    setActiveInputMode(null);\r\n    \r\n    showActionMessage('success', `'${template.name}'  . ''    .`);\r\n  };\r\n\r\n  //   \r\n  const handleBulkImport = (importedCriteria: Criterion[]) => {\r\n    //  \r\n    if (!importedCriteria || importedCriteria.length === 0) {\r\n      showActionMessage('error', '  .');\r\n      return;\r\n    }\r\n    \r\n    // parent_id, level, order  \r\n    const normalizedCriteria = importedCriteria.map((criterion, index) => {\r\n      const normalized = {\r\n        ...criterion,\r\n        id: criterion.id || generateUUID(),\r\n        level: criterion.level || 1,\r\n        order: criterion.order || index + 1,\r\n        parent_id: criterion.parent_id || null,\r\n        type: 'criteria' as const\r\n      };\r\n\r\n      return normalized;\r\n    });\r\n\r\n    //   \r\n    const hierarchicalCriteria = buildHierarchy(normalizedCriteria);\r\n\r\n    //     fallback \r\n    if (hierarchicalCriteria.length === 0 && normalizedCriteria.length > 0) {\r\n      //      fallback\r\n      const fallbackCriteria = normalizedCriteria.map(criterion => ({\r\n        ...criterion,\r\n        level: 1,\r\n        parent_id: null,\r\n        children: []\r\n      }));\r\n\r\n      setTempCriteria(fallbackCriteria);\r\n      setCriteria(fallbackCriteria);\r\n      setHasTempChanges(true);\r\n      setShowBulkInput(false);\r\n      setActiveInputMode(null);\r\n      \r\n      showActionMessage('info', `         . (${normalizedCriteria.length})\\n     .`);\r\n      return;\r\n    }\r\n    \r\n    //     \r\n    setTempCriteria(hierarchicalCriteria);\r\n    setCriteria(hierarchicalCriteria);\r\n    setHasTempChanges(true);\r\n    setShowBulkInput(false);\r\n    setActiveInputMode(null);\r\n    \r\n    //      \r\n    const totalFlat = flattenCriteria(hierarchicalCriteria);\r\n    const levelStats = totalFlat.reduce((acc, c) => {\r\n      acc[c.level] = (acc[c.level] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<number, number>);\r\n    \r\n    const statsText = Object.entries(levelStats)\r\n      .map(([level, count]) => ` ${level}: ${count}`)\r\n      .join(', ');\r\n      \r\n    showActionMessage('success', `${normalizedCriteria.length}  . ${statsText} ''    .`);\r\n  };\r\n\r\n  //    \r\n  const convertVisualBuilderData = (builderCriteria: VisualCriteriaNode[]): Criterion[] => {\r\n    const result: Criterion[] = [];\r\n\r\n    const traverse = (nodes: VisualCriteriaNode[], parentId: string | null = null, level: number = 1) => {\r\n      nodes.forEach((node, index) => {\r\n        const criterion: Criterion = {\r\n          id: node.id || generateUUID(),\r\n          name: node.name,\r\n          description: node.description,\r\n          parent_id: parentId,\r\n          level,\r\n          order: index + 1,\r\n          weight: 1,\r\n          type: 'criteria',\r\n          children: []\r\n        };\r\n        \r\n        if (node.children && node.children.length > 0) {\r\n          criterion.children = traverse(node.children, criterion.id, level + 1);\r\n        }\r\n        \r\n        result.push(criterion);\r\n      });\r\n      \r\n      return result;\r\n    };\r\n    \r\n    return traverse(builderCriteria);\r\n  };\r\n\r\n  // Criterion CriteriaNode  ()\r\n  const convertToVisualNode = (criteria: Criterion[]): VisualCriteriaNode[] => {\r\n    return criteria.map(c => ({\r\n      id: c.id,\r\n      name: c.name,\r\n      description: c.description,\r\n      level: c.level,\r\n      parent_id: c.parent_id || null,\r\n      children: c.children ? convertToVisualNode(c.children) : [],\r\n      isExpanded: true\r\n    }));\r\n  };\r\n\r\n  //    \r\n  const handleVisualBuilderSave = (builderCriteria: VisualCriteriaNode[]) => {\r\n    const convertedCriteria = convertVisualBuilderData(builderCriteria);\r\n    \r\n    //   \r\n    setTempCriteria(convertedCriteria);\r\n    setCriteria(convertedCriteria);\r\n    setHasTempChanges(true);\r\n    \r\n    showActionMessage('success', `${convertedCriteria.length}    . ''    .`);\r\n  };\r\n\r\n  //    ( )\r\n  const getAllCriteria = (criteriaList: Criterion[]): Criterion[] => {\r\n    return flattenCriteria(criteriaList);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {actionMessage && (\r\n        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg ${actionMessage.type === 'success' ? 'bg-green-100 text-green-800' : actionMessage.type === 'info' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`}>\r\n          {actionMessage.text}\r\n        </div>\r\n      )}\r\n      <Card title=\"  \">\r\n        <div className=\"space-y-6\">\r\n          {/*    */}\r\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n            <h4 className=\"font-medium text-blue-900 mb-2\">   </h4>\r\n            <p className=\"text-sm text-blue-700\">\r\n                    .\r\n                   .\r\n            </p>\r\n            {hasTempChanges && (\r\n              <div className=\"mt-2 p-2 bg-yellow-100 border border-yellow-300 rounded\">\r\n                <p className=\"text-sm text-yellow-800\">\r\n                      . ''   .\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/*     */}\r\n          <div className=\"border-b pb-4\">\r\n            <h4 className=\"font-medium text-gray-900 mb-3\">  </h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n              <div className=\"relative\">\r\n                <Button\r\n                  variant={activeInputMode === 'template' ? 'primary' : 'outline'}\r\n                  onClick={() => {\r\n                    setActiveInputMode('template');\r\n                    setShowTemplates(true);\r\n                    setShowBulkInput(false);\r\n                  }}\r\n                  className=\"flex items-center justify-center w-full\"\r\n                  title=\"        .\"\r\n                >\r\n                  <span className=\"mr-2\"></span>\r\n                    \r\n                </Button>\r\n              </div>\r\n              \r\n              <div className=\"relative\">\r\n                <Button\r\n                  variant={activeInputMode === 'bulk' ? 'primary' : 'outline'}\r\n                  onClick={() => {\r\n                    setActiveInputMode('bulk');\r\n                    setShowBulkInput(true);\r\n                    setShowTemplates(false);\r\n                  }}\r\n                  className=\"flex items-center justify-center w-full\"\r\n                  title=\"       . , ,   .\"\r\n                >\r\n                  <span className=\"mr-2\"></span>\r\n                    \r\n                </Button>\r\n              </div>\r\n              \r\n              <div className=\"relative\">\r\n                <Button\r\n                  variant={activeInputMode === 'visual' ? 'primary' : 'outline'}\r\n                  onClick={() => {\r\n                    setActiveInputMode(activeInputMode === 'visual' ? null : 'visual');\r\n                    setShowTemplates(false);\r\n                    setShowBulkInput(false);\r\n                  }}\r\n                  className=\"flex items-center justify-center w-full\"\r\n                  title=\"       .\"\r\n                >\r\n                  <span className=\"mr-2\"></span>\r\n                   \r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/*       */}\r\n          <div className=\"min-h-[300px]\">\r\n            {activeInputMode === 'visual' ? (\r\n              //   \r\n              <div className=\"border border-gray-200 rounded-lg p-4\">\r\n                <VisualCriteriaBuilder\r\n                  initialCriteria={convertToVisualNode(criteria)}\r\n                  onSave={handleVisualBuilderSave}\r\n                  onClose={() => setActiveInputMode(null)}\r\n                />\r\n              </div>\r\n            ) : criteria.length > 0 ? (\r\n              <div>\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                  <h4 className=\"font-medium text-gray-900\"> </h4>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <button\r\n                      onClick={() => setEditMode(!editMode)}\r\n                      className={`px-3 py-1 text-sm rounded-md transition-colors ${\r\n                        editMode \r\n                          ? 'bg-green-100 text-green-700 border border-green-300' \r\n                          : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                      }`}\r\n                    >\r\n                      {editMode ? '  ' : ' '}\r\n                    </button>\r\n                    {!editMode && (\r\n                      <>\r\n                        <button\r\n                          onClick={() => setLayoutMode('vertical')}\r\n                          className={`px-3 py-1 text-sm rounded-md transition-colors ${\r\n                            layoutMode === 'vertical' \r\n                              ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                          }`}\r\n                        >\r\n                           \r\n                        </button>\r\n                        <button\r\n                          onClick={() => setLayoutMode('horizontal')}\r\n                          className={`px-3 py-1 text-sm rounded-md transition-colors ${\r\n                            layoutMode === 'horizontal' \r\n                              ? 'bg-blue-100 text-blue-700 border border-blue-300' \r\n                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n                          }`}\r\n                        >\r\n                           \r\n                        </button>\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                {editMode ? (\r\n                  <div className=\"space-y-4\">\r\n                    {renderEditableCriteriaList(hasTempChanges ? tempCriteria : criteria)}\r\n                  </div>\r\n                ) : (\r\n                  <HierarchyTreeVisualization \r\n                    nodes={getAllCriteria(criteria)}\r\n                    title=\"\"\r\n                    showWeights={false}\r\n                    interactive={true}\r\n                    layout={layoutMode}\r\n                    onLayoutChange={setLayoutMode}\r\n                  />\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg\">\r\n                <div className=\"text-gray-500\">\r\n                  <div className=\"text-4xl mb-3\"></div>\r\n                  <p className=\"text-lg font-medium\"> </p>\r\n                  <p className=\"text-sm mt-2\">       </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/*   */}\r\n          {criteria.length > 0 && (\r\n            <div className=\"bg-gray-50 rounded-lg p-4\">\r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-gray-900\">\r\n                    {getAllCriteria(criteria).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\"> </div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-gray-900\">\r\n                    {criteria.filter(c => c.level === 1).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\"> </div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-gray-900\">\r\n                    {getAllCriteria(criteria).filter(c => c.level > 1).length}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\"> </div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-2xl font-bold text-gray-900\">\r\n                    {Math.max(...getAllCriteria(criteria).map(c => c.level), 0)}\r\n                  </div>\r\n                  <div className=\"text-sm text-gray-600\"> </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/*   */}\r\n          <div className=\"flex justify-between items-center pt-4 border-t\">\r\n            <Button\r\n              variant=\"secondary\"\r\n              onClick={handleReset}\r\n              disabled={isLoading || criteria.length === 0}\r\n              className=\"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200\"\r\n            >\r\n               \r\n            </Button>\r\n            \r\n            <div className=\"flex space-x-3\">\r\n              {onComplete && (\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={onComplete}\r\n                  disabled={isLoading || savedCriteria.length === 0}\r\n                >\r\n                   \r\n                </Button>\r\n              )}\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={handleSaveCriteria}\r\n                disabled={isLoading || isSaving || criteria.length === 0}\r\n              >\r\n                {isSaving ? ' ...' : ''}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n\r\n      {/*    */}\r\n      {showTemplates && (\r\n        <CriteriaTemplates\r\n          onSelectTemplate={handleTemplateSelect}\r\n          onClose={() => {\r\n            setShowTemplates(false);\r\n            setActiveInputMode(null);\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/*    */}\r\n      {showBulkInput && (\r\n        <BulkCriteriaInput\r\n          onImport={handleBulkImport}\r\n          onCancel={() => {\r\n            setShowBulkInput(false);\r\n            setActiveInputMode(null);\r\n          }}\r\n          existingCriteria={criteria}\r\n        />\r\n      )}\r\n\r\n      {/*   */}\r\n      <Modal\r\n        isOpen={pendingAction !== null}\r\n        onClose={() => setPendingAction(null)}\r\n        title={pendingAction?.type === 'reset' ? ' ' : ' '}\r\n        size=\"sm\"\r\n        footer={\r\n          <div className=\"flex justify-end space-x-2\">\r\n            <button\r\n              onClick={() => setPendingAction(null)}\r\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\"\r\n            >\r\n              \r\n            </button>\r\n            <button\r\n              onClick={pendingAction?.type === 'reset' ? confirmReset : confirmDeleteCriterion}\r\n              className=\"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md\"\r\n            >\r\n              {pendingAction?.type === 'reset' ? '' : ''}\r\n            </button>\r\n          </div>\r\n        }\r\n      >\r\n        {pendingAction?.type === 'reset' && (\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-gray-700\">  ?</p>\r\n            <p className=\"text-sm text-red-600 font-medium\">    .</p>\r\n          </div>\r\n        )}\r\n        {pendingAction?.type === 'deleteCriterion' && (\r\n          <p className=\"text-sm text-gray-700\">  ?</p>\r\n        )}\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CriteriaManagement;","import React, { useState, useEffect } from 'react';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport Input from '../common/Input';\r\nimport dataService from '../../services/dataService_clean';\r\nimport { AlternativeData, criteriaApi } from '../../services/api';\r\n\r\ninterface Alternative extends Omit<AlternativeData, 'project_id' | 'position' | 'id'> {\r\n  id: string; // required\r\n  order: number;\r\n  weight?: number;\r\n  rank?: number;\r\n}\r\n\r\ninterface AlternativeManagementProps {\r\n  projectId: string;\r\n  onComplete: () => void;\r\n  onAlternativesChange?: (alternativesCount: number) => void;\r\n}\r\n\r\nconst AlternativeManagement: React.FC<AlternativeManagementProps> = ({ projectId, onComplete, onAlternativesChange }) => {\r\n  const [alternatives, setAlternatives] = useState<Alternative[]>([]);\r\n\r\n  // AlternativeData Alternative \r\n  const convertToAlternative = (data: AlternativeData): Alternative => ({\r\n    id: data.id || `alt_${Date.now()}_${Math.random()}`,\r\n    name: data.name,\r\n    description: data.description,\r\n    order: data.position || 0,\r\n    cost: data.cost,\r\n    weight: 0,\r\n    rank: 0\r\n  });\r\n\r\n  // Alternative AlternativeData \r\n  const convertToAlternativeData = (alt: Partial<Alternative>): Omit<AlternativeData, 'id'> => ({\r\n    project_id: projectId,\r\n    name: alt.name || '',\r\n    description: alt.description || '',\r\n    position: alt.order || 0,\r\n    cost: alt.cost\r\n  });\r\n\r\n  useEffect(() => {\r\n    //     (PostgreSQL)\r\n    const loadProjectAlternatives = async () => {\r\n      try {\r\n        const alternativesData = await dataService.getAlternatives(projectId);\r\n        const convertedAlternatives = (alternativesData || []).map(convertToAlternative);\r\n        setAlternatives(convertedAlternatives);\r\n\r\n        //    \r\n        if (onAlternativesChange) {\r\n          onAlternativesChange(convertedAlternatives.length);\r\n        }\r\n      } catch (error) {\r\n        setAlternatives([]);\r\n        if (onAlternativesChange) {\r\n          onAlternativesChange(0);\r\n        }\r\n      }\r\n    };\r\n\r\n    if (projectId) {\r\n      loadProjectAlternatives();\r\n    }\r\n  }, [projectId, onAlternativesChange]);\r\n\r\n  //       \r\n  useEffect(() => {\r\n    if (onAlternativesChange) {\r\n      onAlternativesChange(alternatives.length);\r\n    }\r\n  }, [alternatives, onAlternativesChange]);\r\n\r\n  const [newAlternative, setNewAlternative] = useState({ name: '', description: '' });\r\n  const [editingId, setEditingId] = useState<string | null>(null);\r\n  const [editingAlternative, setEditingAlternative] = useState({ name: '', description: '' });\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n  const [actionMessage, setActionMessage] = useState<{type:'success'|'error'|'info', text:string}|null>(null);\r\n\r\n  const showActionMessage = (type: 'success'|'error'|'info', text: string) => {\r\n    setActionMessage({type, text});\r\n    setTimeout(() => setActionMessage(null), 3000);\r\n  };\r\n\r\n  const validateAlternative = (name: string, excludeId?: string): boolean => {\r\n    const newErrors: Record<string, string> = {};\r\n\r\n    if (!name.trim()) {\r\n      newErrors.name = ' .';\r\n    } else if (name.length < 2) {\r\n      newErrors.name = ' 2  .';\r\n    } else {\r\n      // Check for duplicate names\r\n      const isDuplicate = alternatives.some(alt => \r\n        alt.name.toLowerCase() === name.toLowerCase() && alt.id !== excludeId\r\n      );\r\n      if (isDuplicate) {\r\n        newErrors.name = '   .';\r\n      }\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleAddAlternative = async () => {\r\n    if (!validateAlternative(newAlternative.name)) {\r\n      return;\r\n    }\r\n\r\n    const maxOrder = Math.max(...alternatives.map(alt => alt.order), 0);\r\n\r\n    try {\r\n      const alternativeData = convertToAlternativeData({\r\n        name: newAlternative.name,\r\n        description: newAlternative.description || '',\r\n        order: maxOrder + 1\r\n      });\r\n\r\n      const createdAlternative = await dataService.createAlternative(alternativeData);\r\n\r\n      if (!createdAlternative) {\r\n        setErrors({ name: '  .' });\r\n        return;\r\n      }\r\n      \r\n      //   \r\n      const updatedAlternativesData = await dataService.getAlternatives(projectId);\r\n      const convertedUpdatedAlternatives = (updatedAlternativesData || []).map(convertToAlternative);\r\n      setAlternatives(convertedUpdatedAlternatives);\r\n      \r\n      setNewAlternative({ name: '', description: '' });\r\n      setErrors({});\r\n      \r\n      //     \r\n      if (onAlternativesChange) {\r\n        onAlternativesChange(convertedUpdatedAlternatives.length);\r\n      }\r\n    } catch (error) {\r\n      setErrors({ name: '    .  .' });\r\n    }\r\n  };\r\n\r\n  const handleEditAlternative = (id: string) => {\r\n    const alternative = alternatives.find(alt => alt.id === id);\r\n    if (alternative) {\r\n      setEditingId(id);\r\n      setEditingAlternative({ name: alternative.name, description: alternative.description || '' });\r\n    }\r\n  };\r\n\r\n  const handleSaveEdit = async () => {\r\n    if (!editingId || !validateAlternative(editingAlternative.name, editingId)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await criteriaApi.updateCriteria(editingId, {\r\n        name: editingAlternative.name,\r\n        description: editingAlternative.description,\r\n        project_id: projectId\r\n      });\r\n      if (!response.success) {\r\n        setErrors({ general: response.error || '  .' });\r\n        return;\r\n      }\r\n      setAlternatives(prev => prev.map(alt =>\r\n        alt.id === editingId\r\n          ? { ...alt, name: editingAlternative.name, description: editingAlternative.description }\r\n          : alt\r\n      ));\r\n      setEditingId(null);\r\n      setEditingAlternative({ name: '', description: '' });\r\n      setErrors({});\r\n    } catch (error: unknown) {\r\n      setErrors({ general: (error instanceof Error ? error.message : '') || '    .' });\r\n    }\r\n  };\r\n\r\n  const handleCancelEdit = () => {\r\n    setEditingId(null);\r\n    setEditingAlternative({ name: '', description: '' });\r\n    setErrors({});\r\n  };\r\n\r\n  const handleDeleteAlternative = async (id: string) => {\r\n    try {\r\n      const success = await dataService.deleteAlternative(id, projectId);\r\n\r\n      if (!success) {\r\n        return;\r\n      }\r\n      \r\n      //   \r\n      const updatedAlternativesData = await dataService.getAlternatives(projectId);\r\n      const convertedUpdatedAlternatives = (updatedAlternativesData || []).map(convertToAlternative);\r\n      setAlternatives(convertedUpdatedAlternatives);\r\n      \r\n      //     \r\n      if (onAlternativesChange) {\r\n        onAlternativesChange(convertedUpdatedAlternatives.length);\r\n      }\r\n    } catch (error) {\r\n      showActionMessage('error', '    .');\r\n    }\r\n  };\r\n\r\n  const handleMoveUp = (id: string) => {\r\n    const index = alternatives.findIndex(alt => alt.id === id);\r\n    if (index > 0) {\r\n      const newAlternatives = [...alternatives];\r\n      [newAlternatives[index], newAlternatives[index - 1]] = [newAlternatives[index - 1], newAlternatives[index]];\r\n      \r\n      // Update order values\r\n      newAlternatives.forEach((alt, idx) => {\r\n        alt.order = idx + 1;\r\n      });\r\n      \r\n      setAlternatives(newAlternatives);\r\n    }\r\n  };\r\n\r\n  const handleMoveDown = (id: string) => {\r\n    const index = alternatives.findIndex(alt => alt.id === id);\r\n    if (index < alternatives.length - 1) {\r\n      const newAlternatives = [...alternatives];\r\n      [newAlternatives[index], newAlternatives[index + 1]] = [newAlternatives[index + 1], newAlternatives[index]];\r\n      \r\n      // Update order values\r\n      newAlternatives.forEach((alt, idx) => {\r\n        alt.order = idx + 1;\r\n      });\r\n      \r\n      setAlternatives(newAlternatives);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {actionMessage && (\r\n        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg text-sm font-medium shadow-lg ${actionMessage.type === 'success' ? 'bg-green-100 text-green-800' : actionMessage.type === 'info' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800'}`}>\r\n          {actionMessage.text}\r\n        </div>\r\n      )}\r\n      <Card title=\" \">\r\n        <div className=\"space-y-6\">\r\n          {/*      */}\r\n          <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 border-l-4 border-green-400 p-4 rounded-r-lg mb-4\">\r\n            <div className=\"flex items-start\">\r\n              <div className=\"flex-shrink-0\">\r\n                <svg className=\"h-5 w-5 text-green-600 mt-0.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                  <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </div>\r\n              <div className=\"ml-3\">\r\n                <h3 className=\"text-sm font-semibold text-green-800\">   :  3 </h3>\r\n                <div className=\"mt-2 text-sm text-green-700\">\r\n                  <p className=\"mb-2\">   <strong>3 </strong>   . (  5  )</p>\r\n                  <ul className=\"list-disc list-inside space-y-1 text-xs\">\r\n                    <li> : 3  = 3, 4  = 6, 5  = 10</li>\r\n                    <li>3   3  =  12   </li>\r\n                    <li>     </li>\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n            <h4 className=\"font-medium text-green-900 mb-2\">    </h4>\r\n            <ul className=\"text-sm text-green-700 space-y-1\">\r\n              <li>      </li>\r\n              <li>    </li>\r\n              <li>       </li>\r\n              <li>    ,     </li>\r\n              <li>         </li>\r\n            </ul>\r\n          </div>\r\n\r\n          {/* Current Alternatives List */}\r\n          <div>\r\n            <h4 className=\"font-medium text-gray-900 mb-3\">   </h4>\r\n            {alternatives.length === 0 ? (\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                   .\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                {alternatives\r\n                  .sort((a, b) => a.order - b.order)\r\n                  .map((alternative, index) => (\r\n                    <div\r\n                      key={alternative.id}\r\n                      className=\"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white hover:bg-gray-50\"\r\n                    >\r\n                      <div className=\"flex items-center flex-1\">\r\n                        <div className=\"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-800 rounded-full text-sm font-medium mr-4\">\r\n                          {alternative.order}\r\n                        </div>\r\n                        \r\n                        {editingId === alternative.id ? (\r\n                          <div className=\"flex-1 grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                            <Input\r\n                              id={`edit-name-${alternative.id}`}\r\n                              label=\"\"\r\n                              placeholder=\" \"\r\n                              value={editingAlternative.name}\r\n                              onChange={(value) => setEditingAlternative(prev => ({ ...prev, name: value }))}\r\n                              error={errors.name}\r\n                            />\r\n                            <Input\r\n                              id={`edit-desc-${alternative.id}`}\r\n                              label=\"\"\r\n                              placeholder=\"  ()\"\r\n                              value={editingAlternative.description}\r\n                              onChange={(value) => setEditingAlternative(prev => ({ ...prev, description: value }))}\r\n                            />\r\n                          </div>\r\n                        ) : (\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <div>\r\n                                <h5 className=\"font-medium text-gray-900\">{alternative.name}</h5>\r\n                                {alternative.description && (\r\n                                  <p className=\"text-sm text-gray-600\">{alternative.description}</p>\r\n                                )}\r\n                              </div>\r\n                              <div className=\"flex items-center space-x-3\">\r\n                                {alternative.rank && (\r\n                                  <div className=\"text-xs font-semibold\">\r\n                                    <span className=\"bg-yellow-100 text-yellow-800 px-2 py-1 rounded\">\r\n                                      #{alternative.rank}\r\n                                    </span>\r\n                                  </div>\r\n                                )}\r\n                                {alternative.weight && (\r\n                                  <div className=\"text-xs font-mono bg-blue-100 text-blue-800 px-2 py-1 rounded\">\r\n                                    {(alternative.weight * 100).toFixed(3)}%\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center space-x-2 ml-4\">\r\n                        {editingId === alternative.id ? (\r\n                          <>\r\n                            <button\r\n                              onClick={handleSaveEdit}\r\n                              className=\"text-green-600 hover:text-green-800 text-sm font-medium\"\r\n                            >\r\n                              \r\n                            </button>\r\n                            <button\r\n                              onClick={handleCancelEdit}\r\n                              className=\"text-gray-600 hover:text-gray-800 text-sm\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            <button\r\n                              onClick={() => handleMoveUp(alternative.id)}\r\n                              disabled={index === 0}\r\n                              className={`text-sm ${index === 0 ? 'text-gray-300' : 'text-blue-600 hover:text-blue-800'}`}\r\n                              title=\" \"\r\n                            >\r\n                              \r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleMoveDown(alternative.id)}\r\n                              disabled={index === alternatives.length - 1}\r\n                              className={`text-sm ${index === alternatives.length - 1 ? 'text-gray-300' : 'text-blue-600 hover:text-blue-800'}`}\r\n                              title=\" \"\r\n                            >\r\n                              \r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleEditAlternative(alternative.id)}\r\n                              className=\"text-blue-600 hover:text-blue-800 text-sm\"\r\n                              title=\"\"\r\n                            >\r\n                              \r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleDeleteAlternative(alternative.id)}\r\n                              className=\"text-red-500 hover:text-red-700 text-sm\"\r\n                              title=\"\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Add New Alternative */}\r\n          <div className=\"border-t pt-6\">\r\n            <h4 className=\"font-medium text-gray-900 mb-4\">   </h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n              <Input\r\n                id=\"alternativeName\"\r\n                label=\"\"\r\n                placeholder=\" \"\r\n                value={newAlternative.name}\r\n                onChange={(value) => setNewAlternative(prev => ({ ...prev, name: value }))}\r\n                error={errors.name}\r\n                required\r\n              />\r\n\r\n              <Input\r\n                id=\"alternativeDescription\"\r\n                label=\"  ()\"\r\n                placeholder=\"  \"\r\n                value={newAlternative.description}\r\n                onChange={(value) => setNewAlternative(prev => ({ ...prev, description: value }))}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex justify-end\">\r\n              <Button onClick={handleAddAlternative} variant=\"primary\">\r\n                 \r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Summary with Paper Recommendation */}\r\n          <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <div>\r\n                <h5 className=\"font-medium text-gray-900\"> </h5>\r\n                <p className=\"text-sm text-gray-600\">\r\n                   {alternatives.length}  \r\n                  {alternatives.length === 3 && <span className=\"ml-2 text-green-600 font-semibold\">   </span>}\r\n                  {alternatives.length > 0 && alternatives.length < 3 && <span className=\"ml-2 text-yellow-600\"> 3 </span>}\r\n                  {alternatives.length > 5 && <span className=\"ml-2 text-orange-600\">   </span>}\r\n                </p>\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">\r\n                {alternatives.length > 0 && (\r\n                  <span> : {alternatives.map(alt => alt.name).join('  ')}</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex justify-between items-center pt-6 border-t\">\r\n            <div className=\"text-sm text-gray-600\">\r\n              {alternatives.length === 0 && (\r\n                <div className=\"bg-blue-50 p-3 rounded-lg border border-blue-200\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <span className=\"text-blue-600\"></span>\r\n                    <div>\r\n                      <div className=\"font-medium text-blue-900\">  </div>\r\n                      <div className=\"text-sm text-blue-700\">    AHP  .</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"flex space-x-3\">\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={async () => {\r\n                  showActionMessage('success', '  .');\r\n                }}\r\n              >\r\n                \r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={onComplete}\r\n              >\r\n                 \r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AlternativeManagement;"],"names":["_ref","projectId","onComplete","onEvaluatorsChange","maxEvaluators","currentPlan","evaluators","setEvaluators","useState","pendingDeleteId","setPendingDeleteId","actionMessage","setActionMessage","showActionMessage","type","text","setTimeout","evaluationStats","setEvaluationStats","total","pending","active","completed","useEffect","async","base","window","location","href","split","replace","convertedEvaluators","cleanDataService","getEvaluators","map","evaluator","evalLink","access_key","concat","undefined","id","project_id","name","email","status","progress","code","String","Math","floor","random","padStart","inviteLink","demographicSurveyCompleted","updateEvaluationStats","length","error","loadProjectEvaluators","newEvaluator","setNewEvaluator","errors","setErrors","generateAccessKey","array","Uint8Array","crypto","getRandomValues","Array","from","byte","join","evaluatorList","stats","filter","e","_jsxs","className","children","_jsx","Modal","isOpen","onClose","title","size","footer","Button","variant","onClick","deleteEvaluator","updatedEvaluators","Card","_evaluator$access_key","substring","department","experience","demographicSurveyUrl","open","navigator","clipboard","writeText","_evaluator$id","evaluatorId","prev","_objectSpread","showQR","QRCode","value","JSON","stringify","evaluationUrl","surveyUrl","accessKey","level","includeMargin","_evaluator$id2","handleSendInvite","_evaluator$id3","general","Input","label","placeholder","onChange","required","newErrors","trim","test","some","Object","keys","validateEvaluator","evaluatorData","createdEvaluator","createEvaluator","newEval","Error","message","nodes","showWeights","interactive","onNodeClick","onNodeDelete","layout","onLayoutChange","allowDelete","pendingDeleteNode","setPendingDeleteNode","hierarchy","flatNodes","nodeMap","Map","rootNodes","forEach","node","set","nodeWithChildren","get","parent_id","has","parent","push","buildHierarchy","getNodeIcon","getNodeColor","renderVerticalNode","index","_node$children$length","_node$children","_node$children2","isLast","arguments","hasChildren","isClickable","_Fragment","style","height","width","marginLeft","description","weight","toFixed","stopPropagation","child","childIndex","_node$children$length2","_node$children3","childIsLast","renderHorizontalNode","_node$children$length3","_node$children4","_node$children$length4","_node$children5","_node$children6","marginRight","_node$children$length5","_node$children7","deleteModal","parseText","lines","line","criteria","nameMap","success","i","parsed","this","parseLine","lowerName","toLowerCase","structureErrors","validateHierarchy","lineNumber","numberedMatch","match","number","content","includes","p","extractNameAndDescription","markdownMatch","indent","spaces","indentMatch","plainMatch","dashMatch","colonMatch","parenthesesMatch","c","levelSet","Set","levels","sort","a","b","getExampleTexts","markdown","numbered","indented","onImport","onCancel","existingCriteria","inputText","setInputText","activeTab","setActiveTab","parseResult","setParseResult","isProcessing","setIsProcessing","convertParsedCriteriaFlat","parsedCriteria","allCriteria","levelParentMap","Date","now","parentLevel","parentNode","criterion","order","delete","getAllCriteria","criteriaList","all","traverse","items","item","exampleTexts","TextParser","target","handleParse","result","existingNames","duplicates","d","disabled","levelCounts","reduce","acc","entries","_ref2","count","paddingLeft","_ref3","key","handleImport","convertedCriteria","validationErrors","idSet","CRITERIA_TEMPLATES","icon","structure","onSelectTemplate","template","slice","idx","initialCriteria","onSave","isInline","setCriteria","isExpanded","selectedNodeId","setSelectedNodeId","draggedNodeId","setDraggedNodeId","findNode","found","updateNode","updates","addNode","parentId","_findNode","newNode","isEditing","addChildToParent","confirmDeleteNode","removeNode","toggleEditMode","_findNode2","handleDragOver","preventDefault","dataTransfer","dropEffect","renderNode","depth","isSelected","draggable","onDragStart","handleDragStart","nodeId","effectAllowed","onDragOver","onDrop","handleDrop","targetId","draggedNode","isDescendantOf","ancestorId","searchId","ancestor","check","n","fixLevels","newParentId","insertAtTarget","movedNode","_findNode3","updateNodeName","autoFocus","updateNodeDescription","onDoubleClick","flattenCriteria","getStats","flatten","onCriteriaChange","savedCriteria","setSavedCriteria","tempCriteria","setTempCriteria","hasTempChanges","setHasTempChanges","isTemplateName","isTemplateDescription","pendingAction","setPendingAction","showTemplates","setShowTemplates","showBulkInput","setShowBulkInput","activeInputMode","setActiveInputMode","isLoading","setIsLoading","isSaving","setIsSaving","layoutMode","setLayoutMode","editMode","setEditMode","editingCriteria","setEditingCriteria","loadCriteria","useCallback","normalizedCriteria","getCriteria","generateUUID","position","hierarchicalCriteria","flatCriteria","criteriaMap","rootCriteria","idString","criterionObj","parentIdString","sortByOrder","handleSaveCriteria","deleteCriteria","createdCriteriaMap","sortedCriteria","_result$id","resolvedLevel","parentCriteria","isTempId","criteriaData","project","is_active","createCriteria","mappedCriteria","moveCriterion","criterionId","direction","moveCriteriaInList","newCriteria","findIndex","targetIndex","updatedCriteria","convertToVisualNode","VisualCriteriaBuilder","builderCriteria","convertVisualBuilderData","_editingCriteria$crit","_editingCriteria$crit2","updateCriteria","newEditingCriteria","saveInlineEdit","cancelInlineEdit","startEditing","deleteCriterion","renderEditableCriteriaList","HierarchyTreeVisualization","max","handleReset","CriteriaTemplates","convertTemplateStructure","BulkCriteriaInput","importedCriteria","fallbackCriteria","levelStats","statsText","confirmDeleteCriterion","deleteCriteriaFromList","onAlternativesChange","alternatives","setAlternatives","convertToAlternative","data","cost","rank","convertedAlternatives","dataService","getAlternatives","loadProjectAlternatives","newAlternative","setNewAlternative","editingId","setEditingId","editingAlternative","setEditingAlternative","validateAlternative","excludeId","alt","handleSaveEdit","response","criteriaApi","handleCancelEdit","fill","viewBox","fillRule","clipRule","alternative","newAlternatives","handleMoveUp","handleMoveDown","find","handleEditAlternative","deleteAlternative","convertedUpdatedAlternatives","handleDeleteAlternative","maxOrder","alternativeData","createAlternative"],"sourceRoot":""}