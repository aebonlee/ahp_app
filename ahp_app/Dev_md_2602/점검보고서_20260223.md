# AHP Decision Support Platform - 전체 점검 보고서

**작성일**: 2026-02-23
**작성**: Claude Opus 4.6
**빌드 상태**: Compiled successfully (0 errors, 0 warnings)
**번들 크기**: main.js 162.78KB (gzip)

---

## 1. 프로젝트 개요

| 항목 | 내용 |
|------|------|
| 기술 스택 | React 18 + TypeScript + Tailwind CSS |
| 백엔드 | Django REST Framework (Render 배포) |
| 배포 | GitHub Pages (프론트엔드) |
| URL | https://aebonlee.github.io/ahp_app/ |

---

## 2. 코드베이스 정량 분석

### 2.1 파일 구성

| 항목 | 수치 |
|------|------|
| TypeScript/TSX 파일 | 253+ |
| CSS 파일 | 5 |
| React 컴포넌트 | 180+ |
| 서비스 파일 | 14 |
| 커스텀 훅 | 11 |
| Context | 5 |
| 유틸리티 | 25+ (분석 8개 포함) |
| 라우트 설정 | 80+ |
| Lazy 로딩 컴포넌트 | 40+ |
| 테스트 파일 | 20 |

### 2.2 빌드 결과

| 청크 | 크기 (gzip) | 비고 |
|------|-------------|------|
| main.js | 162.78 KB | 주 번들 |
| 119.chunk.js | 102.33 KB | 2번째 (recharts 추정) |
| 166.chunk.js | 80.02 KB | 3번째 (exceljs 추정) |
| main.css | 26.01 KB | Tailwind |
| 기타 48 chunks | 1.68~22.06 KB | 코드 스플리팅 적용 |
| **총 JS chunks** | **51개** | lazy loading 효과 |

### 2.3 npm 의존성

| 구분 | 수 |
|------|-----|
| dependencies | 43 |
| devDependencies | 5 |
| npm audit 취약점 | **72건** (low 1, moderate 5, high 66) |

**주요 취약점**:
- `react-router@6.x` → XSS via Open Redirect (high)
- `axios@1.x` → DoS via `__proto__` mergeConfig (high)
- `glob`, `minimatch` → ReDoS/Command Injection (high, react-scripts 의존)
- `node-forge` → ASN.1 Unbounded Recursion (high)
- `qs`, `express` → arrayLimit bypass DoS (high)
- `webpack@5.x` → SSRF via buildHttp (high)

> 대부분 `react-scripts` 의존 체인의 간접 취약점. `npm audit fix`로 3건(react-router, axios, node-forge, qs, webpack) 수정 가능. 나머지는 react-scripts 업그레이드(CRA→Vite 전환) 필요.

---

## 3. 품질 지표 상세

### 3.1 타입 안전성

| 지표 | 수치 | 평가 |
|------|------|------|
| `any` 타입 사용 | **60건** | 주의 |
| `import type` 사용 | 41건/35파일 | 양호 |

**`any` 분포 (상위 5)**:
| 파일 | 건수 | 비고 |
|------|------|------|
| `services/api.ts` | 21 | API 응답 타입 미확정 |
| `tests/utils/realTimeSync.test.ts` | 12 | 테스트 mock |
| `components/admin/AdminOnlyDashboard.tsx` | 4 | 이벤트 핸들러 |
| `setupTests.ts` | 3 | Jest 설정 |
| 기타 16파일 | 20 | 산발적 |

**판정**: `api.ts`의 21건이 핵심. 제네릭 `ApiResponse<T>` 강화로 대폭 감소 가능.

### 3.2 성능 최적화

| 지표 | 수치 | 평가 |
|------|------|------|
| `React.memo` 사용 | **0건** | 미흡 |
| `useMemo/useCallback` | 155건/43파일 | 양호 |
| Lazy 로딩 | 40+컴포넌트 | 우수 |
| ErrorBoundary | 1건 | 기본 |

**판정**: `React.memo` 미사용이 가장 큰 개선 여지. 대시보드/테이블 렌더링 최적화 가능.

### 3.3 접근성 (a11y)

| 지표 | 수치 | 평가 |
|------|------|------|
| `aria-label` | 5건 | 부족 |
| `aria-describedby` | 2건 | 부족 |
| `aria-pressed/modal` | 2건 | 최소 |
| `role=` | 6건 | 부족 |
| **총 ARIA 속성** | **15건** | 매우 부족 |
| 적용 파일 | 7개/180+ | **3.9%** |

**판정**: 180+ 컴포넌트 중 7개만 접근성 속성 적용. WCAG 2.1 기준 미달. 공공기관 납품 시 법적 요건 불충족.

### 3.4 보안

| 항목 | 상태 | 비고 |
|------|------|------|
| innerHTML XSS | ✅ 수정 | DOM API 교체 완료 |
| XOR 암호화 | ✅ 수정 | AES-GCM + PBKDF2 교체 |
| JWT 저장소 | ✅ 수정 | sessionStorage 전환 |
| 전역변수 노출 | ✅ 수정 | `__SUPER_ADMIN__` 제거 |
| Admin 이메일 하드코딩 | ✅ 수정 | 환경 분기 적용 |
| 토큰 URL 노출 | ✅ 수정 | history.replaceState 적용 |
| **localStorage 평문 저장** | ⚠️ 잔존 | 108건, API 키 포함 |
| **npm 취약점** | ⚠️ 잔존 | 72건 (66 high) |

**판정**: 자체 코드 보안은 양호. npm 의존성과 localStorage 사용이 잔여 리스크.

### 3.5 코드 품질

| 지표 | 수치 | 평가 |
|------|------|------|
| TODO/FIXME | 0건 | 우수 |
| console.* 문 | 80건 | 주의 |
| 미사용 파일 | 0건 | 우수 |
| 300줄 초과 파일 | 10+건 | 주의 |

**대형 파일 (상위 5)**:
| 파일 | 줄 수 | 상태 |
|------|-------|------|
| `PersonalServiceDashboard.tsx` | ~4,000 | 분할 필요 |
| `SuperAdminDashboard.tsx` | ~1,000 | 분할 필요 |
| `api.ts` | ~834 | 리팩토링 필요 |
| `ahpCalculations.ts` | ~619 | 허용 |
| `fileUploadService.ts` | ~550 | 허용 |
| `anonymousEvaluationService.ts` | ~500 | 허용 |
| `EnhancedEvaluatorManagement.tsx` | ~500 | 분할 검토 |

**console.* 분포 (상위 5)**:
| 파일 | 건수 | 유형 |
|------|------|------|
| `systemHealthCheck.ts` | 19 | 진단 도구 (의도적) |
| `connectionTest.ts` | 12 | 진단 도구 (의도적) |
| `realTimeSync.ts` | 8 | WebSocket 로깅 |
| `anonymousEvaluationService.ts` | 7 | 서비스 디버깅 |
| `fileUploadService.ts` | 7 | 업로드 추적 |

> 진단 도구(systemHealthCheck, connectionTest) 31건은 의도적 로깅. 서비스 파일 49건은 프로덕션에서 `console.warn` → 에러 리포팅 서비스로 전환 권장.

### 3.6 테스트

| 지표 | 수치 | 평가 |
|------|------|------|
| 테스트 파일 | 20개 | 부족 |
| 컴포넌트 테스트 | 6개 | 부족 |
| 유틸 테스트 | 6개 | 기본 |
| 서비스 테스트 | 2개 | 부족 |
| 통합 테스트 | 1개 | 최소 |
| E2E 테스트 | 0개 | 미구현 |
| **추정 커버리지** | **~5%** | 매우 부족 |

---

## 4. 완료 현황 총괄

### Phase 1 - 리팩토링 & 안정화 (7/7 = 100%)

| # | 작업 | 상태 | 세부 |
|---|------|------|------|
| 1a | React.lazy() 코드 스플리팅 | ✅ | 40+ 컴포넌트 |
| 1b | AppRouter 분리 | ✅ | routeConfig 80+ 라우트, AuthGuard/ProjectGuard |
| 1c | 비즈니스 로직 Hook 분리 | ✅ | 훅 6개 추출 |
| 1d | 보안 취약점 패치 | ✅ | 6건 패치 |
| 1e | App.tsx 분해 | ✅ | 1,985줄 → 22줄 |
| 1f | 상태 관리 도입 | ✅ | Context 5개 + AppProviders |
| 1g | 프로덕션 로그 정리 | ✅ | 13건 제거 |

### Phase 2 - 핵심 기능 (2/3 = 67%)

| # | 작업 | 상태 | 세부 |
|---|------|------|------|
| 2a | 평가자 초대 시스템 | ✅ FE | 타입/서비스/훅 (백엔드 대기) |
| 2b | WebSocket 실시간 협업 | ⏳ 대기 | Django Channels 필요 |
| 2c | 고급 분석 알고리즘 | ✅ 완료 | 5개 알고리즘 유틸리티 |

### Phase 3 - 수익화 (0/3 = 0%)

| # | 작업 | 상태 | 세부 |
|---|------|------|------|
| 3a | Stripe 결제 시스템 | ⏳ 설계만 완료 | 구현 대기 |
| 3b | 구독 플랜 관리 | ⏳ 대기 | 설계 미완 |
| 3c | 청구서 생성 | ⏳ 대기 | 설계 미완 |

---

## 5. 종합 품질 점수

| 카테고리 | 점수 | 이전 | 변화 | 비고 |
|----------|------|------|------|------|
| 아키텍처 | **9/10** | 3/10 | +6 | App.tsx 22줄, Context 5개, 훅 11개 |
| 타입 안전성 | **8/10** | 9/10 | -1 | any 60건 (api.ts 집중) |
| 코드 스플리팅 | **9/10** | 9/10 | = | 51 chunks, lazy loading |
| 보안 | **7/10** | 5/10 | +2 | 자체 코드 패치 완료, npm 잔존 |
| 성능 | **6/10** | 5/10 | +1 | useMemo 155건, React.memo 0건 |
| 코드 품질 | **7/10** | 4/10 | +3 | TODO 0건, 미사용 0건, 대형파일 잔존 |
| 접근성 | **2/10** | 3/10 | -1 | ARIA 15건/180+ 컴포넌트 |
| 테스트 | **3/10** | 4/10 | -1 | 20 파일, ~5% 커버리지 |
| 모바일 대응 | **7/10** | 7/10 | = | Tailwind 반응형 기본 적용 |
| **종합** | **6.4/10** | **5.6/10** | **+0.8** | 아키텍처 대폭 개선, a11y/테스트 과제 |

---

## 6. 위험도별 이슈 분류

### CRITICAL (즉시 조치)

| # | 이슈 | 영향 | 조치 |
|---|------|------|------|
| C1 | localStorage API 키 평문 저장 | API 키 탈취 시 과금 피해 | secureStorage.ts 래핑 적용 |
| C2 | npm 취약점 72건 (high 66) | XSS, DoS, SSRF 가능 | `npm audit fix` + 패키지 업데이트 |

### HIGH (1주 내 조치)

| # | 이슈 | 영향 | 조치 |
|---|------|------|------|
| H1 | PSD 4,000줄 모놀리식 | 유지보수 불가, 빌드 느림 | 탭별 하위 컴포넌트 분할 |
| H2 | `any` 타입 60건 | 런타임 타입 에러 가능 | api.ts 제네릭 강화 |
| H3 | console.* 49건 (서비스) | 프로덕션 정보 노출 | 에러 리포팅 서비스 전환 |

### MEDIUM (2주 내 조치)

| # | 이슈 | 영향 | 조치 |
|---|------|------|------|
| M1 | React.memo 0건 | 불필요한 리렌더링 | 대시보드/리스트에 적용 |
| M2 | 접근성 ARIA 15건 | WCAG 미달, 사용성 저하 | 핵심 UI에 aria-* 추가 |
| M3 | 테스트 커버리지 ~5% | 회귀 버그 위험 | 핵심 유틸/훅 테스트 추가 |
| M4 | ErrorBoundary 1건 | 에러 시 전체 앱 크래시 | 라우트별 Boundary 추가 |

### LOW (백로그)

| # | 이슈 | 영향 | 조치 |
|---|------|------|------|
| L1 | 대시보드 변형 20+개 | 코드 중복 | 통합 검토 |
| L2 | 번들 main.js 162KB | 초기 로딩 지연 | bundle analyzer + tree shaking |
| L3 | 다크모드 일관성 | UX | 테마 변수 검증 |

---

## 7. 차기 계획 (로드맵)

### Phase 2.5 - 코드 품질 강화 (1주)

**목표**: 종합 점수 6.4 → 7.5

| # | 작업 | 우선순위 | 예상 효과 |
|---|------|----------|-----------|
| 1 | `npm audit fix` 실행 | P0 | 취약점 72→~15건 |
| 2 | localStorage API키 → secureStorage 래핑 | P0 | 보안 7→8 |
| 3 | `api.ts` any 21건 → 제네릭 타입 교체 | P1 | 타입 8→9 |
| 4 | PSD 4,000줄 → 탭별 5~8개 하위 컴포넌트 분할 | P1 | 코드품질 7→8 |
| 5 | console.* 49건 → 조건부 로깅 유틸 적용 | P1 | 보안 8→8.5 |
| 6 | React.memo 핵심 컴포넌트 10+개 적용 | P2 | 성능 6→7 |
| 7 | ErrorBoundary 라우트별 추가 (3~4개) | P2 | 안정성 향상 |

### Phase 2.6 - 접근성 & 테스트 (1~2주)

**목표**: a11y 2→5, 테스트 3→6

| # | 작업 | 우선순위 | 예상 효과 |
|---|------|----------|-----------|
| 8 | 공통 컴포넌트(Button, Input, Modal, Card) aria-* 추가 | P1 | a11y 2→4 |
| 9 | Skip navigation + 키보드 내비게이션 | P2 | a11y 4→5 |
| 10 | ahpCalculator + 핵심 유틸 단위 테스트 | P1 | 테스트 3→4 |
| 11 | 커스텀 훅 6개 테스트 (useAuth, useProjects 등) | P1 | 테스트 4→5 |
| 12 | API 서비스 모킹 테스트 | P2 | 테스트 5→6 |
| 13 | Cypress/Playwright E2E 기초 (로그인→프로젝트 생성→평가) | P2 | 테스트 품질 |

### Phase 2b - WebSocket 실시간 협업 (백엔드 필요)

| # | 작업 | 의존성 | 설명 |
|---|------|--------|------|
| 14 | Django Channels + Redis 셋업 | 백엔드 | WebSocket 인프라 |
| 15 | 프론트엔드 WebSocket 클라이언트 | #14 | 실시간 협업 UI |
| 16 | 충돌 해소 + 세션 관리 | #15 | 동시 편집 처리 |

### Phase 3 - 수익화 (2~3주)

| # | 작업 | 의존성 | 설명 |
|---|------|--------|------|
| 17 | Stripe Checkout + Webhook 구현 | 없음 | 결제 통합 |
| 18 | 구독 플랜 관리 UI | #17 | 플랜 전환, 취소 |
| 19 | 사용량 모니터링 + 제한 | #18 | API 크레딧 시스템 |
| 20 | 청구서 PDF 생성 | #18 | exceljs 활용 |

### Phase 4 - 프로덕션 준비 (2주)

| # | 작업 | 의존성 | 설명 |
|---|------|--------|------|
| 21 | CRA → Vite 전환 | 없음 | 빌드 속도 + npm 취약점 해소 |
| 22 | 번들 최적화 (tree shaking, chunk 분석) | #21 | main.js 162→120KB 목표 |
| 23 | 모바일 반응형 전면 검증 | 없음 | Lighthouse mobile 점수 |
| 24 | SEO + OG 태그 | 없음 | 소셜 공유 최적화 |
| 25 | CI/CD 파이프라인 (GitHub Actions) | 없음 | 자동 빌드/테스트/배포 |

---

## 8. 권장 실행 순서

```
즉시 (오늘)
├── C1. npm audit fix
└── C2. localStorage API 키 보호

1주차 - Phase 2.5
├── #3. api.ts any 타입 정리
├── #4. PSD 컴포넌트 분할
├── #5. console.* 정리
├── #6. React.memo 적용
└── #7. ErrorBoundary 확장

2주차 - Phase 2.6
├── #8. 공통 컴포넌트 a11y
├── #9. 키보드 내비게이션
├── #10-12. 테스트 추가
└── 목표: 종합 7.5/10

3~4주차 - Phase 3
├── #17-20. 결제 시스템
└── 수익화 인프라 구축

5~6주차 - Phase 4
├── #21-22. Vite 전환 + 번들 최적화
├── #23-24. 모바일 + SEO
└── #25. CI/CD
```

---

## 9. 결론

### 성과
- **아키텍처 혁신**: App.tsx 1,985줄 → 22줄, Context 5개, 훅 11개로 현대적 구조 달성
- **보안 강화**: 자체 코드 취약점 6건 모두 패치 (innerHTML XSS, XOR→AES-GCM, JWT hardening 등)
- **Phase 1 100% 완료**: 7개 리팩토링 작업 모두 완료
- **고급 분석 엔진**: Monte Carlo, Tornado, AIJ/AIP/Shannon, Pareto, Robustness 5개 알고리즘 구현
- **빌드 안정**: 0 errors, 0 warnings, 0 TODO/FIXME

### 과제
- **접근성 2/10**: WCAG 기준 심각하게 미달, 공공기관 납품 시 법적 리스크
- **테스트 3/10**: 5% 커버리지로 회귀 버그 위험 상존
- **npm 취약점 72건**: react-scripts 의존 체인 문제, Vite 전환으로 근본 해결
- **대형 파일**: PSD 4,000줄 분할 필수

### 목표 일정
- **2주 후**: 종합 7.5/10 (코드 품질 + a11y + 테스트 강화)
- **4주 후**: Phase 3 수익화 기반 구축
- **6주 후**: 프로덕션 준비 완료 (Vite + CI/CD + 모바일)

---

**작성**: Claude Opus 4.6
**검증**: `npm run build` Compiled successfully
**다음 작업**: Phase 2.5 #1 `npm audit fix` 실행
