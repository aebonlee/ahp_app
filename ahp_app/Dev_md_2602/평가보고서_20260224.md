# 개발 상태 평가보고서 — 2026-02-24

## 1. 프로젝트 개요

| 항목 | 값 |
|------|-----|
| 프로젝트명 | AHP Research Platform (ahp-research-platform) |
| 버전 | 1.0.0 |
| 스택 | React 18.2 + TypeScript 4.9 + TailwindCSS 3.4 |
| 백엔드 | Django REST Framework (Render.com) |
| DB | PostgreSQL (Render.com) |
| 배포 | GitHub Pages (`/ahp_app/`) + GitHub Actions CI/CD |
| 번들 크기 | main.js **162.34KB** (gzip) |
| 리포지토리 | https://github.com/aebonlee/ahp_app |
| 라이브 URL | https://aebonlee.github.io/ahp_app |

---

## 2. 코드베이스 규모 (정밀 측정)

| 영역 | 파일 수 | 줄 수 |
|------|---------|-------|
| 컴포넌트 (components/) | 180+ .tsx | ~103,500줄 |
| 서비스 (services/) | 12 .ts | 5,460줄 |
| 훅 (hooks/) | 10 .ts/.tsx | 1,359줄 |
| 유틸리티 (utils/) | 26 .ts | 6,815줄 |
| 컨텍스트 (contexts/) | 5 .tsx | 287줄 |
| 타입 (types/) | 5 .ts | 566줄 |
| 설정 (config/) | 2 .ts | 167줄 |
| 페이지/라우트/기타 | 다수 | ~  |
| **합계** | **299+** | **~118,200줄** |

### 컴포넌트 분포 (상위 10개 디렉토리)

| 디렉토리 | 파일 수 | 주요 역할 |
|----------|---------|----------|
| admin/ | 44 | 관리자 대시보드, 프로젝트/평가자/모델 관리 |
| common/ | 30 | 재사용 UI 컴포넌트 (Button, Modal, Card 등) |
| evaluation/ | 21 | 평가 워크플로우, QR코드, 직접입력, 퍼지 |
| auth/ | 12 | 로그인, 회원가입, 2FA, OAuth |
| analysis/ | 12 | 결과 분석, 민감도, 몬테카를로, 그룹 합의 |
| evaluator/ | 10 | 평가자 전용 대시보드 및 워크플로우 |
| superadmin/ | 8 | 시스템 관리, 전체 프로젝트, 결제 |
| project/ | 6 | 프로젝트 생성 위자드, 실시간 모니터링 |
| criteria/ | 5 | 기준 편집기, 계층 시각화 |
| ai-*/ | 5 | AI 챗봇, 논문/자료 생성, 품질 검증, 결과 해석 |

---

## 3. 아키텍처 현황

### 데이터 흐름 (Phase 3 이후)
```
Django REST API (Render.com)
  ↕
config/api.ts (API_ENDPOINTS 정의, API_BASE_URL)
  ↕
services/api.ts (makeRequest + 토큰 갱신 일원화)
  ↕                          ↕
services/authService.ts   services/dataService_clean.ts
  (JWT 관리, 세션)           (비즈니스 래퍼)
  ↕
hooks/ (useAuth, useProjects, useNavigation, useBackendStatus...)
  ↕
contexts/ (AuthContext, ProjectContext, UIContext, NavigationContext)
  ↕
AppProviders → AppContent → components/ (UI 렌더링)
```

### Phase 3 이후 정리된 서비스 레이어

| 서비스 | 줄 수 | 역할 | 상태 |
|--------|-------|------|------|
| api.ts | 924 | 핵심 HTTP 클라이언트 + 10개 API 모듈 | ✅ 통합 완료 |
| authService.ts | 424 | JWT 토큰 관리, 세션, 자동 갱신 | ✅ 정상 |
| anonymousEvaluationService.ts | 580 | 익명 평가 세션 관리 | ✅ sessionStorage 전환 완료 |
| dataService_clean.ts | 563 | 비즈니스 로직 래퍼 | ✅ 정상 |
| djangoAdminService.ts | 453 | Django 관리자 통합 | ✅ 정상 |
| fileUploadService.ts | 561 | 파일 업로드 관리 | ✅ 정상 |
| systemManagementService.ts | 460 | 시스템 관리 API | ✅ 정상 |
| sessionService.ts | 345 | 세션 유효성 관리 | ✅ 정상 |
| aiService.ts | 362 | AI 서비스 통합 | ✅ 정상 |
| twoFactorService.ts | 337 | 2FA TOTP 관리 | ✅ 정상 |
| subscriptionService.ts | 310 | 구독 관리 | ✅ 정상 |
| invitationService.ts | 146 | 평가자 초대 관리 | ✅ 정상 |
| ~~apiService.ts~~ | ~~376~~ | ~~폐기된 API 래퍼~~ | ❌ Phase 3에서 삭제 |
| ~~dataService.ts~~ | ~~241~~ | ~~중복 데이터 래퍼~~ | ❌ Phase 3에서 삭제 |

---

## 4. 완료된 작업 Phase별 정리

### Phase 1: 기반 안정화 ✅ 완료 (7/7)

| 단계 | 작업 | 성과 |
|------|------|------|
| 1a | React.lazy() 코드 스플리팅 | App.tsx 2,309줄 → 22줄 |
| 1b | AppRouter 분리 | AppContent + routes 구조화 |
| 1c | 비즈니스 로직 Hook 분리 | 6개 커스텀 훅 추출 |
| 1d | 보안 취약점 패치 | 5건 패치 완료 |
| 1e | 라우트 맵 + 가드 | RouteGuard 컴포넌트 |
| 1f | Context API | 5개 Context + AppProviders |
| 1g | 프로덕션 console.* 정리 | 13건 제거 |

### Phase 2: 핵심 기능 구현 ✅ 완료

| 단계 | 작업 | 성과 |
|------|------|------|
| 2a | 평가자 초대 시스템 FE | 타입/서비스/훅 인프라 |
| 2c | 고급 분석 알고리즘 | 5개 유틸리티 (Monte Carlo, 민감도, 그룹 합의, Pareto, 강건성) |

### Phase 2.5: 코드 품질 ✅ 완료 (7/7)

| # | 작업 | 성과 |
|---|------|------|
| 1 | npm audit fix | 취약점 72→60건 (12건 수정) |
| 2 | secureStorage 래핑 | localStorage API키 암호화 |
| 3 | any 타입 제거 | 21→4건 (제네릭 교체) |
| 4 | PSD 분할 | 4,360줄 → 2,553줄 (-41%) |
| 5 | logger 유틸 적용 | console.* 49건 → logger (35건 교체) |
| 6 | React.memo 적용 | 18개 핵심 컴포넌트 |
| 7 | ErrorBoundary 배치 | 3개 지점 |

### Phase 3: 서비스 레이어 통합 ✅ 완료

| 단계 | 작업 | 성과 |
|------|------|------|
| 3a | 토큰 갱신 일원화 (C1) | 이중 구현 → authService 단일 위임 |
| 3b | dataService.ts 제거 (C2) | -241줄, 3개 소비자 마이그레이션 |
| 3c | apiService.ts 제거 (H1) | -376줄, 18개 소비자 마이그레이션 |
| 3d | axios 제거 (H3) | 3개 파일 fetch 전환 |
| C3 | sessionStorage 전환 | localStorage XSS 취약점 해결 |

### 기타 주요 수정

| 작업 | 커밋 | 성과 |
|------|------|------|
| API 엔드포인트 8건 수정 | 72bf38d | 프론트-백엔드 URL 불일치 해결 |
| 401 토큰 자동 갱신 | 72bf38d | makeRequest에서 자동 재시도 |
| SUPER_ADMIN_EMAIL 수정 | d422129 | 프로덕션 빌드 빈 문자열 버그 |
| PUBLIC_URL 누락 수정 | 7c2a1ff | 평가 테스트 404 해결 |
| effectiveSuperAdminMode | 3e396d5 | 모드 전환 일관성 |
| Sidebar 역할 전환 | 6건 | 버튼 표시/위치/동작 안정화 |
| CI/CD 자동 배포 | ci.yml | GitHub Actions → Pages |
| 폐기 브랜치 정리 | 4개 삭제 | 6개 → 2개 (main + gh-pages) |

---

## 5. 정량 평가

### 코드 품질 지표

| 지표 | 값 | 평가 |
|------|-----|------|
| TypeScript 에러 | **0개** | ✅ 우수 |
| ESLint 경고 | ~350개 (CI 비차단) | ⚠️ 개선 필요 |
| any 타입 잔여 | **4개** (advancedAnalysisApi 제네릭) | ✅ 양호 |
| console.log/warn | **0개** (logger 유틸 사용) | ✅ 우수 |
| TODO/FIXME | **5개** (설명성 코멘트) | ✅ 양호 |
| React.memo 적용 | **18개** 컴포넌트 | ✅ 양호 |
| ErrorBoundary | **3개** 지점 | ✅ 양호 |
| 번들 크기 | **162.34KB** (gzip) | ✅ 우수 |
| npm 취약점 | **60개** (모두 CRA 의존성) | ⚠️ CRA 교체 시 해결 |
| axios 런타임 사용 | **0건** | ✅ 우수 |

### 아키텍처 평가

| 영역 | 점수 | 근거 |
|------|------|------|
| 컴포넌트 구조 | ★★★★☆ | 40+ 디렉토리 체계적 분류, 일부 대형 컴포넌트 잔존 |
| 서비스 레이어 | ★★★★★ | Phase 3 통합 후 단일 진입점 (api.ts), 중복 제거 |
| 상태 관리 | ★★★★☆ | Context API 5개 적절 분리, Redux 불필요 |
| 타입 안전성 | ★★★★☆ | strict: true, any 4개만 잔존 |
| 보안 | ★★★★☆ | sessionStorage 전환, secureStorage 래핑, 토큰 자동 갱신 |
| 테스트 | ★★☆☆☆ | 테스트 파일 존재하나 커버리지 미측정, CI 비차단 |
| 배포/CI | ★★★★☆ | GitHub Actions 자동 빌드+배포, 소스맵 비노출 |
| 번들 최적화 | ★★★★★ | 162KB gzip, 코드 스플리팅 적용 |
| 문서화 | ★★★☆☆ | 개발일지 41건, 보고서 다수, 인라인 문서 부족 |

### 종합 점수: **4.0 / 5.0** (양호~우수)

---

## 6. 잔존 이슈 분류

### CRITICAL (즉시 대응 필요)

없음 — Phase 3에서 C1, C2, C3 전량 해결

### HIGH (차기 Sprint 대응)

| # | 이슈 | 상세 | 예상 공수 |
|---|------|------|-----------|
| H1 | 불필요한 서버사이드 의존성 | `pg`, `node-fetch`, `@anthropic-ai/claude-agent-sdk`이 프론트엔드 package.json에 존재 | 0.5h |
| H2 | QR코드 라이브러리 중복 | `qrcode` + `qrcode.react` + `react-qr-code` 3개 → 1개로 통합 | 1h |
| H3 | @types/* devDependencies 이동 | @types/*, @testing-library/* 등이 dependencies에 위치 | 0.5h |
| H4 | anonymousEvaluationService 중복 코드 | sessionStorage 호출 중복 (lines 80, 168-173, 563-568) | 0.5h |
| H5 | apiService 잔존 import 확인 | 13개 컴포넌트에서 `apiService` 문자열 발견 (빌드는 통과) | 2h |

### MEDIUM (Phase 4 범위)

| # | 이슈 | 상세 |
|---|------|------|
| M1 | advancedAnalysisApi `<T = any>` | 4건 제네릭 타입을 구체적 타입으로 교체 |
| M2 | ESLint 경고 350건 | 체계적 정리 (unused imports, 미사용 변수 등) |
| M3 | 테스트 커버리지 | 현재 커버리지 미측정, CI에서 비차단 |
| M4 | 대형 컴포넌트 분할 | 500줄 이상 컴포넌트 식별 및 분할 |
| M5 | CRA → Vite 마이그레이션 | npm 취약점 60건 근본 해결 + 빌드 속도 개선 |

### LOW (장기 개선)

| # | 이슈 | 상세 |
|---|------|------|
| L1 | AI 컴포넌트 디렉토리 통합 | ai-chatbot, ai-paper, ai-materials, ai-quality, ai-interpretation → ai/ |
| L2 | i18n 다국어 지원 | 현재 한국어 하드코딩 |
| L3 | 접근성 (a11y) | ARIA 라벨, 키보드 내비게이션 |
| L4 | PWA 지원 | 오프라인 기능, 푸시 알림 |
| L5 | E2E 테스트 | Playwright/Cypress 도입 |

---

## 7. 의존성 분석

### 프로덕션 의존성 현황 (23개)

| 카테고리 | 패키지 | 필요성 |
|----------|--------|--------|
| **코어** | react, react-dom, react-router-dom, react-scripts, typescript | ✅ 필수 |
| **UI** | @headlessui/react, @heroicons/react, @tailwindcss/* | ✅ 필수 |
| **아이콘** | @fortawesome/* (4개), lucide-react | ⚠️ 하나로 통합 가능 |
| **차트** | recharts | ✅ 필수 |
| **QR코드** | qrcode, qrcode.react, react-qr-code | ⚠️ 1개로 충분 |
| **파티클** | react-particles, tsparticles-engine, tsparticles-slim | ⚠️ 장식적 — 제거 검토 |
| **엑셀** | exceljs | ✅ 필수 |
| **HTTP** | axios | ⚠️ 런타임 사용 0 — 제거 가능 |
| **서버사이드** | pg, node-fetch, @anthropic-ai/claude-agent-sdk | ❌ 프론트엔드에 불필요 |

### 제거 후보 (7개 패키지)

1. `axios` — 런타임 사용 0건 (fetch로 전환 완료)
2. `pg` — PostgreSQL 클라이언트 (서버사이드 전용)
3. `node-fetch` — Node.js HTTP (서버사이드 전용)
4. `@anthropic-ai/claude-agent-sdk` — AI SDK (서버사이드 전용)
5. `qrcode` — react-qr-code 하나로 충분
6. `qrcode.react` — 중복
7. `react-particles` + `tsparticles-*` (3개) — 장식적 효과

---

## 8. CI/CD 파이프라인 평가

### 현재 구성

```
Push to main (src/**, public/**, package.json 등)
  → GitHub Actions (ubuntu-latest, Node 20)
    → npm ci
    → Lint (비차단)
    → Build (CI=false, PUBLIC_URL=/ahp_app)
    → Test (비차단)
    → Upload artifact
    → Deploy to GitHub Pages (actions/deploy-pages@v4)
```

### 평가

| 항목 | 상태 | 비고 |
|------|------|------|
| 자동 빌드 | ✅ | Push 시 자동 실행 |
| 자동 배포 | ✅ | build-and-test 성공 시 자동 |
| Lint | ⚠️ | 비차단 (continue-on-error: true) |
| 테스트 | ⚠️ | 비차단 + passWithNoTests |
| 소스맵 | ✅ | GENERATE_SOURCEMAP=false |
| 캐싱 | ✅ | npm cache 활용 |

### 개선 제안
1. Lint를 차단 모드로 변경 (경고 수 줄인 후)
2. 테스트 커버리지 임계값 설정
3. 번들 크기 감시 (200KB 초과 시 경고)
4. Lighthouse CI 추가

---

## 9. 보안 평가

| 항목 | 상태 | 상세 |
|------|------|------|
| JWT 토큰 저장 | ✅ | sessionStorage (XSS 방어) |
| 토큰 자동 갱신 | ✅ | 만료 5분 전 자동 갱신 |
| 401 자동 재시도 | ✅ | makeRequest에서 1회 재시도 |
| 익명 세션 | ✅ | sessionStorage 전환 완료 (C3) |
| secureStorage | ✅ | API 키 등 암호화 래핑 |
| CORS | ✅ | 백엔드에서 설정 |
| 소스맵 노출 | ✅ | 빌드 시 비생성 |
| npm 취약점 | ⚠️ | 60건 (CRA 의존성, 런타임 무관) |
| 서버사이드 패키지 | ⚠️ | pg, node-fetch 번들 포함 가능성 |

---

## 10. 결론 및 권장사항

### 강점
1. **TypeScript strict 모드 0 에러** — 타입 안전성 확보
2. **서비스 레이어 단일화** — api.ts 중심 깔끔한 구조
3. **162KB 번들** — 118K줄 코드베이스 대비 우수한 최적화
4. **자동 CI/CD** — Push 시 빌드+배포 자동화
5. **포괄적 기능** — AHP, Fuzzy AHP, Monte Carlo, 그룹 합의, AI 통합

### 약점
1. **테스트 부재** — 커버리지 미측정, CI 비차단
2. **불필요한 의존성** — 서버사이드 패키지 3개, 중복 QR 3개
3. **ESLint 경고 과다** — 350건 비차단 처리
4. **대형 컴포넌트 잔존** — 500줄+ 컴포넌트 다수
5. **CRA 미지원** — react-scripts 사후 지원 종료, Vite 전환 필요

### 차기 우선순위 (2일 후 재개 시)

| 순위 | 작업 | 근거 |
|------|------|------|
| 1 | 불필요 의존성 정리 | 빠른 성과, 번들 크기 감소 |
| 2 | apiService 잔존 import 정리 | 런타임 에러 가능성 차단 |
| 3 | 대형 컴포넌트 분할 | 유지보수성 향상 |
| 4 | advancedAnalysisApi 타입 강화 | any 4건 → 구체적 타입 |
| 5 | ESLint 경고 정리 | 코드 품질 지표 개선 |
| 6 | 테스트 커버리지 구축 | 안정성 확보 |
| 7 | CRA → Vite 마이그레이션 | 근본적 빌드 도구 현대화 |

---

**작성**: Claude Opus 4.6
**작성일**: 2026-02-24
**프로젝트 완성도**: ~85% (기능 구현 기준)
**코드 품질**: 4.0/5.0
**다음 점검 예정**: 2026-02-26 (개발 재개 시)
