# ê°œë°œì¼ì§€ - 2026ë…„ 02ì›” 20ì¼

**ë‹´ë‹¹**: Claude Sonnet 4.6
**ì‘ì—… ìœ í˜•**: Phase 2 - ì½”ë“œ í’ˆì§ˆ ì •í™” (Code Quality Cleanup)
**ì§„í–‰ ìƒíƒœ**: âœ… ì™„ë£Œ â€” raw fetch(), window.confirm, document.getElementById ì „ë©´ êµì²´

---

## ğŸ“‹ ì˜¤ëŠ˜ ì‘ì—… ëª©ë¡

- [x] raw `fetch()` â†’ `api` ì„œë¹„ìŠ¤ êµì²´ (ì»´í¬ë„ŒíŠ¸ íŒŒì¼ ì „ì²´)
- [x] `window.confirm` â†’ ìƒíƒœ ê¸°ë°˜ Modal í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ ì „ë©´ êµì²´
- [x] `document.getElementById` ëˆ„ë½ null ì²´í¬ ì¶”ê°€
- [x] AI ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸ raw fetch êµì²´ ë° ì¸ì¦ í—¤ë” ì¶”ê°€
- [x] ì—°ê²° í…ŒìŠ¤íŠ¸/ì‹¤ì‹œê°„ ë™ê¸°í™” ìœ í‹¸ ì¸ì¦ í—¤ë” ëˆ„ë½ ìˆ˜ì •
- [x] ê¸°íƒ€ ë¬µìŒ ì—ëŸ¬ ì²˜ë¦¬ ë° ì˜ëª»ëœ API ì—”ë“œí¬ì¸íŠ¸ ìˆ˜ì •

---

## ğŸ¯ ì™„ë£Œëœ ì‘ì—… ìƒì„¸

### 1. raw fetch() â†’ api ì„œë¹„ìŠ¤ ì „í™˜ (17ê°œ íŒŒì¼)

**ì„¤ëª…**: ì»´í¬ë„ŒíŠ¸ì—ì„œ ì§ì ‘ `fetch()`ë¥¼ í˜¸ì¶œí•˜ëŠ” íŒ¨í„´ì€ ì¸ì¦ í—¤ë”ê°€ ëˆ„ë½ë˜ê³  ì—ëŸ¬ ì²˜ë¦¬ê°€ ë¶ˆì¼ì¹˜í•¨. ëª¨ë‘ `api.get/post/put/patch/delete()` ì„œë¹„ìŠ¤ë¡œ êµì²´.

**ë³€ê²½ íŒŒì¼**:
- `src/components/admin/ai-management/AIServicePlanManager.tsx` â€” 5ê°œ fetch â†’ api ì„œë¹„ìŠ¤, window.confirm â†’ Modal
- `src/components/admin/ai-management/AISettingsManager.tsx` â€” 6ê°œ fetch â†’ api ì„œë¹„ìŠ¤, window.confirm â†’ Modal
- `src/components/admin/ai-management/PromptTemplateManager.tsx` â€” 5ê°œ fetch â†’ api ì„œë¹„ìŠ¤, window.confirm â†’ Modal
- `src/components/admin/ai-management/UserAIAccessManager.tsx` â€” 9ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/admin/EnhancedEvaluatorManagement.tsx` â€” fetch â†’ api ì„œë¹„ìŠ¤, window.confirm â†’ Modal
- `src/components/model/ModelBuilder.tsx` â€” 7ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/admin/EvaluatorManagement.tsx` â€” 4ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/admin/AIManagementDashboard.tsx` â€” 2ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/admin/ai-management/AIUsageAnalytics.tsx` â€” 3ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/admin/UsageManagement.tsx` â€” 4ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/settings/PersonalSettings.tsx` â€” 4ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/admin/ModelFinalization.tsx` â€” apiService â†’ api ì „í™˜
- `src/components/evaluator/EvaluatorWorkflow.tsx` â€” apiService â†’ api ì „í™˜
- `src/components/admin/AdminOnlyDashboard.tsx` â€” 1ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/App.tsx` â€” 8ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/collaboration/RealTimeCollaboration.tsx` â€” 2ê°œ fetch â†’ api ì„œë¹„ìŠ¤
- `src/components/demo/ApiTestPage.tsx` â€” í•˜ë“œì½”ë”© localhost:5000 fetch â†’ api ì„œë¹„ìŠ¤

**íŒ¨í„´ ë³€í™˜**:
```typescript
// Before (ì¸ì¦ í—¤ë” ì—†ìŒ, ì—ëŸ¬ ì²˜ë¦¬ ë¶ˆì¼ì¹˜)
const response = await fetch(`${API_BASE_URL}/api/service/...`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(data)
});
if (response.ok) { const data = await response.json(); ... }

// After (ì¸ì¦ í—¤ë” ìë™ í¬í•¨, ì¼ê´€ëœ ì—ëŸ¬ ì²˜ë¦¬)
const response = await api.post('/api/service/...', data);
if (response.success && response.data) { ... }
else { showActionMessage('error', response.error || 'ì˜¤ë¥˜ ë°œìƒ'); }
```

---

### 2. window.confirm â†’ Modal í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ ì „í™˜ (28ê°œ íŒŒì¼, 40+ ê°œ)

**ì„¤ëª…**: `window.confirm()`ì€ ë¸Œë¼ìš°ì € ê¸°ë³¸ ë‹¤ì´ì–¼ë¡œê·¸ë¡œ, ë””ìì¸ í†µì¼ ë¶ˆê°€, ëª¨ë°”ì¼ UX ë¶ˆëŸ‰, ìë™í™” í…ŒìŠ¤íŠ¸ ì–´ë ¤ì›€. ëª¨ë‘ React state ê¸°ë°˜ `<Modal>` ì»´í¬ë„ŒíŠ¸ë¡œ êµì²´.

**ë³€ê²½ íŒŒì¼ ëª©ë¡**:

| íŒŒì¼ | êµì²´ëœ confirm |
|---|---|
| MyProjects.tsx | 3ê°œ (ë³µì›, ì˜êµ¬ì‚­ì œ 2ë‹¨ê³„, íœ´ì§€í†µ ì´ë™) |
| TrashBin.tsx | 2ê°œ (ë³µì›, ì˜êµ¬ì‚­ì œ 2ë‹¨ê³„) |
| TrashBinTest.tsx | 2ê°œ |
| CriteriaManagement.tsx | 2ê°œ (ì´ˆê¸°í™”, ê¸°ì¤€ ì‚­ì œ) |
| EvaluatorAssignment.tsx | 1ê°œ |
| UserManagement.tsx | 1ê°œ |
| ProjectWorkflow.tsx | 1ê°œ (ì·¨ì†Œ í™•ì¸) |
| ProductionCriteriaManagement.tsx | 3ê°œ |
| EnhancedProjectDashboard.tsx | 1ê°œ |
| ModelConfiguration.tsx | 2ê°œ |
| TreeModelConfiguration.tsx | 1ê°œ (stub) |
| RealUserManagement.tsx | 1ê°œ |
| AllProjectsManagement.tsx | 1ê°œ |
| EvaluatorDataManager.tsx | 2ê°œ |
| SurveyManagementSystem.tsx | 1ê°œ |
| SessionBar.tsx | 1ê°œ (ë¡œê·¸ì•„ì›ƒ) |
| Header.tsx | 1ê°œ (ë¡œê·¸ì•„ì›ƒ) |
| TrashOverflowModal.tsx | 2ê°œ |
| HierarchyTreeVisualization.tsx | 2ê°œ |
| ParticipantManager.tsx | 1ê°œ |
| InteractiveCriteriaEditor.tsx | 1ê°œ |
| VisualCriteriaBuilder.tsx | 1ê°œ |
| HierarchyBuilder.tsx | 1ê°œ |
| AIConfiguration.tsx | 1ê°œ |
| MultiModeEvaluation.tsx | 1ê°œ |
| PaperManagement.tsx | 1ê°œ |
| TwoFactorAuth.tsx | 1ê°œ (+ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì—…ë°ì´íŠ¸) |
| PersonalServiceDashboard.tsx | `window.open()` â†’ `setActiveMenu('payment')` |

**íŒ¨í„´**:
```typescript
// Before
const handleDelete = (id: string) => {
  if (!window.confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  // ... ì‚­ì œ ë¡œì§
};

// After
const [pendingDeleteId, setPendingDeleteId] = useState<string | null>(null);

const handleDelete = (id: string) => {
  setPendingDeleteId(id); // trigger
};

const confirmDelete = async () => {
  if (!pendingDeleteId) return;
  // ... ì‚­ì œ ë¡œì§
  setPendingDeleteId(null);
};

// JSX
<Modal isOpen={pendingDeleteId !== null} onClose={() => setPendingDeleteId(null)} title="ì‚­ì œ í™•ì¸">
  <p>ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
  <Button onClick={confirmDelete}>ì‚­ì œ</Button>
</Modal>
```

---

### 3. document.getElementById null ì²´í¬ ì¶”ê°€ (3ê°œ íŒŒì¼, 15ê°œ)

**ì„¤ëª…**: Google Charts ë Œë”ë§ ì‹œ DOM ìš”ì†Œê°€ ì•„ì§ ë§ˆìš´íŠ¸ë˜ì§€ ì•Šì€ ê²½ìš° `TypeError` í¬ë˜ì‹œ ë°œìƒ ê°€ëŠ¥. ëª¨ë‘ null ì²´í¬ ì¶”ê°€.

**ë³€ê²½ íŒŒì¼**:
- `src/components/analysis/SensitivityAnalysis.tsx` â€” 3ê°œ ìˆ˜ì •
- `src/components/analysis/AdvancedSensitivityAnalysis.tsx` â€” 4ê°œ ìˆ˜ì •
- `src/components/results/EnhancedResultsDashboard.tsx` â€” 8ê°œ ìˆ˜ì •

```typescript
// Before (í¬ë˜ì‹œ ìœ„í—˜)
const chart = new google.visualization.BarChart(document.getElementById('chart-id'));

// After (ì•ˆì „)
const container = document.getElementById('chart-id');
if (!container) return;
const chart = new google.visualization.BarChart(container);
```

---

### 4. ìœ í‹¸ë¦¬í‹° íŒŒì¼ ì¸ì¦ í—¤ë” ëˆ„ë½ ìˆ˜ì •

**ë³€ê²½ íŒŒì¼**:
- `src/utils/connectionTest.ts` â€” `getAuthHeaders()` í—¬í¼ ì¶”ê°€, 5ê°œ fetch í˜¸ì¶œì— ì ìš©
- `src/utils/realTimeSync.ts` â€” `getAuthHeaders()` ì¶”ê°€, ìƒëŒ€ URL â†’ `API_BASE_URL` ì ˆëŒ€ URL ìˆ˜ì •

---

### 5. ê¸°íƒ€ ìˆ˜ì • (ì´ì „ ì»¤ë°‹)

- `BudgetOptimization.tsx` â€” `Math.random()` ê°€ì§œ ë¹„ìš© â†’ 0 (ì‹¤ì œ ì‚¬ìš©ì ì…ë ¥ ìš”êµ¬)
- `AlternativeManagement.tsx` â€” TODOì˜€ë˜ í¸ì§‘ ê¸°ëŠ¥ `criteriaApi.updateCriteria()` ì‹¤ì œ êµ¬í˜„
- `SupportPage.tsx`, `NewsPage.tsx`, `AccessKeyLogin.tsx`, `PairwiseComparison.tsx` â€” raw fetch â†’ api ì„œë¹„ìŠ¤
- `ProjectWorkflow.tsx` â€” ë¬µìŒ catch ë¸”ë¡ â†’ `setError()` ì—ëŸ¬ í‘œì‹œ
- `AllProjectsManagement.tsx`, `WorkshopManagement.tsx` â€” `showActionMessage` ì• ì¤‘ë³µ `console.error` ì œê±°
- `api.ts` â€” `put`, `patch`, `delete` ë©”ì„œë“œ `apiExports`ì— ì¶”ê°€

---

## ğŸ› ë°œìƒí•œ ì´ìŠˆ ë° í•´ê²°

### ì´ìŠˆ 1: fileUploadService.ts ì‚­ì œ í›„ ë¹Œë“œ ì‹¤íŒ¨
**ì¦ìƒ**: "Module not found: fileUploadService" ë¹Œë“œ ì—ëŸ¬
**ì›ì¸**: ë¯¸ì‚¬ìš©ìœ¼ë¡œ ì˜¤íŒí•´ ì‚­ì œí–ˆìœ¼ë‚˜ `FileUpload.tsx`, `AIQualityValidationPage.tsx`ì—ì„œ ì„í¬íŠ¸ ì¤‘
**í•´ê²°**: `git restore --source=<ì´ì „ ì»¤ë°‹> -- src/services/fileUploadService.ts` ë¡œ ë³µêµ¬

### ì´ìŠˆ 2: í‘¸ì‹œ íƒ€ì´ë° ì—ëŸ¬
**ì¦ìƒ**: ì»¤ë°‹ ì§í›„ í‘¸ì‹œ ì‹œ Git ì„œë²„ ì˜¤ë¥˜
**ì›ì¸**: ì»¤ë°‹-í‘¸ì‹œ ì‚¬ì´ ê°„ê²©ì´ ë„ˆë¬´ ì§§ìŒ
**í•´ê²°**: ì»¤ë°‹ í›„ 30ì´ˆ ëŒ€ê¸° í›„ í‘¸ì‹œ, ì—°ì† ì‘ì—… ì‚¬ì´ì—ë„ 30ì´ˆ ê°„ê²© ìœ ì§€

---

## ğŸ”„ Git ì»¤ë°‹ ë‚´ì—­

```
c77241d fix: replace all window.confirm calls with state-based Modal confirmations (28 files)
d75e538 fix: add auth headers to connectionTest and realTimeSync fetch calls
2cb3717 fix: replace raw fetch() in RealTimeCollaboration and ApiTestPage
4364db1 fix: replace raw fetch() and window.confirm in 6 more files
cb02489 fix: replace raw fetch() with api service in 4 more component files
a054cf6 fix: add getElementById null checks and fix UserAIAccessManager fetch calls
7197e0a fix: replace raw fetch() and window.confirm in AI management components
4f6b24f fix: remove redundant console.error calls
d6ac66d fix: replace Math.random() mock cost with 0 in BudgetOptimization
54759ca fix: replace raw fetch calls in NewsPage, AccessKeyLogin, PairwiseComparison
ae24344 chore: remove unused dead code files
f663c37 fix: silent catch blocks, raw fetch in SupportPage, AlternativeManagement edit
44af864 fix: export put/patch/delete from api service; survey/superadmin raw fetch fixes
```

---

## ğŸ“… ë‹¤ìŒ ì‘ì—… ê³„íš

### ìš°ì„ ìˆœìœ„ ë†’ìŒ
1. [ ] `src/data/demoData.ts` â€” í•˜ë“œì½”ë”©ëœ ë°±ì—”ë“œ URL fetch ìˆ˜ì •
2. [ ] TypeScript ë¹Œë“œ ì—ëŸ¬ ì—¬ë¶€ í™•ì¸ (`npx react-scripts build`)
3. [ ] ESLint ê²½ê³  ì”ì—¬ í•­ëª© ì ê²€

### ìš°ì„ ìˆœìœ„ ì¤‘ê°„
1. [ ] `FileUpload.tsx` â€” `loadExistingFiles` catch ë¸”ë¡ ë¬µìŒ ì—ëŸ¬ ì²˜ë¦¬ ì¶”ê°€
2. [ ] ì„œë¹„ìŠ¤ ë ˆì´ì–´ íŒŒì¼ë“¤ (aiService.ts ë“±) ì—ëŸ¬ ì²˜ë¦¬ ì¼ê´€ì„± ê²€í† 
3. [ ] `window.open` íŒ¨í„´ ì”ì—¬ ì—¬ë¶€ í™•ì¸

### ìš°ì„ ìˆœìœ„ ë‚®ìŒ
1. [ ] ì—°ê²° í…ŒìŠ¤íŠ¸ ìœ í‹¸ì˜ protected endpoint ì ‘ê·¼ ê¶Œí•œ ê²€í† 
2. [ ] realTimeSync.ts í˜‘ì—… ê¸°ëŠ¥ ì‹¤ì œ ë°±ì—”ë“œ ì—°ë™ ì—¬ë¶€ í™•ì¸

---

## ğŸ“Š í˜„ì¬ í”„ë¡œì íŠ¸ ìƒíƒœ

### ì½”ë“œ í’ˆì§ˆ ì§€í‘œ (ì‘ì—… ì „ â†’ í›„)
| í•­ëª© | ì‘ì—… ì „ | ì‘ì—… í›„ |
|---|---|---|
| raw fetch() (ì»´í¬ë„ŒíŠ¸) | 84ê°œ | ~0ê°œ |
| window.confirm | 40+ ê°œ | 0ê°œ |
| getElementById ë¬´nullì²´í¬ | 15ê°œ | 0ê°œ |
| ì¸ì¦ í—¤ë” ëˆ„ë½ fetch | 8ê°œ | 0ê°œ |
| Math.random() mock ë°ì´í„° | 1ê°œ | 0ê°œ |

### ì‹œìŠ¤í…œ ìƒíƒœ
- **Frontend**: âœ… GitHub Pages ë°°í¬ ì •ìƒ
- **Backend**: âœ… Render.com ì •ìƒ
- **Database**: âœ… ì •ìƒ

---

## ğŸ“Œ ë©”ëª¨

- `api` ì„œë¹„ìŠ¤ (`src/services/api.ts`)ì˜ `makeRequest()`ê°€ ì¸ì¦ í—¤ë”ë¥¼ ìë™ ì£¼ì…í•˜ë¯€ë¡œ, ì»´í¬ë„ŒíŠ¸ì—ì„œ raw `fetch()` ì‚¬ìš© ê¸ˆì§€ ì›ì¹™ í™•ë¦½
- `window.confirm`ì€ í”„ë¡œì íŠ¸ ì „ì²´ì—ì„œ ì™„ì „ ì œê±° ì™„ë£Œ
- ëª¨ë“  ì‚­ì œ/íŒŒê´´ì  ì‘ì—…ì€ `pendingDeleteId` state + `<Modal>` íŒ¨í„´ìœ¼ë¡œ í†µì¼

---

**ì‘ì„±ì¼ì‹œ**: 2026-02-20
**ì‘ì„±ì**: Claude Sonnet 4.6
**ë¬¸ì„œ ë²„ì „**: v1.0
