# AHP App 종합 개발 계획 — 2026-02-19

## 현재 상태 (세션 11 완료 기준)

### 완료된 주요 작업 (세션 1~12)

| 세션 | 작업 | 커밋 |
|------|------|------|
| 1~8  | ESLint 수정, alert 제거 55개, URL 수정, 이모지 로그 제거 | 다수 |
| 9    | CRITICAL 보안 수정 (AllowAny 제거, 하드코딩 비밀번호 제거) | - |
| 10   | ResultsDataManager API 연동 | - |
| 11   | AdminOnlyDashboard API 연동 | - |
| 12   | WorkshopManagement API 연동 + 백엔드 버그 3종 수정 | 5268a55, aeec415 |
| 12   | ProjectCompletion API 연동 | 89576c9 |
| 12   | SurveyLinkManager API 연동 | 732ac94 |

### 백엔드 상태
- Django REST Framework 백엔드 (Render.com 배포)
- apps: accounts, projects, evaluations, analysis, subscriptions, exports, workshops
- CI/CD: GitHub Actions (✅ 통과)
- URL 기본 경로: `/api/service/`

---

## 남은 작업 목록 (우선순위순)

### CRITICAL — 핵심 기능 동작 불가

#### Todo 1: ResultsAnalysis API 연동
- **파일**: `src/components/analysis/ResultsAnalysis.tsx`
- **문제**: `generateMockData()`로 Math.random() 가짜 값 생성
- **해결**:
  1. `GET /api/service/evaluations/evaluations/?project={id}` → 평가자별 CR, 진행률, 상태
  2. `GET /api/service/analysis/project-summary/?project_id={id}` → 종합 통계
  3. `POST /api/service/analysis/calculate/group/` → 완료 평가 있을 때 기준 가중치 계산

#### Todo 2: EvaluatorDashboard API 연동
- **파일**: `src/components/evaluator/EvaluatorDashboard.tsx`
- **문제**: mock invitation 3개 하드코딩 (project-001, project-002, project-003)
- **해결**:
  1. `GET /api/service/evaluations/evaluations/` → 현재 사용자 배정 평가 목록
  2. `GET /api/service/evaluations/invitations/` → 초대 목록

### HIGH — UX 영향

#### Todo 3: AIResultsInterpretationPage API 연동 + ESLint 수정
- **파일**: `src/components/ai-interpretation/AIResultsInterpretationPage.tsx`
- **문제**: 미사용 변수 5개 + mockResult Math.random() AHP 결과
- **해결**:
  1. 미사용 변수 제거 (ESLint)
  2. `POST /api/service/analysis/calculate/group/` → 실제 기준 가중치

#### Todo 4: ESLint 경고 전체 수정
- **대상 파일**: 20여 개 파일의 미사용 import/변수
- **목표**: 빌드 경고 0개

### MEDIUM — 추가 연동

#### Todo 5: EvaluatorSurveyPage API 연동
- **파일**: `src/components/survey/EvaluatorSurveyPage.tsx`
- **문제**: mock survey 질문 하드코딩
- **해결**: 실제 survey template API 연동

#### Todo 6: PaperManagement API 연동
- **파일**: `src/components/paper/PaperManagement.tsx`
- **문제**: 미사용 변수 + mock survey 응답 42개
- **해결**: 미사용 변수 제거, 실제 설문 응답 API 연동

#### Todo 7: RealTimeParticipantMonitor 폴링 연동
- **파일**: `src/components/monitoring/RealTimeParticipantMonitor.tsx`
- **문제**: 하드코딩 mock 3명 (김기술팀장, 이개발자, 박분석가)
- **해결**: WebSocket 대신 setInterval 폴링으로 evaluations API 호출

---

## 백엔드 주요 API 정리

### Evaluations
```
GET  /api/service/evaluations/evaluations/?project={id}  → 평가 목록 (평가자명, 상태, CR, 진행률)
GET  /api/service/evaluations/invitations/?project={id}  → 초대 목록 (token, status)
GET  /api/service/evaluations/evaluations/               → 내 평가 목록 (evaluator=me)
```

### Analysis
```
GET  /api/service/analysis/project-summary/?project_id={id}  → 프로젝트 분석 통계
POST /api/service/analysis/calculate/group/                  → 그룹 기준 가중치 계산
POST /api/service/analysis/calculate/individual/             → 개별 평가 가중치 계산
POST /api/service/analysis/sensitivity/                      → 민감도 분석
```

### Projects & Criteria
```
GET  /api/service/projects/projects/{id}/                → 프로젝트 상세
GET  /api/service/projects/criteria/?project={id}        → 기준 목록
GET  /api/service/projects/alternatives/?project={id}    → 대안 목록
```

### Workshops
```
GET  /api/service/workshops/sessions/                     → 워크숍 세션 목록
POST /api/service/workshops/sessions/{id}/start/          → 시작
POST /api/service/workshops/sessions/{id}/complete/       → 완료
POST /api/service/workshops/sessions/{id}/cancel/         → 취소
GET  /api/service/workshops/sessions/{id}/participants/   → 참여자 목록
GET  /api/service/workshops/sessions/{id}/progress/       → 진행 현황
```

---

## 기술 결정 사항

### 1. WebSocket vs Polling
- 백엔드에 Django Channels 없음 → WebSocket 불가
- 대신 `setInterval` 폴링 (5~10초 간격)으로 구현

### 2. 분석 결과 표시 전략
- 완료 평가 없을 때: 안내 메시지 + 링크
- 완료 평가 1개 이상: calculate/group/ 호출 → 기준 가중치 표시
- 완료 평가 전체: final-priorities/ → 종합 결과

### 3. 이메일 발송
- 백엔드 SMTP 미구성 → mailto: 링크로 대체
- 향후 SMTP 설정 후 실제 발송 API 연동

---

## 배포 정보

### 프론트엔드
- **플랫폼**: GitHub Pages
- **경로**: `https://{username}.github.io/ahp_app/`
- **빌드**: `npm run build`
- **배포**: push → GitHub Actions → Pages

### 백엔드
- **플랫폼**: Render.com
- **자동 배포**: main 브랜치 push
- **URL**: `https://{appname}.onrender.com`

---

## 개발 원칙

1. **apiService 단일 사용**: 모든 API 호출은 `apiService.get/post/patch/delete`
2. **Promise.allSettled**: 일부 API 실패해도 나머지 데이터 표시
3. **graceful fallback**: 데이터 없을 때 빈 화면 대신 안내 메시지
4. **useCallback**: API 로드 함수는 useCallback으로 메모이제이션
5. **eslint-disable-next-line**: 의도적 빈 deps 배열만 suppress

---

*작성: Claude Sonnet 4.6 — 2026-02-19*
